2025-10-24 22:42:56,669 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-24 22:42:56,670 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-24 22:42:56,685 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-24 22:42:56,688 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-24 22:42:56,688 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-24 22:42:56,688 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-24 22:42:56,692 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-24 22:42:56,693 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-24 22:42:56,695 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-24 22:42:56,695 - root - INFO - main:601 - Processing dataset: block
2025-10-24 22:42:56,696 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-24 22:42:57,411 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-24 22:42:58,298 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-24 22:42:58,758 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-24 22:42:59,277 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-24 22:42:59,791 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-24 22:42:59,792 - root - INFO - timer:154 - Completed: Loading all test images in 3.10 seconds
2025-10-24 22:42:59,792 - root - INFO - timer:148 - Starting: Loading training data
2025-10-24 22:42:59,792 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-24 22:43:01,764 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-24 22:43:01,764 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-24 22:43:01,768 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-24 22:43:01,768 - root - INFO - timer:154 - Completed: Loading training data in 1.98 seconds
2025-10-24 22:43:01,769 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-24 22:43:01,769 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-24 22:43:01,769 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-24 22:43:01,769 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-24 22:43:01,771 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-24 22:43:01,772 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [32.00, 215.00]
2025-10-24 22:43:01,772 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.71], a[-2.00, 2.00], b[-1.00, 8.00]
2025-10-24 22:43:01,773 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-24 22:43:01,774 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-24 22:43:01,777 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-24 22:43:01,777 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-24 22:43:01,777 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-24 22:43:01,777 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-24 22:43:02,060 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-24 22:43:02,110 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-24 22:43:02,111 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.237, 0.240]
2025-10-24 22:43:02,111 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-24 22:43:02,111 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-24 22:43:02,111 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-24 22:43:02,111 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-24 22:43:02,111 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.283]
2025-10-24 22:43:02,112 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.463, 0.441]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-24 22:43:02,113 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-24 22:43:02,113 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-24 22:45:32,338 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 150.22s - Final fitness: 0.023033
2025-10-24 22:45:32,338 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-24 22:45:32,349 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-24 22:45:32,350 - root - INFO - timer:154 - Completed: DBN initialization and training in 150.58 seconds
2025-10-24 22:45:32,350 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-24 22:45:32,351 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-24 22:45:32,743 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-24 22:45:32,743 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-24 22:45:32,771 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-24 22:45:34,079 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 22:45:34,398 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 22:45:35,131 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 22:45:35,132 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 22:45:35,132 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 22:45:35,132 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-24 22:45:35,132 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-24 22:45:35,143 - src.models.segmentation.segmentation - INFO - determine_k:107 - Unique colors: 117. Adjusted k-range for metric search: [2, 8]
2025-10-24 22:45:35,143 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=2
2025-10-24 22:45:37,094 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=2: Silhouette=0.969, CH=1928285.9
2025-10-24 22:45:37,094 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=3
2025-10-24 22:45:38,962 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=3: Silhouette=0.805, CH=1358249.9
2025-10-24 22:45:38,962 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=4
2025-10-24 22:45:40,835 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=4: Silhouette=0.809, CH=1753242.4
2025-10-24 22:45:40,835 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=5
2025-10-24 22:45:42,859 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=5: Silhouette=0.738, CH=1875234.9
2025-10-24 22:45:42,859 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=6
2025-10-24 22:45:44,925 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=6: Silhouette=0.869, CH=2438844.2
2025-10-24 22:45:44,925 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=7
2025-10-24 22:45:46,778 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=7: Silhouette=0.877, CH=3597046.2
2025-10-24 22:45:46,778 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=8
2025-10-24 22:45:48,620 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=8: Silhouette=0.939, CH=4479793.0
2025-10-24 22:45:48,621 - src.models.segmentation.segmentation - INFO - determine_k:161 - Optimal k determined: 8 (based on score: 0.935)
2025-10-24 22:45:48,621 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-24 22:45:48,621 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-24 22:45:48,631 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 117. Using dynamic_max_k: 10
2025-10-24 22:45:48,633 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 104.590
2025-10-24 22:45:48,635 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=372.415, std=2027.563, threshold=2399.978
2025-10-24 22:45:48,635 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-24 22:45:48,635 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-24 22:45:48,635 - src.models.segmentation.segmentation - INFO - __init__:245 - KMeansSegmenter initialized with k_type: predefined
2025-10-24 22:45:48,636 - src.models.segmentation.segmentation - INFO - quantize_image:192 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-24 22:45:48,833 - src.models.segmentation.segmentation - INFO - __init__:480 - SOMSegmenter initialized with k_type: predefined
2025-10-24 22:45:48,833 - src.models.segmentation.segmentation - INFO - quantize_image:192 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-24 22:45:48,959 - src.models.segmentation.segmentation - INFO - segment:502 - Running SOM segmentation with k=8
2025-10-24 22:45:49,428 - src.models.segmentation.segmentation - WARNING - segment:542 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-24 22:45:49,428 - src.models.segmentation.segmentation - WARNING - segment:542 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-24 22:45:49,429 - root - INFO - process_reference_image:346 - Reference image processing finished in 17.08 seconds.
2025-10-24 22:45:49,681 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-24 22:45:49,793 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-24 22:45:51,023 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-24 22:45:51,024 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-24 22:45:51,024 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.67 seconds
2025-10-24 22:45:51,031 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-24 22:45:51,032 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-24 22:45:51,058 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-24 22:45:52,393 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 22:45:52,765 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 22:45:53,211 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 22:45:53,213 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 22:45:53,213 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 22:45:53,215 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-24 22:45:53,216 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-24 22:45:53,217 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:53,217 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-24 22:45:53,217 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-24 22:45:53,218 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:53,218 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-24 22:45:53,218 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.19 seconds
2025-10-24 22:45:53,219 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-24 22:45:53,219 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-24 22:45:53,255 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-24 22:45:54,643 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 22:45:54,976 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 22:45:55,406 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 22:45:55,407 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 22:45:55,407 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 22:45:55,408 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-24 22:45:55,409 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-24 22:45:55,410 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:55,410 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-24 22:45:55,410 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-24 22:45:55,411 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:55,411 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-24 22:45:55,411 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.19 seconds
2025-10-24 22:45:55,412 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-24 22:45:55,412 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-24 22:45:55,436 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-24 22:45:56,739 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 22:45:57,068 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 22:45:57,491 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 22:45:57,493 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 22:45:57,493 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 22:45:57,494 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-24 22:45:57,495 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-24 22:45:57,496 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:57,496 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-24 22:45:57,496 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-24 22:45:57,497 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:57,497 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-24 22:45:57,498 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.09 seconds
2025-10-24 22:45:57,498 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-24 22:45:57,499 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-24 22:45:57,523 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-24 22:45:58,937 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 22:45:59,290 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 22:45:59,712 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 22:45:59,713 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 22:45:59,713 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 22:45:59,714 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-24 22:45:59,715 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-24 22:45:59,716 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:59,716 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-24 22:45:59,716 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-24 22:45:59,717 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:45:59,717 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-24 22:45:59,717 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.22 seconds
2025-10-24 22:45:59,718 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-24 22:45:59,718 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-24 22:45:59,741 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-24 22:46:00,997 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 22:46:01,313 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 22:46:01,731 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 22:46:01,732 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 22:46:01,732 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 22:46:01,733 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-24 22:46:01,734 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-24 22:46:01,735 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:46:01,735 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-24 22:46:01,735 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-24 22:46:01,736 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 22:46:01,736 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-24 22:46:01,737 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.02 seconds
2025-10-24 22:46:01,738 - root - INFO - main:684 - ================================================================================
PROCESSING COMPLETED IN 185.07 SECONDS
================================================================================
2025-10-24 22:46:01,787 - root - INFO - main:692 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-24 23:49:09,524 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-24 23:49:09,526 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-24 23:49:09,541 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-24 23:49:09,545 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-24 23:49:09,545 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-24 23:49:09,545 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-24 23:49:09,548 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-24 23:49:09,548 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-24 23:49:09,553 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-24 23:49:09,553 - root - INFO - main:601 - Processing dataset: block
2025-10-24 23:49:09,555 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-24 23:49:10,302 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-24 23:49:11,274 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-24 23:49:11,780 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-24 23:49:12,356 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-24 23:49:12,907 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-24 23:49:12,907 - root - INFO - timer:154 - Completed: Loading all test images in 3.35 seconds
2025-10-24 23:49:12,908 - root - INFO - timer:148 - Starting: Loading training data
2025-10-24 23:49:12,908 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-24 23:49:14,906 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-24 23:49:14,906 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-24 23:49:14,910 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-24 23:49:14,910 - root - INFO - timer:154 - Completed: Loading training data in 2.00 seconds
2025-10-24 23:49:14,911 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-24 23:49:14,911 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-24 23:49:14,911 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-24 23:49:14,911 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-24 23:49:14,915 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-24 23:49:14,915 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 214.00]
2025-10-24 23:49:14,915 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.31], a[-2.00, 2.00], b[-1.00, 9.00]
2025-10-24 23:49:14,916 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-24 23:49:14,917 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-24 23:49:14,920 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-24 23:49:14,920 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-24 23:49:14,920 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-24 23:49:14,921 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-24 23:49:15,240 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-24 23:49:15,300 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-24 23:49:15,301 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.241, 0.241]
2025-10-24 23:49:15,301 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-24 23:49:15,301 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-24 23:49:15,301 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-24 23:49:15,302 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-24 23:49:15,303 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.282]
2025-10-24 23:49:15,303 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-24 23:49:15,303 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-24 23:49:15,303 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-24 23:49:15,303 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-24 23:49:15,303 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-24 23:49:15,304 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.453, 0.453]
2025-10-24 23:49:15,304 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-24 23:49:15,304 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-24 23:49:15,304 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-24 23:51:59,432 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 164.12s - Final fitness: 0.037198
2025-10-24 23:51:59,432 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-24 23:51:59,442 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-24 23:51:59,442 - root - INFO - timer:154 - Completed: DBN initialization and training in 164.53 seconds
2025-10-24 23:51:59,443 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-24 23:51:59,443 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-24 23:51:59,830 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-24 23:51:59,830 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-24 23:51:59,864 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-24 23:52:01,178 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 23:52:01,496 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 23:52:02,201 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 23:52:02,202 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 23:52:02,202 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 23:52:02,203 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-24 23:52:02,203 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-24 23:52:02,214 - src.models.segmentation.segmentation - INFO - determine_k:107 - Unique colors: 124. Adjusted k-range for metric search: [2, 8]
2025-10-24 23:52:02,214 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=2
2025-10-24 23:52:04,165 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=2: Silhouette=0.970, CH=1971910.2
2025-10-24 23:52:04,165 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=3
2025-10-24 23:52:06,067 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=3: Silhouette=0.943, CH=1529733.1
2025-10-24 23:52:06,067 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=4
2025-10-24 23:52:07,966 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=4: Silhouette=0.791, CH=1666435.5
2025-10-24 23:52:07,966 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=5
2025-10-24 23:52:09,817 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=5: Silhouette=0.792, CH=1598665.2
2025-10-24 23:52:09,817 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=6
2025-10-24 23:52:11,678 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=6: Silhouette=0.906, CH=1821789.6
2025-10-24 23:52:11,678 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=7
2025-10-24 23:52:13,499 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=7: Silhouette=0.866, CH=3243690.8
2025-10-24 23:52:13,499 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=8
2025-10-24 23:52:15,330 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=8: Silhouette=0.895, CH=3657136.2
2025-10-24 23:52:15,330 - src.models.segmentation.segmentation - INFO - determine_k:161 - Optimal k determined: 8 (based on score: 0.790)
2025-10-24 23:52:15,331 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-24 23:52:15,331 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-24 23:52:15,341 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 124. Using dynamic_max_k: 10
2025-10-24 23:52:15,343 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 108.042
2025-10-24 23:52:15,345 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=370.008, std=2041.488, threshold=2411.497
2025-10-24 23:52:15,345 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-24 23:52:15,346 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-24 23:52:15,346 - src.models.segmentation.segmentation - INFO - __init__:245 - KMeansSegmenter initialized with k_type: predefined
2025-10-24 23:52:15,346 - src.models.segmentation.segmentation - INFO - quantize_image:192 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-24 23:52:15,522 - src.models.segmentation.segmentation - INFO - __init__:480 - SOMSegmenter initialized with k_type: predefined
2025-10-24 23:52:15,522 - src.models.segmentation.segmentation - INFO - quantize_image:192 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-24 23:52:15,652 - src.models.segmentation.segmentation - INFO - segment:502 - Running SOM segmentation with k=8
2025-10-24 23:52:16,119 - src.models.segmentation.segmentation - WARNING - segment:542 - SOM generated empty mask for cluster 4 (k=8). Skipping avg color.
2025-10-24 23:52:16,119 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.68 seconds.
2025-10-24 23:52:16,379 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-24 23:52:16,499 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-24 23:52:17,711 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-24 23:52:17,711 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-24 23:52:17,711 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.27 seconds
2025-10-24 23:52:17,719 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-24 23:52:17,719 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-24 23:52:17,746 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-24 23:52:19,055 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 23:52:19,392 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 23:52:19,843 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 23:52:19,844 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 23:52:19,844 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 23:52:19,845 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-24 23:52:19,846 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-24 23:52:19,847 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:19,847 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-24 23:52:19,847 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-24 23:52:19,848 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:19,848 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-24 23:52:19,849 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.13 seconds
2025-10-24 23:52:19,849 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-24 23:52:19,849 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-24 23:52:19,882 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-24 23:52:21,197 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 23:52:21,522 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 23:52:21,946 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 23:52:21,947 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 23:52:21,947 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 23:52:21,949 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-24 23:52:21,949 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-24 23:52:21,950 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:21,950 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-24 23:52:21,950 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-24 23:52:21,951 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:21,951 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-24 23:52:21,952 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.10 seconds
2025-10-24 23:52:21,952 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-24 23:52:21,953 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-24 23:52:21,975 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-24 23:52:23,255 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 23:52:23,572 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 23:52:24,004 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 23:52:24,006 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 23:52:24,006 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 23:52:24,008 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-24 23:52:24,008 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-24 23:52:24,009 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:24,009 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-24 23:52:24,009 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-24 23:52:24,010 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:24,010 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-24 23:52:24,011 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.06 seconds
2025-10-24 23:52:24,011 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-24 23:52:24,012 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-24 23:52:24,032 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-24 23:52:25,291 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 23:52:25,633 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 23:52:26,057 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 23:52:26,059 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 23:52:26,059 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 23:52:26,060 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-24 23:52:26,061 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-24 23:52:26,061 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:26,061 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-24 23:52:26,062 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-24 23:52:26,063 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:26,063 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-24 23:52:26,063 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.05 seconds
2025-10-24 23:52:26,064 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-24 23:52:26,065 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-24 23:52:26,087 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-24 23:52:27,388 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-24 23:52:27,760 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-24 23:52:28,189 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-24 23:52:28,190 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-24 23:52:28,191 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-24 23:52:28,192 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-24 23:52:28,192 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-24 23:52:28,193 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:28,193 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-24 23:52:28,193 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-24 23:52:28,194 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-24 23:52:28,194 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-24 23:52:28,194 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.13 seconds
2025-10-24 23:52:28,196 - root - INFO - main:684 - ================================================================================
PROCESSING COMPLETED IN 198.67 SECONDS
================================================================================
2025-10-24 23:52:28,258 - root - INFO - main:692 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 00:06:06,177 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 00:06:06,178 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 00:06:06,188 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 00:06:06,190 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 00:06:06,190 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 00:06:06,190 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 00:06:06,190 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 00:06:06,196 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 00:06:06,198 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 00:06:06,198 - root - INFO - main:601 - Processing dataset: block
2025-10-25 00:06:06,199 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 00:06:06,885 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 00:06:07,711 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 00:06:08,165 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 00:06:08,682 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 00:06:09,199 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 00:06:09,199 - root - INFO - timer:154 - Completed: Loading all test images in 3.00 seconds
2025-10-25 00:06:09,199 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 00:06:09,199 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 00:06:11,238 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 00:06:11,238 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 00:06:11,238 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 00:06:11,238 - root - INFO - timer:154 - Completed: Loading training data in 2.04 seconds
2025-10-25 00:06:11,238 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 00:06:11,238 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 00:06:11,238 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 00:06:11,238 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 214.00]
2025-10-25 00:06:11,238 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[11.76, 84.31], a[-2.00, 3.00], b[-1.00, 8.00]
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 00:06:11,238 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 00:06:11,238 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 00:06:11,554 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.241, 0.240]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.283]
2025-10-25 00:06:11,601 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.463, 0.461]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 00:06:11,617 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 00:06:11,617 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 00:08:48,331 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 156.71s - Final fitness: 0.046775
2025-10-25 00:08:48,331 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 00:08:48,353 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 00:08:48,353 - root - INFO - timer:154 - Completed: DBN initialization and training in 157.11 seconds
2025-10-25 00:08:48,353 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 00:08:48,353 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 00:08:48,758 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 00:08:48,758 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:08:48,785 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:08:50,099 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:08:50,415 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:08:51,185 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:08:51,185 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:08:51,185 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:08:51,185 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 00:08:51,185 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 00:08:51,185 - src.models.segmentation.segmentation - INFO - determine_k:107 - Unique colors: 102. Adjusted k-range for metric search: [2, 8]
2025-10-25 00:08:51,185 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=2
2025-10-25 00:08:53,120 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=2: Silhouette=0.971, CH=2036843.9
2025-10-25 00:08:53,120 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=3
2025-10-25 00:08:54,994 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=3: Silhouette=0.806, CH=1422099.1
2025-10-25 00:08:54,994 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=4
2025-10-25 00:08:56,828 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=4: Silhouette=0.798, CH=1916255.9
2025-10-25 00:08:56,828 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=5
2025-10-25 00:08:58,694 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=5: Silhouette=0.761, CH=2180757.0
2025-10-25 00:08:58,694 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=6
2025-10-25 00:09:00,510 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=6: Silhouette=0.909, CH=2959141.5
2025-10-25 00:09:00,510 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=7
2025-10-25 00:09:02,385 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=7: Silhouette=0.915, CH=4183990.0
2025-10-25 00:09:02,385 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=8
2025-10-25 00:09:04,220 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=8: Silhouette=0.917, CH=5306122.5
2025-10-25 00:09:04,220 - src.models.segmentation.segmentation - INFO - determine_k:161 - Optimal k determined: 8 (based on score: 0.871)
2025-10-25 00:09:04,220 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 00:09:04,220 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 00:09:04,235 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 102. Using dynamic_max_k: 10
2025-10-25 00:09:04,235 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 110.368
2025-10-25 00:09:04,235 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=376.637, std=1925.684, threshold=2302.321
2025-10-25 00:09:04,235 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 00:09:04,235 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 00:09:04,235 - src.models.segmentation.segmentation - INFO - __init__:247 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 00:09:04,235 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:09:04,432 - src.models.segmentation.segmentation - INFO - __init__:482 - SOMSegmenter initialized with k_type: predefined
2025-10-25 00:09:04,432 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:09:04,575 - src.models.segmentation.segmentation - INFO - segment:504 - Running SOM segmentation with k=8
2025-10-25 00:09:05,041 - src.models.segmentation.segmentation - WARNING - segment:544 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 00:09:05,041 - src.models.segmentation.segmentation - WARNING - segment:544 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 00:09:05,041 - src.models.segmentation.segmentation - WARNING - segment:544 - SOM generated empty mask for cluster 4 (k=8). Skipping avg color.
2025-10-25 00:09:05,041 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.69 seconds.
2025-10-25 00:09:05,300 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 00:09:05,430 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 00:09:06,641 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 00:09:06,641 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 00:09:06,641 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.29 seconds
2025-10-25 00:09:06,641 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 00:09:06,654 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 00:09:06,678 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 00:09:08,030 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:09:08,368 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:09:08,809 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:09:08,810 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:09:08,810 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:09:08,810 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 00:09:08,810 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 00:09:08,810 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:08,810 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 00:09:08,810 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 00:09:08,810 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:08,810 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 00:09:08,810 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.16 seconds
2025-10-25 00:09:08,810 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 00:09:08,810 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:09:08,850 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:09:10,254 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:09:10,604 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:09:11,059 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:09:11,059 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:09:11,059 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:09:11,059 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 00:09:11,059 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 00:09:11,059 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:11,059 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 00:09:11,059 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 00:09:11,059 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:11,059 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 00:09:11,059 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.25 seconds
2025-10-25 00:09:11,059 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 00:09:11,059 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 00:09:11,093 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 00:09:12,445 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:09:12,815 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:09:13,248 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:09:13,250 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:09:13,250 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:09:13,250 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 00:09:13,250 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 00:09:13,250 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:13,250 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 00:09:13,250 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 00:09:13,250 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:13,250 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 00:09:13,250 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.19 seconds
2025-10-25 00:09:13,250 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 00:09:13,250 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 00:09:13,280 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 00:09:14,736 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:09:15,108 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:09:15,593 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:09:15,593 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:09:15,593 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:09:15,593 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 00:09:15,593 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 00:09:15,593 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:15,593 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 00:09:15,593 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 00:09:15,593 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:15,593 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 00:09:15,593 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.35 seconds
2025-10-25 00:09:15,593 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 00:09:15,593 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 00:09:15,632 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 00:09:16,942 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:09:17,272 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:09:17,710 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:09:17,710 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:09:17,710 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:09:17,710 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 00:09:17,710 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 00:09:17,710 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:17,710 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 00:09:17,710 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 00:09:17,710 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:09:17,710 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 00:09:17,710 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.11 seconds
2025-10-25 00:09:17,710 - root - INFO - main:684 - ================================================================================
PROCESSING COMPLETED IN 191.55 SECONDS
================================================================================
2025-10-25 00:09:17,773 - root - INFO - main:692 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 00:15:45,595 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 00:15:45,596 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 00:15:45,610 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 00:15:45,618 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 00:15:45,618 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 00:15:45,618 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 00:15:45,620 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 00:15:45,621 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 00:15:45,623 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 00:15:45,623 - root - INFO - main:601 - Processing dataset: block
2025-10-25 00:15:45,624 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 00:15:46,327 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 00:15:47,277 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 00:15:47,921 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 00:15:48,545 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 00:15:49,208 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 00:15:49,208 - root - INFO - timer:154 - Completed: Loading all test images in 3.58 seconds
2025-10-25 00:15:49,210 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 00:15:49,211 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 00:15:51,519 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 00:15:51,519 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 00:15:51,519 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 00:15:51,519 - root - INFO - timer:154 - Completed: Loading training data in 2.31 seconds
2025-10-25 00:15:51,525 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 00:15:51,525 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 00:15:51,525 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 00:15:51,525 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [30.00, 215.00]
2025-10-25 00:15:51,525 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[10.98, 84.71], a[-2.00, 2.00], b[-1.00, 8.00]
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 00:15:51,525 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 00:15:51,525 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 00:15:51,878 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.241, 0.241]
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 00:15:51,933 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 00:15:51,934 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.283]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.429, 0.461]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 00:15:51,935 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 00:15:51,936 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 00:18:27,948 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 156.00s - Final fitness: 0.055569
2025-10-25 00:18:27,949 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 00:18:27,965 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 00:18:27,965 - root - INFO - timer:154 - Completed: DBN initialization and training in 156.44 seconds
2025-10-25 00:18:27,966 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 00:18:27,966 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 00:18:28,391 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 00:18:28,391 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:18:28,419 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:18:29,730 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:18:30,053 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:18:30,787 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:18:30,788 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:18:30,788 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:18:30,788 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 00:18:30,788 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 00:18:30,799 - src.models.segmentation.segmentation - INFO - determine_k:107 - Unique colors: 111. Adjusted k-range for metric search: [2, 8]
2025-10-25 00:18:30,799 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=2
2025-10-25 00:18:32,720 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=2: Silhouette=0.970, CH=2006920.4
2025-10-25 00:18:32,721 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=3
2025-10-25 00:18:34,641 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=3: Silhouette=0.947, CH=1561473.8
2025-10-25 00:18:34,641 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=4
2025-10-25 00:18:36,487 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=4: Silhouette=0.811, CH=1956011.8
2025-10-25 00:18:36,487 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=5
2025-10-25 00:18:38,347 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=5: Silhouette=0.943, CH=2074669.1
2025-10-25 00:18:38,347 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=6
2025-10-25 00:18:40,180 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=6: Silhouette=0.913, CH=2845203.5
2025-10-25 00:18:40,181 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=7
2025-10-25 00:18:42,005 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=7: Silhouette=0.920, CH=4300413.5
2025-10-25 00:18:42,005 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=8
2025-10-25 00:18:43,817 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=8: Silhouette=0.924, CH=5046774.5
2025-10-25 00:18:43,818 - src.models.segmentation.segmentation - INFO - determine_k:161 - Optimal k determined: 8 (based on score: 0.856)
2025-10-25 00:18:43,818 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 00:18:43,818 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 00:18:43,828 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 111. Using dynamic_max_k: 10
2025-10-25 00:18:43,830 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 106.963
2025-10-25 00:18:43,833 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=365.698, std=1921.040, threshold=2286.738
2025-10-25 00:18:43,833 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 00:18:43,833 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 00:18:43,834 - src.models.segmentation.segmentation - INFO - __init__:248 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 00:18:43,834 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:18:44,025 - src.models.segmentation.segmentation - INFO - __init__:493 - SOMSegmenter initialized with k_type: predefined
2025-10-25 00:18:44,025 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:18:44,149 - src.models.segmentation.segmentation - INFO - segment:519 - Running SOM segmentation with k=8
2025-10-25 00:18:44,623 - src.models.segmentation.segmentation - WARNING - segment:559 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 00:18:44,624 - src.models.segmentation.segmentation - WARNING - segment:559 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 00:18:44,624 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.66 seconds.
2025-10-25 00:18:44,953 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 00:18:45,069 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 00:18:46,280 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 00:18:46,280 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 00:18:46,280 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.31 seconds
2025-10-25 00:18:46,287 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 00:18:46,288 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 00:18:46,316 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 00:18:47,637 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:18:47,958 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:18:48,383 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:18:48,384 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:18:48,384 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:18:48,386 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 00:18:48,386 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 00:18:48,387 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:48,387 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 00:18:48,387 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 00:18:48,388 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:48,388 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 00:18:48,389 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.10 seconds
2025-10-25 00:18:48,389 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 00:18:48,389 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:18:48,420 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:18:49,728 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:18:50,046 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:18:50,441 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:18:50,442 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:18:50,442 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:18:50,443 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 00:18:50,444 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 00:18:50,445 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:50,445 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 00:18:50,445 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 00:18:50,446 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:50,446 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 00:18:50,446 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.06 seconds
2025-10-25 00:18:50,447 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 00:18:50,447 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 00:18:50,471 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 00:18:51,727 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:18:52,060 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:18:52,458 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:18:52,460 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:18:52,460 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:18:52,461 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 00:18:52,461 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 00:18:52,462 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:52,462 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 00:18:52,462 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 00:18:52,463 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:52,463 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 00:18:52,464 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.02 seconds
2025-10-25 00:18:52,464 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 00:18:52,465 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 00:18:52,489 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 00:18:53,783 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:18:54,105 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:18:54,521 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:18:54,522 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:18:54,522 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:18:54,523 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 00:18:54,524 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 00:18:54,525 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:54,525 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 00:18:54,525 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 00:18:54,526 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:54,526 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 00:18:54,527 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.06 seconds
2025-10-25 00:18:54,527 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 00:18:54,527 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 00:18:54,544 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 00:18:55,826 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:18:56,136 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:18:56,551 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:18:56,552 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:18:56,553 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:18:56,554 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 00:18:56,554 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 00:18:56,555 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:56,555 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 00:18:56,555 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 00:18:56,556 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:18:56,556 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 00:18:56,557 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.03 seconds
2025-10-25 00:18:56,558 - root - INFO - main:684 - ================================================================================
PROCESSING COMPLETED IN 190.97 SECONDS
================================================================================
2025-10-25 00:18:56,611 - root - INFO - main:692 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 00:36:45,599 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 00:36:45,600 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 00:36:45,612 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 00:36:45,614 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 00:36:45,614 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 00:36:45,615 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 00:36:45,617 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 00:36:45,617 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 00:36:45,622 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 00:36:45,622 - root - INFO - main:601 - Processing dataset: block
2025-10-25 00:36:45,623 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 00:36:46,317 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 00:36:47,204 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 00:36:47,699 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 00:36:48,249 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 00:36:48,830 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 00:36:48,830 - root - INFO - timer:154 - Completed: Loading all test images in 3.21 seconds
2025-10-25 00:36:48,830 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 00:36:48,831 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 00:36:50,946 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 00:36:50,947 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 00:36:50,953 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 00:36:50,953 - root - INFO - timer:154 - Completed: Loading training data in 2.12 seconds
2025-10-25 00:36:50,954 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 00:36:50,954 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 00:36:50,954 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 00:36:50,955 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 00:36:50,961 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 00:36:50,962 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [30.00, 214.00]
2025-10-25 00:36:50,962 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[10.98, 84.31], a[-2.00, 2.00], b[-1.00, 8.00]
2025-10-25 00:36:50,963 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 00:36:50,963 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 00:36:50,968 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 00:36:50,968 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 00:36:50,968 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 00:36:50,968 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 00:36:51,317 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 00:36:51,382 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 00:36:51,382 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.241]
2025-10-25 00:36:51,382 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 00:36:51,383 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 00:36:51,383 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 00:36:51,383 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 00:36:51,383 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 00:36:51,383 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 00:36:51,383 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 00:36:51,384 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 00:36:51,384 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 00:36:51,384 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 00:36:51,384 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 00:36:51,384 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.282]
2025-10-25 00:36:51,384 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 00:36:51,385 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 00:36:51,385 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 00:36:51,385 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 00:36:51,385 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 00:36:51,385 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.450, 0.454]
2025-10-25 00:36:51,386 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 00:36:51,386 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 00:36:51,386 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 00:39:22,033 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 150.64s - Final fitness: 0.016699
2025-10-25 00:39:22,033 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 00:39:22,049 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 00:39:22,050 - root - INFO - timer:154 - Completed: DBN initialization and training in 151.10 seconds
2025-10-25 00:39:22,052 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 00:39:22,053 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 00:39:22,442 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 00:39:22,442 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:39:22,471 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:39:23,702 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:39:24,017 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:39:24,780 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:39:24,781 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:39:24,781 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:39:24,782 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 00:39:24,782 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 00:39:24,783 - src.models.segmentation.segmentation - WARNING - determine_k:106 - Using default k-range [2, 3, 4, 5, 6, 7, 8] for k-determination.
2025-10-25 00:39:24,793 - src.models.segmentation.segmentation - INFO - determine_k:116 - Unique colors: 117. Adjusted k-range for metric search: [2, 8]
2025-10-25 00:39:24,793 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=2
2025-10-25 00:39:26,604 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=2: Silhouette=0.970, CH=1914175.8
2025-10-25 00:39:26,604 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=3
2025-10-25 00:39:28,369 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=3: Silhouette=0.799, CH=1319986.8
2025-10-25 00:39:28,370 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=4
2025-10-25 00:39:30,111 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=4: Silhouette=0.804, CH=1866615.9
2025-10-25 00:39:30,111 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=5
2025-10-25 00:39:31,886 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=5: Silhouette=0.753, CH=1995735.9
2025-10-25 00:39:31,886 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=6
2025-10-25 00:39:33,601 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=6: Silhouette=0.891, CH=2666565.8
2025-10-25 00:39:33,601 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=7
2025-10-25 00:39:35,309 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=7: Silhouette=0.899, CH=4165659.0
2025-10-25 00:39:35,309 - src.models.segmentation.segmentation - INFO - determine_k:144 - Testing k=8
2025-10-25 00:39:37,023 - src.models.segmentation.segmentation - INFO - determine_k:156 - Metrics for k=8: Silhouette=0.943, CH=4786717.0
2025-10-25 00:39:37,023 - src.models.segmentation.segmentation - INFO - determine_k:177 - Optimal k determined: 8 (score: 0.937)
2025-10-25 00:39:37,023 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 00:39:37,024 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 00:39:37,033 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 117. Using dynamic_max_k: 10
2025-10-25 00:39:37,035 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 104.580
2025-10-25 00:39:37,037 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=366.369, std=1982.490, threshold=2348.860
2025-10-25 00:39:37,037 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 00:39:37,037 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 00:39:37,039 - src.models.segmentation.segmentation - INFO - __init__:260 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 00:39:37,039 - src.models.segmentation.segmentation - INFO - quantize_image:212 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:39:37,211 - src.models.segmentation.segmentation - INFO - __init__:430 - SOMSegmenter initialized with k_type: predefined
2025-10-25 00:39:37,212 - src.models.segmentation.segmentation - INFO - quantize_image:212 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:39:37,337 - src.models.segmentation.segmentation - INFO - segment:450 - Running SOM segmentation with k=8
2025-10-25 00:39:37,775 - src.models.segmentation.segmentation - WARNING - segment:470 - SOM empty mask cluster 2 (k=8).
2025-10-25 00:39:37,775 - src.models.segmentation.segmentation - WARNING - segment:470 - SOM empty mask cluster 3 (k=8).
2025-10-25 00:39:37,776 - root - INFO - process_reference_image:346 - Reference image processing finished in 15.72 seconds.
2025-10-25 00:39:38,023 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 00:39:38,138 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 00:39:39,340 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 00:39:39,340 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 00:39:39,340 - root - INFO - timer:154 - Completed: Reference image loading and processing in 17.29 seconds
2025-10-25 00:39:39,347 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 00:39:39,348 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 00:39:39,372 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 00:39:40,638 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:39:40,978 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:39:41,402 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:39:41,403 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:39:41,403 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:39:41,405 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 00:39:41,406 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 00:39:41,407 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:41,407 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 00:39:41,407 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 00:39:41,408 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:41,408 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 00:39:41,409 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.06 seconds
2025-10-25 00:39:41,409 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 00:39:41,410 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:39:41,445 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:39:42,747 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:39:43,070 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:39:43,477 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:39:43,479 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:39:43,479 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:39:43,480 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 00:39:43,480 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 00:39:43,482 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:43,482 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 00:39:43,482 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 00:39:43,483 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:43,483 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 00:39:43,483 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.07 seconds
2025-10-25 00:39:43,484 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 00:39:43,484 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 00:39:43,503 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 00:39:44,729 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:39:45,056 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:39:45,459 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:39:45,460 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:39:45,460 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:39:45,462 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 00:39:45,462 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 00:39:45,463 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:45,463 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 00:39:45,463 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 00:39:45,464 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:45,464 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 00:39:45,465 - root - INFO - timer:154 - Completed: Processing test image block3 in 1.98 seconds
2025-10-25 00:39:45,465 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 00:39:45,466 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 00:39:45,485 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 00:39:46,764 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:39:47,094 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:39:47,543 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:39:47,544 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:39:47,545 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:39:47,546 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 00:39:47,546 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 00:39:47,547 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:47,548 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 00:39:47,548 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 00:39:47,549 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:47,549 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 00:39:47,549 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.08 seconds
2025-10-25 00:39:47,550 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 00:39:47,550 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 00:39:47,574 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 00:39:48,854 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:39:49,170 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:39:49,602 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:39:49,603 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:39:49,603 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:39:49,604 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 00:39:49,604 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 00:39:49,605 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:49,605 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 00:39:49,605 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 00:39:49,606 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:39:49,606 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 00:39:49,607 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.06 seconds
2025-10-25 00:39:49,608 - root - INFO - main:684 - ================================================================================
PROCESSING COMPLETED IN 184.01 SECONDS
================================================================================
2025-10-25 00:39:49,662 - root - INFO - main:692 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 00:46:44,412 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 00:46:44,413 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 00:46:44,424 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 00:46:44,427 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 00:46:44,427 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 00:46:44,427 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 00:46:44,429 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 00:46:44,429 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 00:46:44,431 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 00:46:44,431 - root - INFO - main:601 - Processing dataset: block
2025-10-25 00:46:44,431 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 00:46:45,055 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 00:46:45,873 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 00:46:46,321 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 00:46:46,806 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 00:46:47,307 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 00:46:47,307 - root - INFO - timer:154 - Completed: Loading all test images in 2.89 seconds
2025-10-25 00:46:47,307 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 00:46:47,307 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 00:46:49,156 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 00:46:49,156 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 00:46:49,156 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 00:46:49,156 - root - INFO - timer:154 - Completed: Loading training data in 1.85 seconds
2025-10-25 00:46:49,156 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 00:46:49,156 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 00:46:49,156 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 00:46:49,156 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 00:46:49,172 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 00:46:49,172 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [32.00, 213.00]
2025-10-25 00:46:49,172 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.31], a[-2.00, 3.00], b[-2.00, 8.00]
2025-10-25 00:46:49,172 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 00:46:49,172 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 00:46:49,172 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 00:46:49,172 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 00:46:49,172 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 00:46:49,172 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 00:46:49,456 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.239, 0.240]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.283]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.454, 0.457]
2025-10-25 00:46:49,519 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 00:46:49,525 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 00:46:49,525 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 00:49:29,084 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 159.56s - Final fitness: 0.013018
2025-10-25 00:49:29,085 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 00:49:29,095 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 00:49:29,095 - root - INFO - timer:154 - Completed: DBN initialization and training in 159.93 seconds
2025-10-25 00:49:29,096 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 00:49:29,096 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 00:49:29,466 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 00:49:29,466 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:49:29,508 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:49:30,769 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:49:31,101 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:49:31,864 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:49:31,866 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:49:31,866 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:49:31,866 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 00:49:31,866 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 00:49:31,877 - src.models.segmentation.segmentation - INFO - determine_k:107 - Unique colors: 116. Adjusted k-range for metric search: [2, 8]
2025-10-25 00:49:31,877 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=2
2025-10-25 00:49:33,712 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=2: Silhouette=0.971, CH=2081761.2
2025-10-25 00:49:33,712 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=3
2025-10-25 00:49:35,986 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=3: Silhouette=0.948, CH=1623853.1
2025-10-25 00:49:35,986 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=4
2025-10-25 00:49:38,004 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=4: Silhouette=0.779, CH=1844533.4
2025-10-25 00:49:38,004 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=5
2025-10-25 00:49:39,782 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=5: Silhouette=0.717, CH=1933258.6
2025-10-25 00:49:39,782 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=6
2025-10-25 00:49:41,603 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=6: Silhouette=0.718, CH=2198404.2
2025-10-25 00:49:41,603 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=7
2025-10-25 00:49:43,359 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=7: Silhouette=0.820, CH=3455211.0
2025-10-25 00:49:43,359 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=8
2025-10-25 00:49:45,166 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=8: Silhouette=0.824, CH=4178938.8
2025-10-25 00:49:45,166 - src.models.segmentation.segmentation - INFO - determine_k:161 - Optimal k determined: 8 (based on score: 0.711)
2025-10-25 00:49:45,166 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 00:49:45,166 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 00:49:45,176 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 116. Using dynamic_max_k: 10
2025-10-25 00:49:45,178 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 108.042
2025-10-25 00:49:45,181 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=369.966, std=1978.999, threshold=2348.965
2025-10-25 00:49:45,181 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 00:49:45,181 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 00:49:45,183 - src.models.segmentation.segmentation - INFO - __init__:255 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 00:49:45,183 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:49:45,484 - src.models.segmentation.segmentation - INFO - __init__:515 - SOMSegmenter initialized with k_type: predefined
2025-10-25 00:49:45,485 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 00:49:45,620 - src.models.segmentation.segmentation - INFO - segment:541 - Running SOM segmentation with k=8
2025-10-25 00:49:46,061 - src.models.segmentation.segmentation - WARNING - segment:581 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 00:49:46,061 - src.models.segmentation.segmentation - WARNING - segment:581 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 00:49:46,061 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.97 seconds.
2025-10-25 00:49:46,313 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 00:49:46,452 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 00:49:47,788 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 00:49:47,788 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 00:49:47,789 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.69 seconds
2025-10-25 00:49:47,797 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 00:49:47,797 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 00:49:47,826 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 00:49:49,259 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:49:49,657 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:49:50,099 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:49:50,100 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:49:50,101 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:49:50,102 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 00:49:50,102 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 00:49:50,103 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:50,104 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 00:49:50,104 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 00:49:50,104 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:50,105 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 00:49:50,105 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.31 seconds
2025-10-25 00:49:50,106 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 00:49:50,106 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 00:49:50,136 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 00:49:51,606 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:49:51,936 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:49:52,346 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:49:52,346 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:49:52,346 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:49:52,346 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 00:49:52,346 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 00:49:52,346 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:52,346 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 00:49:52,346 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 00:49:52,346 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:52,346 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 00:49:52,346 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.25 seconds
2025-10-25 00:49:52,360 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 00:49:52,361 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 00:49:52,380 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 00:49:53,649 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:49:53,965 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:49:54,390 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:49:54,392 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:49:54,392 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:49:54,393 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 00:49:54,394 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 00:49:54,395 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:54,395 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 00:49:54,395 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 00:49:54,396 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:54,396 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 00:49:54,397 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.04 seconds
2025-10-25 00:49:54,397 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 00:49:54,398 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 00:49:54,419 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 00:49:55,806 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:49:56,146 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:49:56,589 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:49:56,589 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:49:56,589 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:49:56,589 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 00:49:56,589 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 00:49:56,589 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:56,589 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 00:49:56,589 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 00:49:56,589 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:56,589 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 00:49:56,589 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.21 seconds
2025-10-25 00:49:56,605 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 00:49:56,605 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 00:49:56,623 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 00:49:57,908 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 00:49:58,222 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 00:49:58,634 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 00:49:58,635 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 00:49:58,635 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 00:49:58,636 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 00:49:58,637 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 00:49:58,638 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:58,638 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 00:49:58,638 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 00:49:58,639 - root - ERROR - process_single_test_image:549 - Ellipsis
2025-10-25 00:49:58,639 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 00:49:58,640 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.03 seconds
2025-10-25 00:49:58,641 - root - INFO - main:684 - ================================================================================
PROCESSING COMPLETED IN 194.23 SECONDS
================================================================================
2025-10-25 00:49:58,695 - root - INFO - main:692 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 01:08:28,455 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 01:08:28,456 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 01:08:28,468 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 01:08:28,472 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 01:08:28,472 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 01:08:28,472 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 01:08:28,475 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 01:08:28,476 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 01:08:28,478 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 01:08:28,478 - root - INFO - main:602 - Processing dataset: block
2025-10-25 01:08:28,479 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 01:08:29,125 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 01:08:29,973 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 01:08:30,429 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 01:08:30,939 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 01:08:31,458 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 01:08:31,458 - root - INFO - timer:154 - Completed: Loading all test images in 2.98 seconds
2025-10-25 01:08:31,459 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 01:08:31,459 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 01:08:33,397 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 01:08:33,398 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 01:08:33,402 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 01:08:33,402 - root - INFO - timer:154 - Completed: Loading training data in 1.94 seconds
2025-10-25 01:08:33,402 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 01:08:33,403 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 01:08:33,403 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 01:08:33,403 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 01:08:33,405 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 01:08:33,406 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 214.00]
2025-10-25 01:08:33,406 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[11.76, 84.31], a[-2.00, 3.00], b[-2.00, 9.00]
2025-10-25 01:08:33,407 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 01:08:33,407 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 01:08:33,410 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 01:08:33,410 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 01:08:33,410 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 01:08:33,411 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 01:08:33,709 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 01:08:33,759 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 01:08:33,759 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.241, 0.237]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 01:08:33,760 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.282]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 01:08:33,761 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 01:08:33,762 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 01:08:33,762 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 01:08:33,762 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 01:08:33,762 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.442, 0.454]
2025-10-25 01:08:33,762 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 01:08:33,762 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 01:08:33,762 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 01:11:10,892 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 157.12s - Final fitness: 0.018996
2025-10-25 01:11:10,892 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 01:11:10,902 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 01:11:10,902 - root - INFO - timer:154 - Completed: DBN initialization and training in 157.50 seconds
2025-10-25 01:11:10,903 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 01:11:10,903 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 01:11:11,296 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 01:11:11,296 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:11:11,330 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:11:12,624 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:11:12,961 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:11:13,748 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:11:13,749 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:11:13,749 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:11:13,749 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 01:11:13,750 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 01:11:13,760 - src.models.segmentation.segmentation - INFO - determine_k:107 - Unique colors: 116. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:11:13,760 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=2
2025-10-25 01:11:15,646 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=2: Silhouette=0.970, CH=1852367.8
2025-10-25 01:11:15,646 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=3
2025-10-25 01:11:17,486 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=3: Silhouette=0.821, CH=1307357.0
2025-10-25 01:11:17,486 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=4
2025-10-25 01:11:19,343 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=4: Silhouette=0.822, CH=1922775.6
2025-10-25 01:11:19,343 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=5
2025-10-25 01:11:21,148 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=5: Silhouette=0.768, CH=2077904.6
2025-10-25 01:11:21,148 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=6
2025-10-25 01:11:22,994 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=6: Silhouette=0.773, CH=2086422.1
2025-10-25 01:11:22,994 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=7
2025-10-25 01:11:24,915 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=7: Silhouette=0.905, CH=3100650.2
2025-10-25 01:11:24,915 - src.models.segmentation.segmentation - INFO - determine_k:131 - Testing k=8
2025-10-25 01:11:26,726 - src.models.segmentation.segmentation - INFO - determine_k:145 - Metrics for k=8: Silhouette=0.910, CH=5102699.5
2025-10-25 01:11:26,727 - src.models.segmentation.segmentation - INFO - determine_k:161 - Optimal k determined: 8 (based on score: 0.850)
2025-10-25 01:11:26,727 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 01:11:26,727 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 01:11:26,737 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 116. Using dynamic_max_k: 10
2025-10-25 01:11:26,739 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 106.311
2025-10-25 01:11:26,742 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=372.548, std=2004.967, threshold=2377.516
2025-10-25 01:11:26,742 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 01:11:26,742 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 01:11:26,744 - src.models.segmentation.segmentation - INFO - __init__:255 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:11:26,744 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:11:26,941 - src.models.segmentation.segmentation - INFO - __init__:515 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:11:26,941 - src.models.segmentation.segmentation - INFO - quantize_image:194 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:11:27,079 - src.models.segmentation.segmentation - INFO - segment:541 - Running SOM segmentation with k=8
2025-10-25 01:11:27,525 - src.models.segmentation.segmentation - WARNING - segment:581 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:11:27,525 - src.models.segmentation.segmentation - WARNING - segment:581 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:11:27,525 - src.models.segmentation.segmentation - WARNING - segment:581 - SOM generated empty mask for cluster 4 (k=8). Skipping avg color.
2025-10-25 01:11:27,526 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.62 seconds.
2025-10-25 01:11:27,799 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 01:11:27,927 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 01:11:29,174 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 01:11:29,174 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 01:11:29,174 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.27 seconds
2025-10-25 01:11:29,182 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 01:11:29,183 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 01:11:29,213 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 01:11:30,547 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:11:30,894 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:11:31,385 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:11:31,386 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:11:31,387 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:11:31,388 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 01:11:31,388 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 01:11:31,389 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:31,389 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 01:11:31,389 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 01:11:31,390 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:31,390 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 01:11:31,390 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.21 seconds
2025-10-25 01:11:31,391 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 01:11:31,391 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:11:31,424 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:11:32,715 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:11:33,044 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:11:33,470 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:11:33,471 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:11:33,471 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:11:33,472 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 01:11:33,473 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 01:11:33,474 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:33,474 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 01:11:33,474 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 01:11:33,475 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:33,475 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 01:11:33,475 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.08 seconds
2025-10-25 01:11:33,475 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 01:11:33,476 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 01:11:33,499 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 01:11:34,781 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:11:35,132 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:11:35,554 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:11:35,556 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:11:35,556 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:11:35,558 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 01:11:35,558 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 01:11:35,559 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:35,559 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 01:11:35,559 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 01:11:35,560 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:35,560 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 01:11:35,561 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.09 seconds
2025-10-25 01:11:35,561 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 01:11:35,562 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 01:11:35,586 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 01:11:36,944 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:11:37,279 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:11:37,734 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:11:37,735 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:11:37,735 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:11:37,736 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 01:11:37,737 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 01:11:37,737 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:37,738 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 01:11:37,738 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 01:11:37,738 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:37,739 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 01:11:37,739 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.18 seconds
2025-10-25 01:11:37,740 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 01:11:37,740 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 01:11:37,764 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 01:11:39,074 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:11:39,402 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:11:39,810 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:11:39,811 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:11:39,811 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:11:39,812 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 01:11:39,813 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 01:11:39,814 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:39,814 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 01:11:39,814 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 01:11:39,815 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:11:39,815 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 01:11:39,815 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.08 seconds
2025-10-25 01:11:39,817 - root - INFO - main:685 - ================================================================================
PROCESSING COMPLETED IN 191.36 SECONDS
================================================================================
2025-10-25 01:11:39,866 - root - INFO - main:693 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 01:15:45,905 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 01:15:45,906 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 01:15:45,919 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 01:15:45,924 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 01:15:45,924 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 01:15:45,924 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 01:15:45,927 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 01:15:45,928 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 01:15:45,930 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 01:15:45,930 - root - INFO - main:602 - Processing dataset: block
2025-10-25 01:15:45,930 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 01:15:46,734 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 01:15:47,674 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 01:15:48,349 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 01:15:48,934 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 01:15:49,540 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 01:15:49,541 - root - INFO - timer:154 - Completed: Loading all test images in 3.61 seconds
2025-10-25 01:15:49,541 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 01:15:49,541 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 01:15:51,677 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 01:15:51,677 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 01:15:51,681 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 01:15:51,682 - root - INFO - timer:154 - Completed: Loading training data in 2.14 seconds
2025-10-25 01:15:51,682 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 01:15:51,682 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 01:15:51,682 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 01:15:51,683 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 01:15:51,685 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 01:15:51,685 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 215.00]
2025-10-25 01:15:51,685 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[11.76, 84.71], a[-2.00, 2.00], b[-2.00, 8.00]
2025-10-25 01:15:51,687 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 01:15:51,687 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 01:15:51,691 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 01:15:51,691 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 01:15:51,691 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 01:15:51,692 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 01:15:51,997 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 01:15:52,056 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 01:15:52,056 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.241]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 01:15:52,057 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.282]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 01:15:52,058 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 01:15:52,059 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 01:15:52,059 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 01:15:52,059 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.457, 0.461]
2025-10-25 01:15:52,059 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 01:15:52,059 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 01:15:52,059 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 01:18:12,817 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 140.75s - Final fitness: 0.035191
2025-10-25 01:18:12,817 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 01:18:12,827 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 01:18:12,827 - root - INFO - timer:154 - Completed: DBN initialization and training in 141.15 seconds
2025-10-25 01:18:12,828 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 01:18:12,829 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 01:18:13,232 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 01:18:13,232 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:18:13,259 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:18:14,536 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:18:14,851 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:18:15,634 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:18:15,635 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:18:15,635 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:18:15,635 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 01:18:15,635 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 01:18:15,646 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 118. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:18:15,646 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:18:17,518 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.971, CH=1928419.2
2025-10-25 01:18:17,518 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:18:19,408 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.949, CH=1736550.6
2025-10-25 01:18:19,409 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:18:21,249 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.838, CH=2100819.8
2025-10-25 01:18:21,250 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:18:23,090 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.944, CH=1990492.0
2025-10-25 01:18:23,090 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:18:24,896 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.939, CH=2117556.2
2025-10-25 01:18:24,896 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:18:26,690 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.845, CH=3010854.2
2025-10-25 01:18:26,691 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:18:28,441 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.946, CH=4690803.5
2025-10-25 01:18:28,442 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.908)
2025-10-25 01:18:28,442 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 01:18:28,442 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 01:18:28,451 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 118. Using dynamic_max_k: 10
2025-10-25 01:18:28,453 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 106.311
2025-10-25 01:18:28,455 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=371.057, std=2016.944, threshold=2388.001
2025-10-25 01:18:28,455 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 01:18:28,455 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 01:18:28,457 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:18:28,457 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:18:28,640 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:18:28,641 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:18:28,772 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:18:29,242 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:18:29,242 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:18:29,242 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 4 (k=8). Skipping avg color.
2025-10-25 01:18:29,243 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.41 seconds.
2025-10-25 01:18:29,506 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 01:18:29,626 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 01:18:30,829 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 01:18:30,830 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 01:18:30,830 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.00 seconds
2025-10-25 01:18:30,837 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 01:18:30,837 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 01:18:30,866 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 01:18:32,177 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:18:32,532 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:18:32,954 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:18:32,955 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:18:32,956 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:18:32,957 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 01:18:32,958 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 01:18:32,959 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:32,959 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 01:18:32,959 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 01:18:32,960 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:32,960 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 01:18:32,960 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.12 seconds
2025-10-25 01:18:32,961 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 01:18:32,962 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:18:32,994 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:18:34,293 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:18:34,634 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:18:35,062 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:18:35,064 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:18:35,064 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:18:35,065 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 01:18:35,066 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 01:18:35,067 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:35,067 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 01:18:35,067 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 01:18:35,068 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:35,068 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 01:18:35,069 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.11 seconds
2025-10-25 01:18:35,069 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 01:18:35,070 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 01:18:35,096 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 01:18:36,391 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:18:36,699 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:18:37,104 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:18:37,106 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:18:37,106 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:18:37,108 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 01:18:37,108 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 01:18:37,109 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:37,110 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 01:18:37,110 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 01:18:37,111 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:37,111 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 01:18:37,111 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.04 seconds
2025-10-25 01:18:37,112 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 01:18:37,112 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 01:18:37,138 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 01:18:38,499 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:18:38,830 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:18:39,250 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:18:39,251 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:18:39,251 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:18:39,252 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 01:18:39,253 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 01:18:39,254 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:39,254 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 01:18:39,254 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 01:18:39,255 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:39,255 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 01:18:39,256 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.14 seconds
2025-10-25 01:18:39,256 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 01:18:39,257 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 01:18:39,279 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 01:18:40,628 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:18:40,949 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:18:41,373 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:18:41,374 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:18:41,375 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:18:41,376 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 01:18:41,376 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 01:18:41,377 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:41,377 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 01:18:41,377 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 01:18:41,378 - root - ERROR - process_single_test_image:550 - Ellipsis
2025-10-25 01:18:41,378 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 01:18:41,379 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.12 seconds
2025-10-25 01:18:41,380 - root - INFO - main:685 - ================================================================================
PROCESSING COMPLETED IN 175.48 SECONDS
================================================================================
2025-10-25 01:18:41,426 - root - INFO - main:693 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 01:26:14,955 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 01:26:14,956 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 01:26:14,969 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 01:26:14,972 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 01:26:14,972 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 01:26:14,972 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 01:26:14,975 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 01:26:14,975 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 01:26:14,977 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 01:26:14,977 - root - INFO - main:608 - Processing dataset: block
2025-10-25 01:26:14,979 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 01:26:15,664 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 01:26:16,520 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 01:26:17,005 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 01:26:17,524 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 01:26:18,037 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 01:26:18,037 - root - INFO - timer:154 - Completed: Loading all test images in 3.06 seconds
2025-10-25 01:26:18,037 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 01:26:18,038 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 01:26:20,065 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 01:26:20,066 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 01:26:20,070 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 01:26:20,070 - root - INFO - timer:154 - Completed: Loading training data in 2.03 seconds
2025-10-25 01:26:20,071 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 01:26:20,071 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 01:26:20,071 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 01:26:20,071 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 01:26:20,074 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 01:26:20,074 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [32.00, 213.00]
2025-10-25 01:26:20,075 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.31], a[-2.00, 2.00], b[-1.00, 8.00]
2025-10-25 01:26:20,076 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 01:26:20,076 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 01:26:20,082 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 01:26:20,082 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 01:26:20,082 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 01:26:20,082 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 01:26:20,371 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 01:26:20,428 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.240]
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 01:26:20,429 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.282]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 01:26:20,430 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 01:26:20,431 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 01:26:20,431 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 01:26:20,431 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.462, 0.458]
2025-10-25 01:26:20,431 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 01:26:20,431 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 01:26:20,431 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 01:28:51,979 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 151.54s - Final fitness: 0.040410
2025-10-25 01:28:51,979 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 01:28:51,990 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 01:28:51,990 - root - INFO - timer:154 - Completed: DBN initialization and training in 151.92 seconds
2025-10-25 01:28:51,991 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 01:28:51,991 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 01:28:52,435 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 01:28:52,435 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:28:52,466 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:28:53,777 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:28:54,094 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:28:54,844 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:28:54,845 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:28:54,845 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:28:54,845 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 01:28:54,845 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 01:28:54,856 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 107. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:28:54,857 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:28:56,739 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.970, CH=1874056.2
2025-10-25 01:28:56,739 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:28:58,646 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.947, CH=1605900.1
2025-10-25 01:28:58,646 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:29:00,494 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.809, CH=1848090.4
2025-10-25 01:29:00,495 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:29:02,304 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.943, CH=1909713.0
2025-10-25 01:29:02,304 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:29:04,107 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.935, CH=2231179.5
2025-10-25 01:29:04,107 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:29:05,940 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.906, CH=3619498.0
2025-10-25 01:29:05,940 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:29:07,760 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.940, CH=3890680.5
2025-10-25 01:29:07,760 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.905)
2025-10-25 01:29:07,761 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 01:29:07,761 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 01:29:07,770 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 107. Using dynamic_max_k: 10
2025-10-25 01:29:07,773 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 103.446
2025-10-25 01:29:07,775 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=370.325, std=1949.660, threshold=2319.985
2025-10-25 01:29:07,775 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 01:29:07,775 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 01:29:07,776 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:29:07,777 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:29:07,980 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:29:07,980 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:29:08,125 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:29:08,622 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:29:08,622 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:29:08,622 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.63 seconds.
2025-10-25 01:29:08,911 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 01:29:09,033 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 01:29:10,272 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 01:29:10,273 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 01:29:10,273 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.28 seconds
2025-10-25 01:29:10,280 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 01:29:10,280 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 01:29:10,306 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 01:29:11,673 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:29:12,042 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:29:12,474 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:29:12,476 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:29:12,476 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:29:12,477 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 01:29:12,478 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 01:29:12,481 - root - ERROR - process_single_test_image:555 - Segmentation failed for block1 with determined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:12,481 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 0.00 seconds
2025-10-25 01:29:12,481 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 01:29:12,483 - root - ERROR - process_single_test_image:555 - Segmentation failed for block1 with predefined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:12,484 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 0.00 seconds
2025-10-25 01:29:12,484 - root - INFO - timer:154 - Completed: Processing test image block1 in 2.20 seconds
2025-10-25 01:29:12,485 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 01:29:12,486 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:29:12,520 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:29:13,869 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:29:14,227 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:29:14,629 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:29:14,630 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:29:14,630 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:29:14,632 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 01:29:14,633 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 01:29:14,635 - root - ERROR - process_single_test_image:555 - Segmentation failed for block2 with determined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:14,635 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 0.00 seconds
2025-10-25 01:29:14,636 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 01:29:14,638 - root - ERROR - process_single_test_image:555 - Segmentation failed for block2 with predefined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:14,638 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 0.00 seconds
2025-10-25 01:29:14,639 - root - INFO - timer:154 - Completed: Processing test image block2 in 2.15 seconds
2025-10-25 01:29:14,639 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 01:29:14,640 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 01:29:14,661 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 01:29:15,972 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:29:16,310 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:29:16,753 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:29:16,755 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:29:16,755 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:29:16,756 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 01:29:16,757 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 01:29:16,759 - root - ERROR - process_single_test_image:555 - Segmentation failed for block3 with determined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:16,760 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 0.00 seconds
2025-10-25 01:29:16,760 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 01:29:16,762 - root - ERROR - process_single_test_image:555 - Segmentation failed for block3 with predefined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:16,763 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 0.00 seconds
2025-10-25 01:29:16,764 - root - INFO - timer:154 - Completed: Processing test image block3 in 2.12 seconds
2025-10-25 01:29:16,765 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 01:29:16,765 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 01:29:16,790 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 01:29:18,194 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:29:18,527 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:29:18,967 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:29:18,968 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:29:18,968 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:29:18,969 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 01:29:18,970 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 01:29:18,972 - root - ERROR - process_single_test_image:555 - Segmentation failed for block4 with determined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:18,973 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 0.00 seconds
2025-10-25 01:29:18,973 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 01:29:18,975 - root - ERROR - process_single_test_image:555 - Segmentation failed for block4 with predefined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:18,975 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 0.00 seconds
2025-10-25 01:29:18,976 - root - INFO - timer:154 - Completed: Processing test image block4 in 2.21 seconds
2025-10-25 01:29:18,976 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 01:29:18,977 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 01:29:19,000 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 01:29:20,330 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:29:20,661 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:29:21,106 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:29:21,107 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:29:21,107 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:29:21,108 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 01:29:21,108 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 01:29:21,110 - root - ERROR - process_single_test_image:555 - Segmentation failed for block5 with determined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:21,111 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 0.00 seconds
2025-10-25 01:29:21,111 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 01:29:21,113 - root - ERROR - process_single_test_image:555 - Segmentation failed for block5 with predefined: KeyError: 's'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 519, in process_single_test_image
    scalers=[scalers['scaler_x'], scalers['scaler_y'], scalers['s']], # Pass as list
KeyError: 's'
2025-10-25 01:29:21,113 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 0.00 seconds
2025-10-25 01:29:21,114 - root - INFO - timer:154 - Completed: Processing test image block5 in 2.14 seconds
2025-10-25 01:29:21,115 - root - INFO - main:691 - ================================================================================
PROCESSING COMPLETED IN 186.16 SECONDS
================================================================================
2025-10-25 01:29:21,163 - root - INFO - main:699 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 01:32:48,427 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 01:32:48,428 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 01:32:48,441 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 01:32:48,443 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 01:32:48,444 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 01:32:48,444 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 01:32:48,446 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 01:32:48,446 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 01:32:48,449 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 01:32:48,450 - root - INFO - main:608 - Processing dataset: block
2025-10-25 01:32:48,451 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 01:32:49,173 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 01:32:50,052 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 01:32:50,522 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 01:32:51,037 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 01:32:51,572 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 01:32:51,572 - root - INFO - timer:154 - Completed: Loading all test images in 3.12 seconds
2025-10-25 01:32:51,573 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 01:32:51,573 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 01:32:53,584 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 01:32:53,584 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 01:32:53,590 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 01:32:53,590 - root - INFO - timer:154 - Completed: Loading training data in 2.02 seconds
2025-10-25 01:32:53,590 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 01:32:53,591 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 01:32:53,591 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 01:32:53,591 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 01:32:53,596 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 01:32:53,596 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 214.00]
2025-10-25 01:32:53,596 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[11.76, 84.31], a[-2.00, 2.00], b[-1.00, 8.00]
2025-10-25 01:32:53,598 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 01:32:53,598 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 01:32:53,603 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 01:32:53,603 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 01:32:53,604 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 01:32:53,604 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 01:32:53,901 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 01:32:53,960 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 01:32:53,960 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.241]
2025-10-25 01:32:53,960 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 01:32:53,961 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.282]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 01:32:53,962 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 01:32:53,963 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 01:32:53,963 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 01:32:53,963 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.448, 0.463]
2025-10-25 01:32:53,963 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 01:32:53,963 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 01:32:53,963 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 01:35:36,295 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 162.32s - Final fitness: 0.045005
2025-10-25 01:35:36,295 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 01:35:36,305 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 01:35:36,305 - root - INFO - timer:154 - Completed: DBN initialization and training in 162.72 seconds
2025-10-25 01:35:36,306 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 01:35:36,306 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 01:35:36,696 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 01:35:36,697 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:35:36,727 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:35:38,032 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:35:38,353 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:35:39,128 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:35:39,129 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:35:39,129 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:35:39,129 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 01:35:39,130 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 01:35:39,141 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 111. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:35:39,141 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:35:41,186 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.970, CH=1802043.2
2025-10-25 01:35:41,186 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:35:43,202 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.796, CH=1208665.8
2025-10-25 01:35:43,202 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:35:45,079 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.803, CH=1832646.4
2025-10-25 01:35:45,079 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:35:46,905 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.944, CH=1916141.1
2025-10-25 01:35:46,905 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:35:49,064 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.936, CH=2230498.2
2025-10-25 01:35:49,064 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:35:51,057 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.904, CH=3568156.5
2025-10-25 01:35:51,057 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:35:52,865 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.946, CH=4223537.0
2025-10-25 01:35:52,866 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.930)
2025-10-25 01:35:52,866 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 01:35:52,866 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 01:35:52,876 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 111. Using dynamic_max_k: 10
2025-10-25 01:35:52,878 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 105.769
2025-10-25 01:35:52,880 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=374.391, std=1995.643, threshold=2370.034
2025-10-25 01:35:52,880 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 01:35:52,880 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 01:35:52,881 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:35:52,882 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:35:53,065 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:35:53,066 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:35:53,199 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:35:53,690 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:35:53,690 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:35:53,691 - root - INFO - process_reference_image:346 - Reference image processing finished in 17.38 seconds.
2025-10-25 01:35:53,966 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 01:35:54,089 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 01:35:55,318 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 01:35:55,319 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 01:35:55,319 - root - INFO - timer:154 - Completed: Reference image loading and processing in 19.01 seconds
2025-10-25 01:35:55,327 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 01:35:55,327 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 01:35:55,358 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 01:35:56,713 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:35:57,113 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:35:57,538 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:35:57,539 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:35:57,539 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:35:57,540 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 01:35:57,541 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 01:35:57,544 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:35:57,548 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:35:57,551 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:35:57,552 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:35:57,552 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:35:57,553 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:35:57,553 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:35:57,766 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:35:57,766 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:35:57,768 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:35:59,657 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.986, CH=2828374.2
2025-10-25 01:35:59,657 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:36:01,538 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.978, CH=4290683.0
2025-10-25 01:36:01,539 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:36:03,437 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.969, CH=4192395.0
2025-10-25 01:36:03,437 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:36:05,320 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.954, CH=4131505.8
2025-10-25 01:36:05,320 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:36:07,179 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.897, CH=5228626.0
2025-10-25 01:36:07,180 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:36:09,045 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.897, CH=6353310.5
2025-10-25 01:36:09,045 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:36:10,897 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.906, CH=8052819.5
2025-10-25 01:36:10,897 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 3 (based on score: 0.594)
2025-10-25 01:36:10,914 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.36s with 3 clusters.
2025-10-25 01:36:10,916 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:36:10,916 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:36:10,917 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:36:11,070 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:36:11,070 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:36:11,071 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:36:13,020 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.986, CH=2812363.5
2025-10-25 01:36:13,020 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:36:14,913 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.978, CH=4567257.5
2025-10-25 01:36:14,914 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:36:16,797 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.965, CH=3986410.5
2025-10-25 01:36:16,797 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:36:18,688 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.955, CH=4531906.0
2025-10-25 01:36:18,688 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:36:20,543 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.902, CH=5698208.5
2025-10-25 01:36:20,543 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:36:22,376 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.903, CH=7269333.5
2025-10-25 01:36:22,377 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:36:24,251 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.903, CH=7576965.0
2025-10-25 01:36:24,251 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 3 (based on score: 0.636)
2025-10-25 01:36:24,251 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=3
2025-10-25 01:36:24,691 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.78s with 3 clusters.
2025-10-25 01:36:24,692 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:36:24,693 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:36:24,693 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:36:24,811 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:36:26,671 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 5 clusters.
2025-10-25 01:36:32,179 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=5, silhouette: 0.960
2025-10-25 01:36:33,904 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 6 clusters.
2025-10-25 01:36:39,498 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=6, silhouette: 0.955
2025-10-25 01:36:41,186 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 4 clusters.
2025-10-25 01:36:46,720 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=4, silhouette: 0.963
2025-10-25 01:36:48,453 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:36:48,454 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:36:50,231 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 3 clusters.
2025-10-25 01:36:55,820 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=10) -> clusters=3, silhouette: 0.970
2025-10-25 01:36:57,603 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 3 clusters.
2025-10-25 01:37:03,080 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=3, silhouette: 0.975
2025-10-25 01:37:04,820 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:37:04,820 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:37:06,633 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:37:06,633 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:37:08,385 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:37:13,903 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.970
2025-10-25 01:37:13,903 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=15, min_samples=20
2025-10-25 01:37:15,653 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 3 clusters.
2025-10-25 01:37:15,671 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 50.98s with 3 clusters.
2025-10-25 01:37:15,674 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:37:15,675 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:37:15,676 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 78.14 seconds
2025-10-25 01:37:15,677 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 01:37:15,681 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:37:15,685 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:37:15,689 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:37:15,689 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:37:15,689 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:37:15,690 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:37:15,690 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:37:15,838 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.14s with 2 clusters.
2025-10-25 01:37:15,840 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:37:15,840 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:37:15,840 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:37:16,000 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:37:16,477 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.64s with 2 clusters.
2025-10-25 01:37:16,478 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:37:16,478 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:37:16,478 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:37:16,595 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:37:18,433 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 5 clusters.
2025-10-25 01:37:18,454 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.98s with 5 clusters.
2025-10-25 01:37:18,455 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:37:18,455 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:37:18,457 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 2.78 seconds
2025-10-25 01:37:18,458 - root - INFO - timer:154 - Completed: Processing test image block1 in 83.13 seconds
2025-10-25 01:37:18,458 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 01:37:18,459 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:37:18,492 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:37:19,846 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:37:20,183 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:37:20,607 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:37:20,608 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:37:20,609 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:37:20,610 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 01:37:20,610 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 01:37:20,614 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:37:20,618 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:37:20,621 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:37:20,622 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:37:20,622 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:37:20,622 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:37:20,623 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:37:20,770 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:37:20,770 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:37:20,772 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:37:22,661 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.981, CH=2504983.2
2025-10-25 01:37:22,661 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:37:24,629 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.966, CH=2766195.5
2025-10-25 01:37:24,629 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:37:26,525 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.950, CH=2622377.0
2025-10-25 01:37:26,525 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:37:28,399 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.937, CH=2476370.5
2025-10-25 01:37:28,399 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:37:30,305 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.855, CH=3075288.2
2025-10-25 01:37:30,306 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:37:32,133 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.830, CH=3546745.0
2025-10-25 01:37:32,133 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:37:33,950 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.920, CH=5625964.5
2025-10-25 01:37:33,950 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.798)
2025-10-25 01:37:34,009 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.39s with 8 clusters.
2025-10-25 01:37:34,010 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:37:34,010 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:37:34,010 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:37:34,163 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:37:34,164 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:37:34,165 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:37:36,144 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.981, CH=2514499.5
2025-10-25 01:37:36,144 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:37:38,057 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.968, CH=2855102.8
2025-10-25 01:37:38,057 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:37:39,954 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.953, CH=2781413.8
2025-10-25 01:37:39,955 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:37:41,810 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.905, CH=2482358.0
2025-10-25 01:37:41,810 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:37:43,646 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.821, CH=3069611.2
2025-10-25 01:37:43,647 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:37:45,465 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.833, CH=4035854.5
2025-10-25 01:37:45,465 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:37:47,271 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.918, CH=6876205.5
2025-10-25 01:37:47,271 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.802)
2025-10-25 01:37:47,271 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:37:47,686 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:37:47,686 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:37:47,686 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 6 (k=8). Skipping avg color.
2025-10-25 01:37:47,687 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.68s with 8 clusters.
2025-10-25 01:37:47,688 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:37:47,688 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:37:47,688 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:37:47,811 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:37:49,817 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 5 clusters.
2025-10-25 01:37:55,286 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=5, silhouette: 0.955
2025-10-25 01:37:57,143 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 5 clusters.
2025-10-25 01:38:02,590 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=5, silhouette: 0.955
2025-10-25 01:38:04,421 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 5 clusters.
2025-10-25 01:38:10,062 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=5, silhouette: 0.926
2025-10-25 01:38:11,924 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:38:11,924 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:38:13,994 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 1 clusters.
2025-10-25 01:38:13,994 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:38:15,936 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 2 clusters.
2025-10-25 01:38:21,639 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=2, silhouette: 0.967
2025-10-25 01:38:23,982 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:38:23,983 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:38:26,398 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:38:26,398 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:38:28,409 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:38:34,598 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.964
2025-10-25 01:38:34,598 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=15, min_samples=20
2025-10-25 01:38:36,494 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 2 clusters.
2025-10-25 01:38:36,535 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 48.85s with 2 clusters.
2025-10-25 01:38:36,537 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:38:36,537 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:38:36,541 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 75.93 seconds
2025-10-25 01:38:36,541 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 01:38:36,552 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:38:36,556 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:38:36,561 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:38:36,562 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:38:36,562 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:38:36,562 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:38:36,563 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:38:36,757 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.19s with 2 clusters.
2025-10-25 01:38:36,758 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:38:36,759 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:38:36,759 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:38:36,922 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:38:37,419 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.66s with 2 clusters.
2025-10-25 01:38:37,420 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:38:37,421 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:38:37,421 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:38:37,561 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:38:39,689 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 5 clusters.
2025-10-25 01:38:39,709 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 2.29s with 5 clusters.
2025-10-25 01:38:39,710 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:38:39,710 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:38:39,712 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 3.17 seconds
2025-10-25 01:38:39,713 - root - INFO - timer:154 - Completed: Processing test image block2 in 81.25 seconds
2025-10-25 01:38:39,714 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 01:38:39,715 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 01:38:39,739 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 01:38:41,170 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:38:41,518 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:38:41,941 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:38:41,943 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:38:41,943 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:38:41,944 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 01:38:41,945 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 01:38:41,951 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:38:41,954 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:38:41,958 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:38:41,959 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:38:41,959 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:38:41,960 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:38:41,960 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:38:42,129 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:38:42,129 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:38:42,132 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:38:44,108 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.967, CH=1734522.9
2025-10-25 01:38:44,108 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:38:46,103 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.936, CH=1221756.6
2025-10-25 01:38:46,104 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:38:48,003 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.866, CH=1598228.5
2025-10-25 01:38:48,003 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:38:49,939 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.861, CH=1973955.9
2025-10-25 01:38:49,939 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:38:51,766 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.911, CH=2646201.0
2025-10-25 01:38:51,766 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:38:53,600 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.921, CH=3987693.2
2025-10-25 01:38:53,600 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:38:55,410 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.953, CH=4347355.5
2025-10-25 01:38:55,410 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.936)
2025-10-25 01:38:55,469 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.51s with 8 clusters.
2025-10-25 01:38:55,470 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:38:55,470 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:38:55,470 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:38:55,630 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:38:55,630 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:38:55,632 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:38:57,619 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.967, CH=1759605.2
2025-10-25 01:38:57,620 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:38:59,476 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.783, CH=1232342.8
2025-10-25 01:38:59,476 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:39:01,359 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.771, CH=1331362.4
2025-10-25 01:39:01,359 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:39:03,333 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.899, CH=1635093.2
2025-10-25 01:39:03,333 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:39:05,198 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.911, CH=2593926.8
2025-10-25 01:39:05,199 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:39:07,000 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.918, CH=3818299.2
2025-10-25 01:39:07,000 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:39:08,849 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.922, CH=5719173.5
2025-10-25 01:39:08,849 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.887)
2025-10-25 01:39:08,849 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:39:09,289 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.82s with 8 clusters.
2025-10-25 01:39:09,290 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:39:09,291 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:39:09,291 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:39:09,408 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:39:10,476 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 7 clusters.
2025-10-25 01:39:15,835 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=7, silhouette: 0.848
2025-10-25 01:39:16,856 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 7 clusters.
2025-10-25 01:39:22,198 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=7, silhouette: 0.835
2025-10-25 01:39:23,212 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 3 clusters.
2025-10-25 01:39:28,719 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=3, silhouette: 0.907
2025-10-25 01:39:30,442 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:39:30,442 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:39:32,155 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 1 clusters.
2025-10-25 01:39:32,155 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:39:33,773 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 2 clusters.
2025-10-25 01:39:39,199 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=2, silhouette: 0.933
2025-10-25 01:39:41,107 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:39:41,108 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:39:43,068 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:39:43,069 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:39:44,725 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:39:50,061 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.924
2025-10-25 01:39:50,061 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=15, min_samples=20
2025-10-25 01:39:51,615 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 2 clusters.
2025-10-25 01:39:51,644 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 42.35s with 2 clusters.
2025-10-25 01:39:51,645 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:39:51,646 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:39:51,648 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 69.70 seconds
2025-10-25 01:39:51,648 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 01:39:51,652 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:39:51,656 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:39:51,659 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:39:51,660 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:39:51,660 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:39:51,660 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:39:51,661 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:39:51,804 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.14s with 2 clusters.
2025-10-25 01:39:51,806 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:39:51,807 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:39:51,807 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:39:51,957 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:39:52,448 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.64s with 2 clusters.
2025-10-25 01:39:52,449 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:39:52,449 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:39:52,450 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:39:52,581 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:39:53,707 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 7 clusters.
2025-10-25 01:39:53,741 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.29s with 7 clusters.
2025-10-25 01:39:53,743 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:39:53,743 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:39:53,746 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 2.10 seconds
2025-10-25 01:39:53,746 - root - INFO - timer:154 - Completed: Processing test image block3 in 74.03 seconds
2025-10-25 01:39:53,747 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 01:39:53,748 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 01:39:53,777 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 01:39:55,206 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:39:55,559 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:39:55,993 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:39:55,994 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:39:55,994 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:39:55,996 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 01:39:55,997 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 01:39:56,001 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:39:56,004 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:39:56,008 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:39:56,009 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:39:56,009 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:39:56,009 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:39:56,010 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:39:56,167 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:39:56,168 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:39:56,169 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:39:58,075 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.979, CH=2733576.2
2025-10-25 01:39:58,076 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:40:00,051 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.964, CH=2867804.8
2025-10-25 01:40:00,051 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:40:01,930 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.962, CH=3008202.2
2025-10-25 01:40:01,930 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:40:03,848 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.958, CH=3389032.2
2025-10-25 01:40:03,849 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:40:05,707 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.883, CH=5842935.5
2025-10-25 01:40:05,707 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:40:07,543 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.883, CH=5934344.5
2025-10-25 01:40:07,543 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:40:09,406 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.962, CH=7815538.0
2025-10-25 01:40:09,406 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.910)
2025-10-25 01:40:09,464 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.45s with 8 clusters.
2025-10-25 01:40:09,465 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:40:09,465 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:40:09,465 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:40:09,652 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:40:09,652 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:40:09,654 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:40:11,615 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.978, CH=2402399.5
2025-10-25 01:40:11,616 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:40:13,500 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.963, CH=2590283.0
2025-10-25 01:40:13,500 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:40:15,396 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.875, CH=2188293.2
2025-10-25 01:40:15,396 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:40:17,262 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.873, CH=2855170.8
2025-10-25 01:40:17,262 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:40:19,152 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.884, CH=4519526.5
2025-10-25 01:40:19,152 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:40:21,010 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.956, CH=4704041.0
2025-10-25 01:40:21,011 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:40:22,838 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.961, CH=6812387.0
2025-10-25 01:40:22,838 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.919)
2025-10-25 01:40:22,838 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:40:23,280 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:40:23,280 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 4 (k=8). Skipping avg color.
2025-10-25 01:40:23,280 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 5 (k=8). Skipping avg color.
2025-10-25 01:40:23,280 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 7 (k=8). Skipping avg color.
2025-10-25 01:40:23,281 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.82s with 8 clusters.
2025-10-25 01:40:23,282 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:40:23,282 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:40:23,282 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:40:23,400 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:40:25,237 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 4 clusters.
2025-10-25 01:40:30,887 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=4, silhouette: 0.950
2025-10-25 01:40:32,613 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 7 clusters.
2025-10-25 01:40:38,213 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=7, silhouette: 0.922
2025-10-25 01:40:39,936 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 4 clusters.
2025-10-25 01:40:45,675 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=4, silhouette: 0.919
2025-10-25 01:40:47,813 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:40:47,813 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:40:49,910 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 1 clusters.
2025-10-25 01:40:49,910 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:40:51,633 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 4 clusters.
2025-10-25 01:40:57,291 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=4, silhouette: 0.945
2025-10-25 01:40:59,402 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:40:59,402 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:41:01,586 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:41:01,586 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:41:03,309 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 2 clusters.
2025-10-25 01:41:08,928 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=2, silhouette: 0.978
2025-10-25 01:41:08,928 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=20, min_samples=20
2025-10-25 01:41:10,674 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 2 clusters.
2025-10-25 01:41:10,695 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 47.41s with 2 clusters.
2025-10-25 01:41:10,696 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:41:10,696 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:41:10,698 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 74.70 seconds
2025-10-25 01:41:10,698 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 01:41:10,702 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:41:10,706 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:41:10,710 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:41:10,711 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:41:10,711 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:41:10,712 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:41:10,712 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:41:10,861 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.15s with 2 clusters.
2025-10-25 01:41:10,863 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:41:10,863 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:41:10,863 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:41:11,016 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:41:11,508 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.64s with 2 clusters.
2025-10-25 01:41:11,509 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:41:11,510 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:41:11,510 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:41:11,627 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:41:13,467 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 4 clusters.
2025-10-25 01:41:13,489 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.98s with 4 clusters.
2025-10-25 01:41:13,491 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:41:13,492 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:41:13,494 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 2.80 seconds
2025-10-25 01:41:13,494 - root - INFO - timer:154 - Completed: Processing test image block4 in 79.75 seconds
2025-10-25 01:41:13,495 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 01:41:13,496 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 01:41:13,521 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 01:41:14,921 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:41:15,251 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:41:15,682 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:41:15,683 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:41:15,683 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:41:15,684 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 01:41:15,685 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 01:41:15,688 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:41:15,691 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:41:15,694 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:41:15,695 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:41:15,695 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:41:15,695 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:41:15,696 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:41:15,859 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:41:15,859 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:41:15,861 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:41:17,764 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.977, CH=2360287.5
2025-10-25 01:41:17,764 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:41:19,747 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.960, CH=2414459.0
2025-10-25 01:41:19,748 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:41:21,662 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.940, CH=2177716.0
2025-10-25 01:41:21,662 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:41:23,542 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.817, CH=2262844.8
2025-10-25 01:41:23,542 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:41:25,391 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.744, CH=2696729.0
2025-10-25 01:41:25,391 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:41:27,275 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.824, CH=3297797.8
2025-10-25 01:41:27,275 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:41:29,128 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.910, CH=3245267.8
2025-10-25 01:41:29,129 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.832)
2025-10-25 01:41:29,191 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.49s with 8 clusters.
2025-10-25 01:41:29,192 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:41:29,192 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:41:29,192 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:41:29,345 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:41:29,346 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:41:29,348 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:41:31,289 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.977, CH=2421986.8
2025-10-25 01:41:31,290 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:41:33,184 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.960, CH=2442854.5
2025-10-25 01:41:33,185 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:41:35,098 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.940, CH=2154942.5
2025-10-25 01:41:35,098 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:41:37,043 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.895, CH=2237759.5
2025-10-25 01:41:37,043 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:41:38,897 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.773, CH=2923104.8
2025-10-25 01:41:38,897 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:41:40,715 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.855, CH=3053498.0
2025-10-25 01:41:40,715 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:41:42,525 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.908, CH=4076317.8
2025-10-25 01:41:42,525 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.831)
2025-10-25 01:41:42,526 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:41:42,967 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.78s with 8 clusters.
2025-10-25 01:41:42,969 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:41:42,969 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:41:42,969 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:41:43,100 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:41:44,880 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 7 clusters.
2025-10-25 01:41:50,590 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=7, silhouette: 0.919
2025-10-25 01:41:52,253 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 6 clusters.
2025-10-25 01:41:57,745 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=6, silhouette: 0.919
2025-10-25 01:41:59,371 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 3 clusters.
2025-10-25 01:42:04,853 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=3, silhouette: 0.953
2025-10-25 01:42:06,735 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 2 clusters.
2025-10-25 01:42:12,203 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=5) -> clusters=2, silhouette: 0.976
2025-10-25 01:42:14,091 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 2 clusters.
2025-10-25 01:42:19,623 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=10) -> clusters=2, silhouette: 0.976
2025-10-25 01:42:21,426 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 4 clusters.
2025-10-25 01:42:26,830 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=4, silhouette: 0.948
2025-10-25 01:42:28,696 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:42:28,696 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:42:30,550 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:42:30,550 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:42:32,403 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:42:37,815 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.950
2025-10-25 01:42:37,815 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=15, min_samples=5
2025-10-25 01:42:39,606 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 2 clusters.
2025-10-25 01:42:39,624 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 56.65s with 2 clusters.
2025-10-25 01:42:39,626 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:42:39,626 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:42:39,628 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 83.94 seconds
2025-10-25 01:42:39,628 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 01:42:39,632 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:42:39,636 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:42:39,640 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:42:39,640 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:42:39,641 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:42:39,641 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:42:39,641 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:42:39,784 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.14s with 2 clusters.
2025-10-25 01:42:39,785 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:42:39,786 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:42:39,786 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:42:39,948 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:42:40,427 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.64s with 2 clusters.
2025-10-25 01:42:40,428 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:42:40,428 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:42:40,428 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:42:40,542 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:42:42,248 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 7 clusters.
2025-10-25 01:42:42,266 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.84s with 7 clusters.
2025-10-25 01:42:42,267 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:42:42,268 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:42:42,270 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 2.64 seconds
2025-10-25 01:42:42,270 - root - INFO - timer:154 - Completed: Processing test image block5 in 88.77 seconds
2025-10-25 01:42:42,271 - root - INFO - main:691 - ================================================================================
PROCESSING COMPLETED IN 593.85 SECONDS
================================================================================
2025-10-25 01:42:42,319 - root - INFO - main:699 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 01:46:57,571 - root - INFO - setup_logging:135 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 01:46:57,572 - root - INFO - timer:148 - Starting: Configuration loading and validation
2025-10-25 01:46:57,584 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 01:46:57,587 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 01:46:57,587 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 01:46:57,588 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 01:46:57,591 - root - INFO - validate_processing_config:232 - Processing configuration validation passed
2025-10-25 01:46:57,592 - root - INFO - timer:154 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 01:46:57,595 - src.utils.output_manager - INFO - __init__:28 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 01:46:57,595 - root - INFO - main:648 - Processing dataset: block
2025-10-25 01:46:57,596 - root - INFO - timer:148 - Starting: Loading all test images
2025-10-25 01:46:58,259 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 01:46:59,094 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 01:46:59,554 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 01:47:00,080 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 01:47:00,606 - src.utils.output_manager - INFO - save_test_image:77 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 01:47:00,606 - root - INFO - timer:154 - Completed: Loading all test images in 3.01 seconds
2025-10-25 01:47:00,606 - root - INFO - timer:148 - Starting: Loading training data
2025-10-25 01:47:00,607 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 01:47:02,635 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 01:47:02,635 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 01:47:02,639 - root - INFO - validate_loaded_data:267 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 01:47:02,639 - root - INFO - timer:154 - Completed: Loading training data in 2.03 seconds
2025-10-25 01:47:02,640 - root - INFO - timer:148 - Starting: DBN initialization and training
2025-10-25 01:47:02,640 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 01:47:02,640 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 01:47:02,640 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 01:47:02,643 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 01:47:02,644 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [32.00, 214.00]
2025-10-25 01:47:02,644 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.31], a[-2.00, 3.00], b[-1.00, 8.00]
2025-10-25 01:47:02,646 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 01:47:02,647 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 01:47:02,651 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 01:47:02,651 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 01:47:02,652 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 01:47:02,652 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 01:47:02,959 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 01:47:03,017 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 01:47:03,018 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.238]
2025-10-25 01:47:03,018 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 01:47:03,018 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 01:47:03,018 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 01:47:03,018 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 01:47:03,018 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.283]
2025-10-25 01:47:03,019 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.462, 0.454]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 01:47:03,020 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 01:47:03,020 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 01:49:43,489 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 160.46s - Final fitness: 0.050187
2025-10-25 01:49:43,490 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 01:49:43,499 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 01:49:43,499 - root - INFO - timer:154 - Completed: DBN initialization and training in 160.86 seconds
2025-10-25 01:49:43,500 - root - INFO - timer:148 - Starting: Reference image loading and processing
2025-10-25 01:49:43,500 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 01:49:43,890 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 01:49:43,890 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:49:43,923 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:49:45,195 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:49:45,513 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:49:46,235 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:49:46,237 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:49:46,237 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:49:46,237 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 01:49:46,237 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 01:49:46,248 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 105. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:49:46,248 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:49:48,137 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.969, CH=1910956.0
2025-10-25 01:49:48,137 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:49:50,050 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.908, CH=1151577.5
2025-10-25 01:49:50,050 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:49:51,966 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.915, CH=1295546.6
2025-10-25 01:49:51,966 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:49:53,775 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.769, CH=2148690.8
2025-10-25 01:49:53,775 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:49:55,615 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.740, CH=2009514.5
2025-10-25 01:49:55,615 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:49:57,378 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.896, CH=2195705.2
2025-10-25 01:49:57,378 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:49:59,167 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.906, CH=4006997.8
2025-10-25 01:49:59,168 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.861)
2025-10-25 01:49:59,168 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 01:49:59,168 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 01:49:59,178 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 105. Using dynamic_max_k: 10
2025-10-25 01:49:59,180 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 110.399
2025-10-25 01:49:59,182 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=372.392, std=1926.063, threshold=2298.456
2025-10-25 01:49:59,182 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 01:49:59,182 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 01:49:59,184 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:49:59,185 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:49:59,376 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:49:59,377 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:49:59,514 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:50:00,001 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:50:00,002 - root - INFO - process_reference_image:346 - Reference image processing finished in 16.50 seconds.
2025-10-25 01:50:00,278 - root - INFO - run_reference_processing:382 - Formatted K-Means reference results.
2025-10-25 01:50:00,394 - root - INFO - run_reference_processing:418 - Formatted SOM reference results.
2025-10-25 01:50:01,627 - src.utils.output_manager - INFO - save_reference_summary:136 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 01:50:01,627 - root - INFO - run_reference_processing:438 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 01:50:01,627 - root - INFO - timer:154 - Completed: Reference image loading and processing in 18.13 seconds
2025-10-25 01:50:01,635 - root - INFO - timer:148 - Starting: Processing test image block1
2025-10-25 01:50:01,635 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 01:50:01,661 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 01:50:03,006 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:50:03,381 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:50:03,804 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:50:03,805 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:50:03,805 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:50:03,806 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 01:50:03,824 - root - INFO - process_single_test_image:479 - Preprocessing completed for block1 - unique colors: 145
2025-10-25 01:50:03,824 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 01:50:03,828 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:50:03,832 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:50:03,835 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:50:03,836 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:50:03,836 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:50:03,837 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:50:03,838 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:50:04,023 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 49. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:50:04,024 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:50:04,025 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:50:05,908 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.985, CH=2975847.8
2025-10-25 01:50:05,908 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:50:07,762 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.976, CH=3738018.0
2025-10-25 01:50:07,762 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:50:09,674 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.965, CH=4099452.8
2025-10-25 01:50:09,674 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:50:11,515 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.862, CH=3830808.8
2025-10-25 01:50:11,515 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:50:13,383 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.862, CH=4407350.5
2025-10-25 01:50:13,383 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:50:15,224 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.937, CH=5320823.5
2025-10-25 01:50:15,224 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:50:17,065 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.879, CH=5986026.0
2025-10-25 01:50:17,065 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 7 (based on score: 0.695)
2025-10-25 01:50:17,117 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.28s with 7 clusters.
2025-10-25 01:50:17,118 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:50:17,118 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:50:17,118 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:50:17,264 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 49. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:50:17,264 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:50:17,266 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:50:19,245 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.985, CH=2575482.8
2025-10-25 01:50:19,245 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:50:21,151 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.975, CH=3834045.8
2025-10-25 01:50:21,151 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:50:23,036 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.966, CH=3784921.8
2025-10-25 01:50:23,036 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:50:24,897 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.877, CH=3616866.0
2025-10-25 01:50:24,897 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:50:26,717 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.876, CH=4172031.5
2025-10-25 01:50:26,717 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:50:28,557 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.887, CH=5021079.0
2025-10-25 01:50:28,557 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:50:30,386 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.894, CH=6041660.0
2025-10-25 01:50:30,386 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 3 (based on score: 0.638)
2025-10-25 01:50:30,387 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=3
2025-10-25 01:50:30,826 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.71s with 3 clusters.
2025-10-25 01:50:30,827 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:50:30,827 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:50:30,827 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:50:30,942 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:50:32,782 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 7 clusters.
2025-10-25 01:50:38,373 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=7, silhouette: 0.950
2025-10-25 01:50:40,023 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 7 clusters.
2025-10-25 01:50:45,527 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=7, silhouette: 0.952
2025-10-25 01:50:47,188 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 2 clusters.
2025-10-25 01:50:52,740 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=2, silhouette: 0.975
2025-10-25 01:50:54,474 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:50:54,474 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:50:56,417 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 2 clusters.
2025-10-25 01:51:02,255 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=10) -> clusters=2, silhouette: 0.984
2025-10-25 01:51:03,979 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 4 clusters.
2025-10-25 01:51:09,527 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=4, silhouette: 0.967
2025-10-25 01:51:11,634 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:51:11,634 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:51:13,745 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:51:13,745 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:51:15,538 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:51:21,019 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.969
2025-10-25 01:51:21,020 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=15, min_samples=10
2025-10-25 01:51:22,714 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 2 clusters.
2025-10-25 01:51:22,730 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 51.90s with 2 clusters.
2025-10-25 01:51:22,731 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:51:22,731 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:51:22,855 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_opt on block1: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:51:22,974 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_opt on block1: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:51:23,095 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block1: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:51:23,096 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: determined in 79.27 seconds
2025-10-25 01:51:23,096 - root - INFO - timer:148 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 01:51:23,100 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:51:23,103 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:51:23,106 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:51:23,107 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:51:23,107 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:51:23,107 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:51:23,108 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:51:23,239 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.13s with 2 clusters.
2025-10-25 01:51:23,240 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:51:23,241 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:51:23,241 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:51:23,397 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:51:23,874 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.63s with 2 clusters.
2025-10-25 01:51:23,875 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:51:23,876 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:51:23,876 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:51:23,997 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:51:25,762 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 7 clusters.
2025-10-25 01:51:25,784 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.91s with 7 clusters.
2025-10-25 01:51:25,785 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:51:25,785 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:51:25,908 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_predef on block1: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:51:26,050 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_predef on block1: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:51:26,182 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block1: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:51:26,183 - root - INFO - timer:154 - Completed: Segmentation (block1) with k_type: predefined in 3.09 seconds
2025-10-25 01:51:26,184 - root - INFO - timer:154 - Completed: Processing test image block1 in 84.55 seconds
2025-10-25 01:51:26,184 - root - INFO - timer:148 - Starting: Processing test image block2
2025-10-25 01:51:26,184 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 01:51:26,220 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 01:51:27,559 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:51:27,890 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:51:28,330 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:51:28,331 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:51:28,331 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:51:28,333 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 01:51:28,348 - root - INFO - process_single_test_image:479 - Preprocessing completed for block2 - unique colors: 117
2025-10-25 01:51:28,349 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 01:51:28,353 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:51:28,356 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:51:28,360 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:51:28,360 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:51:28,361 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:51:28,361 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:51:28,362 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:51:28,503 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 49. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:51:28,504 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:51:28,506 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:51:30,403 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.980, CH=2787217.8
2025-10-25 01:51:30,403 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:51:32,372 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.965, CH=2842453.0
2025-10-25 01:51:32,373 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:51:34,218 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.827, CH=2256263.2
2025-10-25 01:51:34,218 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:51:36,052 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.842, CH=2469155.5
2025-10-25 01:51:36,053 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:51:37,879 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.751, CH=2818019.2
2025-10-25 01:51:37,879 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:51:39,667 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.825, CH=2852949.2
2025-10-25 01:51:39,667 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:51:41,477 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.854, CH=4413489.5
2025-10-25 01:51:41,478 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.725)
2025-10-25 01:51:41,534 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.17s with 8 clusters.
2025-10-25 01:51:41,535 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:51:41,536 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:51:41,536 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:51:41,691 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 49. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:51:41,692 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:51:41,694 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:51:43,612 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.980, CH=2653870.8
2025-10-25 01:51:43,613 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:51:45,520 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.964, CH=2584989.2
2025-10-25 01:51:45,521 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:51:47,402 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.883, CH=2171635.5
2025-10-25 01:51:47,402 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:51:49,362 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.879, CH=2724309.5
2025-10-25 01:51:49,363 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:51:51,329 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.871, CH=2685012.0
2025-10-25 01:51:51,329 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:51:53,139 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.779, CH=3453514.0
2025-10-25 01:51:53,140 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:51:54,973 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.845, CH=4594942.0
2025-10-25 01:51:54,973 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.664)
2025-10-25 01:51:54,973 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:51:55,412 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 2 (k=8). Skipping avg color.
2025-10-25 01:51:55,412 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:51:55,413 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.88s with 8 clusters.
2025-10-25 01:51:55,414 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:51:55,414 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:51:55,414 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:51:55,533 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:51:57,509 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 8 clusters.
2025-10-25 01:52:03,287 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=8, silhouette: 0.922
2025-10-25 01:52:05,050 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 8 clusters.
2025-10-25 01:52:10,591 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=8, silhouette: 0.919
2025-10-25 01:52:12,335 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 3 clusters.
2025-10-25 01:52:17,848 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=3, silhouette: 0.938
2025-10-25 01:52:19,699 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 3 clusters.
2025-10-25 01:52:25,233 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=5) -> clusters=3, silhouette: 0.955
2025-10-25 01:52:27,071 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 4 clusters.
2025-10-25 01:52:32,620 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=10) -> clusters=4, silhouette: 0.950
2025-10-25 01:52:34,506 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 4 clusters.
2025-10-25 01:52:39,961 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=4, silhouette: 0.944
2025-10-25 01:52:42,026 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:52:42,026 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:52:44,094 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:52:44,094 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:52:45,979 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:52:51,521 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.961
2025-10-25 01:52:51,521 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=20, min_samples=20
2025-10-25 01:52:53,410 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:52:53,427 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 58.01s with 3 clusters.
2025-10-25 01:52:53,428 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:52:53,428 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:52:53,565 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_opt on block2: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:52:53,693 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_opt on block2: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:52:53,813 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block2: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:52:53,813 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: determined in 85.46 seconds
2025-10-25 01:52:53,814 - root - INFO - timer:148 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 01:52:53,817 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:52:53,819 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:52:53,823 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:52:53,823 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:52:53,824 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:52:53,824 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:52:53,825 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:52:53,959 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.13s with 2 clusters.
2025-10-25 01:52:53,960 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:52:53,961 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:52:53,961 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:52:54,117 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:52:54,585 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.62s with 2 clusters.
2025-10-25 01:52:54,586 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:52:54,586 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:52:54,587 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:52:54,725 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:52:56,572 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 8 clusters.
2025-10-25 01:52:56,594 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 2.01s with 8 clusters.
2025-10-25 01:52:56,595 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:52:56,595 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:52:56,733 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_predef on block2: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:52:56,862 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_predef on block2: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:52:56,998 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block2: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:52:56,999 - root - INFO - timer:154 - Completed: Segmentation (block2) with k_type: predefined in 3.19 seconds
2025-10-25 01:52:57,000 - root - INFO - timer:154 - Completed: Processing test image block2 in 90.82 seconds
2025-10-25 01:52:57,000 - root - INFO - timer:148 - Starting: Processing test image block3
2025-10-25 01:52:57,000 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 01:52:57,024 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 01:52:58,305 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:52:58,681 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:52:59,108 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:52:59,110 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:52:59,110 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:52:59,112 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 01:52:59,127 - root - INFO - process_single_test_image:479 - Preprocessing completed for block3 - unique colors: 176
2025-10-25 01:52:59,127 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 01:52:59,131 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:52:59,134 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:52:59,139 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:52:59,139 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:52:59,140 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:52:59,140 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:52:59,141 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:52:59,284 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:52:59,284 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:52:59,286 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:53:01,146 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.966, CH=1812764.6
2025-10-25 01:53:01,147 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:53:03,089 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.937, CH=1279425.6
2025-10-25 01:53:03,089 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:53:04,951 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.855, CH=1627324.9
2025-10-25 01:53:04,952 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:53:06,764 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.775, CH=1801422.6
2025-10-25 01:53:06,764 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:53:08,576 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.859, CH=2378266.8
2025-10-25 01:53:08,576 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:53:10,360 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.947, CH=2636276.5
2025-10-25 01:53:10,360 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:53:12,140 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.947, CH=3562398.2
2025-10-25 01:53:12,141 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.949)
2025-10-25 01:53:12,200 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.06s with 8 clusters.
2025-10-25 01:53:12,201 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:53:12,202 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:53:12,202 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:53:12,352 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:53:12,352 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:53:12,354 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:53:14,285 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.966, CH=1784440.1
2025-10-25 01:53:14,286 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:53:16,193 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.936, CH=1286109.5
2025-10-25 01:53:16,193 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:53:18,074 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.867, CH=1611139.9
2025-10-25 01:53:18,074 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:53:19,903 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.769, CH=1807488.4
2025-10-25 01:53:19,903 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:53:21,712 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.856, CH=2414599.2
2025-10-25 01:53:21,713 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:53:23,526 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.868, CH=3292204.5
2025-10-25 01:53:23,526 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:53:25,310 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.955, CH=4364177.5
2025-10-25 01:53:25,311 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.971)
2025-10-25 01:53:25,311 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:53:25,768 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.57s with 8 clusters.
2025-10-25 01:53:25,769 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:53:25,770 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:53:25,770 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:53:25,896 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:53:27,191 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 9 clusters.
2025-10-25 01:53:32,660 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=9, silhouette: 0.849
2025-10-25 01:53:33,916 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 6 clusters.
2025-10-25 01:53:39,330 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=6, silhouette: 0.849
2025-10-25 01:53:40,559 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 2 clusters.
2025-10-25 01:53:45,889 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=2, silhouette: 0.935
2025-10-25 01:53:47,500 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 2 clusters.
2025-10-25 01:53:52,807 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=5) -> clusters=2, silhouette: 0.966
2025-10-25 01:53:54,401 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 3 clusters.
2025-10-25 01:54:00,017 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=10) -> clusters=3, silhouette: 0.933
2025-10-25 01:54:01,793 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 3 clusters.
2025-10-25 01:54:07,209 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=3, silhouette: 0.901
2025-10-25 01:54:09,140 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:54:09,141 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:54:11,104 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:54:11,104 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:54:12,756 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:54:18,206 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.917
2025-10-25 01:54:18,206 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=15, min_samples=5
2025-10-25 01:54:19,824 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 2 clusters.
2025-10-25 01:54:19,845 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 54.08s with 2 clusters.
2025-10-25 01:54:19,846 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:54:19,846 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:54:19,973 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_opt on block3: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:54:20,090 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_opt on block3: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:54:20,209 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block3: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:54:20,210 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: determined in 81.08 seconds
2025-10-25 01:54:20,210 - root - INFO - timer:148 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 01:54:20,214 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:54:20,219 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:54:20,223 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:54:20,224 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:54:20,224 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:54:20,224 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:54:20,224 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:54:20,363 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.14s with 2 clusters.
2025-10-25 01:54:20,365 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:54:20,366 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:54:20,367 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:54:20,523 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:54:21,002 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.63s with 2 clusters.
2025-10-25 01:54:21,003 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:54:21,004 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:54:21,004 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:54:21,129 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:54:22,437 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 9 clusters.
2025-10-25 01:54:22,465 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.46s with 9 clusters.
2025-10-25 01:54:22,466 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:54:22,467 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:54:22,600 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_predef on block3: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:54:22,722 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_predef on block3: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:54:22,850 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block3: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:54:22,851 - root - INFO - timer:154 - Completed: Segmentation (block3) with k_type: predefined in 2.64 seconds
2025-10-25 01:54:22,851 - root - INFO - timer:154 - Completed: Processing test image block3 in 85.85 seconds
2025-10-25 01:54:22,852 - root - INFO - timer:148 - Starting: Processing test image block4
2025-10-25 01:54:22,852 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 01:54:22,877 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 01:54:24,209 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:54:24,540 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:54:24,949 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:54:24,950 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:54:24,950 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:54:24,951 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 01:54:24,968 - root - INFO - process_single_test_image:479 - Preprocessing completed for block4 - unique colors: 127
2025-10-25 01:54:24,968 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 01:54:24,972 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:54:24,975 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:54:24,978 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:54:24,979 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:54:24,979 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:54:24,979 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:54:24,980 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:54:25,137 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 49. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:54:25,138 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:54:25,140 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:54:27,015 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.980, CH=2609842.5
2025-10-25 01:54:27,015 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:54:28,941 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.964, CH=2776688.2
2025-10-25 01:54:28,942 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:54:30,829 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.880, CH=2796789.5
2025-10-25 01:54:30,829 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:54:32,715 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.875, CH=3681434.5
2025-10-25 01:54:32,715 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:54:34,544 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.822, CH=4036019.2
2025-10-25 01:54:34,544 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:54:36,353 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.890, CH=4552280.0
2025-10-25 01:54:36,353 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:54:38,171 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.897, CH=6348755.5
2025-10-25 01:54:38,171 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.738)
2025-10-25 01:54:38,228 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.25s with 8 clusters.
2025-10-25 01:54:38,230 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:54:38,230 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:54:38,231 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:54:38,375 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:54:38,375 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:54:38,376 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:54:40,275 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.980, CH=2670407.5
2025-10-25 01:54:40,275 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:54:42,169 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.965, CH=3033574.8
2025-10-25 01:54:42,169 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:54:44,064 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.888, CH=3177146.2
2025-10-25 01:54:44,064 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:54:45,939 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.880, CH=4018561.2
2025-10-25 01:54:45,939 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:54:47,763 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.829, CH=4554299.5
2025-10-25 01:54:47,763 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:54:49,596 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.834, CH=5042254.5
2025-10-25 01:54:49,596 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:54:51,415 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.898, CH=6617922.5
2025-10-25 01:54:51,416 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.729)
2025-10-25 01:54:51,416 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:54:51,854 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 5 (k=8). Skipping avg color.
2025-10-25 01:54:51,854 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.62s with 8 clusters.
2025-10-25 01:54:51,855 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:54:51,856 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:54:51,856 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:54:51,970 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:54:53,646 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 5 clusters.
2025-10-25 01:54:59,295 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=5, silhouette: 0.931
2025-10-25 01:55:00,873 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 5 clusters.
2025-10-25 01:55:06,445 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=5, silhouette: 0.934
2025-10-25 01:55:08,009 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 3 clusters.
2025-10-25 01:55:13,604 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=3, silhouette: 0.951
2025-10-25 01:55:15,644 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:55:15,644 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:55:17,696 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 1 clusters.
2025-10-25 01:55:17,697 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:55:19,388 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 5 clusters.
2025-10-25 01:55:24,954 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=5, silhouette: 0.946
2025-10-25 01:55:26,990 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:55:26,990 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:55:29,054 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:55:29,055 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:55:31,134 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 1 clusters.
2025-10-25 01:55:31,135 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=20) -> found <= 1 cluster. Skipping score.
2025-10-25 01:55:31,135 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=10, min_samples=20
2025-10-25 01:55:32,766 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 3 clusters.
2025-10-25 01:55:32,781 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 40.92s with 3 clusters.
2025-10-25 01:55:32,783 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:55:32,783 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:55:32,904 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_opt on block4: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:55:33,070 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_opt on block4: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:55:33,187 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block4: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:55:33,188 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: determined in 68.22 seconds
2025-10-25 01:55:33,188 - root - INFO - timer:148 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 01:55:33,192 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:55:33,196 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:55:33,200 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:55:33,201 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:55:33,201 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:55:33,202 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:55:33,202 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:55:33,341 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.14s with 2 clusters.
2025-10-25 01:55:33,343 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:55:33,343 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:55:33,343 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:55:33,497 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:55:33,972 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.63s with 2 clusters.
2025-10-25 01:55:33,973 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:55:33,973 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:55:33,973 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:55:34,089 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:55:35,803 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 5 clusters.
2025-10-25 01:55:35,822 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 1.85s with 5 clusters.
2025-10-25 01:55:35,823 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:55:35,824 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:55:35,948 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_predef on block4: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:55:36,075 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_predef on block4: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:55:36,211 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block4: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:55:36,212 - root - INFO - timer:154 - Completed: Segmentation (block4) with k_type: predefined in 3.02 seconds
2025-10-25 01:55:36,212 - root - INFO - timer:154 - Completed: Processing test image block4 in 73.36 seconds
2025-10-25 01:55:36,213 - root - INFO - timer:148 - Starting: Processing test image block5
2025-10-25 01:55:36,213 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 01:55:36,238 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 01:55:37,665 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 01:55:38,004 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 01:55:38,436 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 01:55:38,437 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 01:55:38,437 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 01:55:38,439 - src.utils.output_manager - INFO - save_preprocessed_image:87 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 01:55:38,454 - root - INFO - process_single_test_image:479 - Preprocessing completed for block5 - unique colors: 121
2025-10-25 01:55:38,455 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 01:55:38,458 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: determined
2025-10-25 01:55:38,462 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: determined
2025-10-25 01:55:38,466 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 01:55:38,467 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 01:55:38,467 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:55:38,468 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_opt
2025-10-25 01:55:38,468 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:55:38,637 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:55:38,637 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:55:38,638 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:55:40,533 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.979, CH=2263113.5
2025-10-25 01:55:40,534 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:55:42,501 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.963, CH=2536870.2
2025-10-25 01:55:42,501 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:55:44,380 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.844, CH=2246585.8
2025-10-25 01:55:44,381 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:55:46,283 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.822, CH=2193589.2
2025-10-25 01:55:46,283 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:55:48,341 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.831, CH=2542501.0
2025-10-25 01:55:48,341 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:55:50,358 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.848, CH=3396310.0
2025-10-25 01:55:50,358 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:55:52,242 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.887, CH=3783161.0
2025-10-25 01:55:52,242 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.707)
2025-10-25 01:55:52,304 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_opt completed in 13.84s with 8 clusters.
2025-10-25 01:55:52,305 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_opt_determined_segmented.png
2025-10-25 01:55:52,305 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_opt
2025-10-25 01:55:52,305 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:55:52,459 - src.models.segmentation.segmentation - INFO - determine_k:108 - Unique colors: 50. Adjusted k-range for metric search: [2, 8]
2025-10-25 01:55:52,459 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 01:55:52,461 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=2
2025-10-25 01:55:54,346 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=2: Silhouette=0.979, CH=2316801.5
2025-10-25 01:55:54,346 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=3
2025-10-25 01:55:56,306 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=3: Silhouette=0.963, CH=2339518.8
2025-10-25 01:55:56,306 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=4
2025-10-25 01:55:58,189 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=4: Silhouette=0.881, CH=2275228.8
2025-10-25 01:55:58,189 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=5
2025-10-25 01:56:00,049 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=5: Silhouette=0.851, CH=2243578.2
2025-10-25 01:56:00,049 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=6
2025-10-25 01:56:01,896 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=6: Silhouette=0.855, CH=2877987.5
2025-10-25 01:56:01,896 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=7
2025-10-25 01:56:03,733 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=7: Silhouette=0.892, CH=3682219.8
2025-10-25 01:56:03,733 - src.models.segmentation.segmentation - INFO - determine_k:132 - Testing k=8
2025-10-25 01:56:05,548 - src.models.segmentation.segmentation - INFO - determine_k:146 - Metrics for k=8: Silhouette=0.902, CH=5990951.5
2025-10-25 01:56:05,548 - src.models.segmentation.segmentation - INFO - determine_k:162 - Optimal k determined: 8 (based on score: 0.699)
2025-10-25 01:56:05,548 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=8
2025-10-25 01:56:05,994 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 3 (k=8). Skipping avg color.
2025-10-25 01:56:05,994 - src.models.segmentation.segmentation - WARNING - segment:582 - SOM generated empty mask for cluster 7 (k=8). Skipping avg color.
2025-10-25 01:56:05,995 - src.models.segmentation.segmentation - INFO - process:693 - Method som_opt completed in 13.69s with 8 clusters.
2025-10-25 01:56:05,996 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_opt_determined_segmented.png
2025-10-25 01:56:05,996 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:56:05,996 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:56:06,112 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:387 - Finding optimal DBSCAN parameters...
2025-10-25 01:56:07,996 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=5) found 4 clusters.
2025-10-25 01:56:13,488 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=5) -> clusters=4, silhouette: 0.945
2025-10-25 01:56:15,249 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=10) found 5 clusters.
2025-10-25 01:56:20,785 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=10) -> clusters=5, silhouette: 0.928
2025-10-25 01:56:22,606 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10, min=20) found 4 clusters.
2025-10-25 01:56:28,122 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=10, min=20) -> clusters=4, silhouette: 0.934
2025-10-25 01:56:30,197 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=5) found 1 clusters.
2025-10-25 01:56:30,197 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=15, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:56:32,089 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=10) found 3 clusters.
2025-10-25 01:56:37,609 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=10) -> clusters=3, silhouette: 0.961
2025-10-25 01:56:39,667 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=15, min=20) found 3 clusters.
2025-10-25 01:56:45,541 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=15, min=20) -> clusters=3, silhouette: 0.955
2025-10-25 01:56:47,639 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=5) found 1 clusters.
2025-10-25 01:56:47,639 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=5) -> found <= 1 cluster. Skipping score.
2025-10-25 01:56:49,744 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=10) found 1 clusters.
2025-10-25 01:56:49,744 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:410 - DBSCAN params (eps=20, min=10) -> found <= 1 cluster. Skipping score.
2025-10-25 01:56:51,678 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:56:57,172 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:403 - DBSCAN params (eps=20, min=20) -> clusters=3, silhouette: 0.961
2025-10-25 01:56:57,172 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:412 - Optimal DBSCAN parameters found: eps=20, min_samples=20
2025-10-25 01:56:58,990 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=20, min=20) found 3 clusters.
2025-10-25 01:56:59,009 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 53.01s with 3 clusters.
2025-10-25 01:56:59,011 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_determined_segmented.png
2025-10-25 01:56:59,011 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='determined'.
2025-10-25 01:56:59,134 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_opt on block5: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:56:59,252 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_opt on block5: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:56:59,372 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block5: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:56:59,373 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: determined in 80.92 seconds
2025-10-25 01:56:59,373 - root - INFO - timer:148 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 01:56:59,379 - src.models.segmentation.segmentation - INFO - __init__:256 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 01:56:59,382 - src.models.segmentation.segmentation - INFO - __init__:516 - SOMSegmenter initialized with k_type: predefined
2025-10-25 01:56:59,385 - src.models.segmentation.segmentation - INFO - __init__:365 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 01:56:59,386 - src.models.segmentation.segmentation - INFO - __init__:623 - Segmenter (Facade) initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 01:56:59,386 - src.models.segmentation.segmentation - WARNING - process:677 - OutputManager does not have expected methods for image name/path. Using placeholder.
2025-10-25 01:56:59,387 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: kmeans_predef
2025-10-25 01:56:59,387 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:56:59,530 - src.models.segmentation.segmentation - INFO - process:693 - Method kmeans_predef completed in 0.14s with 2 clusters.
2025-10-25 01:56:59,532 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\kmeans_predef_predefined_segmented.png
2025-10-25 01:56:59,533 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: som_predef
2025-10-25 01:56:59,533 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:56:59,688 - src.models.segmentation.segmentation - INFO - segment:542 - Running SOM segmentation with k=2
2025-10-25 01:57:00,195 - src.models.segmentation.segmentation - INFO - process:693 - Method som_predef completed in 0.66s with 2 clusters.
2025-10-25 01:57:00,196 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\som_predef_predefined_segmented.png
2025-10-25 01:57:00,196 - src.models.segmentation.segmentation - INFO - process:689 - Running segmentation method: dbscan
2025-10-25 01:57:00,196 - src.models.segmentation.segmentation - INFO - quantize_image:195 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 01:57:00,318 - src.models.segmentation.segmentation - INFO - segment:431 - Using predefined DBSCAN params: eps=10.0, min_samples=5
2025-10-25 01:57:02,448 - src.models.segmentation.segmentation - INFO - _run_dbscan:379 - DBSCAN(eps=10.0, min=5) found 4 clusters.
2025-10-25 01:57:02,478 - src.models.segmentation.segmentation - INFO - process:693 - Method dbscan completed in 2.28s with 4 clusters.
2025-10-25 01:57:02,479 - src.utils.output_manager - INFO - save_segmentation_result:109 - Saved segmented image to datasets\block\processed\segmented\dbscan_predefined_segmented.png
2025-10-25 01:57:02,480 - src.models.segmentation.segmentation - INFO - process:710 - Segmentation processing completed for k_type='predefined'.
2025-10-25 01:57:02,675 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for kmeans_predef on block5: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:57:02,820 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for som_predef on block5: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:57:03,022 - root - ERROR - process_single_test_image:585 - Delta E calculation failed for dbscan on block5: 'list' object has no attribute 'size'
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 557, in process_single_test_image
    if segmented_lab_traditional.size == 0 or segmented_lab_dbn.size == 0:
AttributeError: 'list' object has no attribute 'size'
2025-10-25 01:57:03,022 - root - INFO - timer:154 - Completed: Segmentation (block5) with k_type: predefined in 3.65 seconds
2025-10-25 01:57:03,023 - root - INFO - timer:154 - Completed: Processing test image block5 in 86.81 seconds
2025-10-25 01:57:03,025 - root - INFO - main:731 - ================================================================================
PROCESSING COMPLETED IN 605.46 SECONDS
================================================================================
2025-10-25 01:57:03,117 - root - INFO - main:739 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-25 13:04:03,892 - root - INFO - setup_logging:76 - Logging setup complete. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-25 13:04:03,894 - root - INFO - main:522 - ================================================================================
TEXTILE COLOR ANALYSIS SYSTEM - PROCESSING START
================================================================================
2025-10-25 13:04:03,894 - root - INFO - main:523 - Project Root: c:\Users\LENOVO\Desktop\prints
2025-10-25 13:04:03,894 - root - INFO - main:524 - Output directory: C:\Users\LENOVO\Desktop\prints\output
2025-10-25 13:04:03,894 - root - INFO - main:525 - Using configuration file: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-25 13:04:03,894 - root - INFO - timer:84 - Starting: Configuration loading and validation
2025-10-25 13:04:03,908 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from c:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-25 13:04:03,912 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-25 13:04:03,912 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-25 13:04:03,912 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-25 13:04:03,913 - root - INFO - validate_processing_config:156 - Processing configuration validation passed
2025-10-25 13:04:03,913 - root - INFO - timer:89 - Completed: Configuration loading and validation in 0.02 seconds
2025-10-25 13:04:03,915 - src.utils.output_manager - INFO - __init__:19 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-25 13:04:03,915 - root - INFO - main:535 - Processing dataset: block
2025-10-25 13:04:03,915 - root - INFO - timer:84 - Starting: Loading all test images
2025-10-25 13:04:04,621 - src.utils.output_manager - INFO - save_test_image:66 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-25 13:04:05,558 - src.utils.output_manager - INFO - save_test_image:66 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-25 13:04:06,012 - src.utils.output_manager - INFO - save_test_image:66 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-25 13:04:06,576 - src.utils.output_manager - INFO - save_test_image:66 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-25 13:04:07,120 - src.utils.output_manager - INFO - save_test_image:66 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-25 13:04:07,120 - root - INFO - timer:89 - Completed: Loading all test images in 3.21 seconds
2025-10-25 13:04:07,120 - root - INFO - main:550 - Successfully loaded 5 test images.
2025-10-25 13:04:07,120 - root - INFO - timer:84 - Starting: Loading training data
2025-10-25 13:04:07,120 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-25 13:04:09,038 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-25 13:04:09,038 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-25 13:04:09,038 - root - INFO - validate_loaded_data:180 - Data validation passed: 50000 total pixels available from 5 images.
2025-10-25 13:04:09,038 - root - INFO - timer:89 - Completed: Loading training data in 1.92 seconds
2025-10-25 13:04:09,038 - root - INFO - timer:84 - Starting: DBN initialization and training
2025-10-25 13:04:09,038 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-25 13:04:09,038 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-25 13:04:09,038 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-25 13:04:09,038 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-25 13:04:09,038 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 214.00]
2025-10-25 13:04:09,038 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[11.76, 84.31], a[-2.00, 2.00], b[-1.00, 8.00]
2025-10-25 13:04:09,054 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-25 13:04:09,054 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-25 13:04:09,054 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-25 13:04:09,054 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-25 13:04:09,054 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-25 13:04:09,054 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-25 13:04:09,392 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-25 13:04:09,455 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-25 13:04:09,455 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.237]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.283]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.462, 0.463]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-25 13:04:09,470 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-25 13:04:09,470 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-25 13:07:03,822 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 174.35s - Final fitness: 0.059685
2025-10-25 13:07:03,822 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-25 13:07:03,837 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-25 13:07:03,837 - root - INFO - timer:89 - Completed: DBN initialization and training in 174.80 seconds
2025-10-25 13:07:03,837 - root - INFO - timer:84 - Starting: Reference image loading and processing
2025-10-25 13:07:03,837 - root - INFO - process_reference_image:259 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-25 13:07:04,285 - root - INFO - process_reference_image:274 - Starting preprocessing for reference image
2025-10-25 13:07:04,285 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 13:07:04,322 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 13:07:05,842 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 13:07:06,215 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 13:07:07,201 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 13:07:07,201 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 13:07:07,201 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 13:07:07,201 - root - INFO - process_reference_image:278 - Preprocessing completed, shape: (128, 128, 3)
2025-10-25 13:07:07,201 - root - INFO - process_reference_image:286 - Determining optimal number of clusters for reference
2025-10-25 13:07:07,213 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 118. Adjusted k-range: [2, 8]
2025-10-25 13:07:07,213 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:07:09,434 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.972, CH=1905594.6
2025-10-25 13:07:09,434 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:07:11,572 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.951, CH=1706930.4
2025-10-25 13:07:11,572 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:07:13,628 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.946, CH=1403150.8
2025-10-25 13:07:13,628 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:07:15,649 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.808, CH=2076144.5
2025-10-25 13:07:15,649 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:07:17,669 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.941, CH=2527950.5
2025-10-25 13:07:17,669 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=7
2025-10-25 13:07:19,632 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=7: Sil=0.951, CH=4450625.5
2025-10-25 13:07:19,632 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=8
2025-10-25 13:07:21,624 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=8: Sil=0.957, CH=6006635.0
2025-10-25 13:07:21,624 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 8 (score: 0.955)
2025-10-25 13:07:21,624 - root - INFO - process_reference_image:299 - Optimal clusters determined: 8
2025-10-25 13:07:21,624 - root - INFO - process_reference_image:305 - Determining DPC clusters
2025-10-25 13:07:21,639 - root - INFO - optimal_clusters_dpc:157 - Number of unique colors: 118. Using dynamic_max_k: 10
2025-10-25 13:07:21,655 - root - INFO - optimal_clusters_dpc:185 - Calculated DPC bandwidth: 99.985
2025-10-25 13:07:21,655 - root - INFO - optimal_clusters_dpc:218 - DPC gamma analysis: mean=365.802, std=2013.502, threshold=2379.305
2025-10-25 13:07:21,655 - root - INFO - optimal_clusters_dpc:229 - Optimal number of clusters estimated by DPC gamma heuristic: 2
2025-10-25 13:07:21,655 - root - INFO - process_reference_image:313 - Performing reference segmentation with k=8
2025-10-25 13:07:21,655 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 13:07:21,655 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:07:21,777 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 8
2025-10-25 13:07:21,840 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: predefined
2025-10-25 13:07:21,840 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:07:21,995 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=8
2025-10-25 13:07:22,524 - src.models.segmentation.segmentation - WARNING - segment:395 - SOM empty mask cluster 2 (k=8).
2025-10-25 13:07:22,524 - src.models.segmentation.segmentation - WARNING - segment:395 - SOM empty mask cluster 3 (k=8).
2025-10-25 13:07:22,524 - src.models.segmentation.segmentation - WARNING - segment:395 - SOM empty mask cluster 4 (k=8).
2025-10-25 13:07:22,524 - root - INFO - process_reference_image:346 - Reference image processing finished in 18.69 seconds.
2025-10-25 13:07:22,826 - root - INFO - run_reference_processing:282 - Formatted K-Means reference results.
2025-10-25 13:07:22,958 - root - INFO - run_reference_processing:309 - Formatted SOM reference results.
2025-10-25 13:07:24,301 - src.utils.output_manager - INFO - save_reference_summary:108 - Saved reference summary image to datasets\block\summaries\reference_summary.png
2025-10-25 13:07:24,301 - root - INFO - run_reference_processing:322 - Reference processed - Target LAB colors shape: (8, 3), DPC k: 2
2025-10-25 13:07:24,301 - root - INFO - timer:89 - Completed: Reference image loading and processing in 20.46 seconds
2025-10-25 13:07:24,313 - root - INFO - timer:84 - Starting: Processing test image block1
2025-10-25 13:07:24,313 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-25 13:07:24,343 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-25 13:07:25,803 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 13:07:26,153 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 13:07:26,608 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 13:07:26,608 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 13:07:26,608 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 13:07:26,608 - src.utils.output_manager - INFO - save_preprocessed_image:75 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-25 13:07:26,623 - root - INFO - process_single_test_image:359 - Preprocessing completed for block1 - unique colors: 134
2025-10-25 13:07:26,623 - root - INFO - timer:84 - Starting: Segmentation (block1) with k_type: determined
2025-10-25 13:07:26,623 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: determined
2025-10-25 13:07:26,623 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: determined
2025-10-25 13:07:26,623 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 13:07:26,623 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 13:07:26,623 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_opt
2025-10-25 13:07:26,623 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:07:26,777 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:07:26,777 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:07:26,777 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:07:28,933 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.987, CH=3002191.2
2025-10-25 13:07:28,933 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:07:31,120 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.979, CH=4370115.5
2025-10-25 13:07:31,120 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:07:33,161 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.967, CH=3799184.0
2025-10-25 13:07:33,161 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:07:35,181 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.950, CH=3871854.2
2025-10-25 13:07:35,181 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:07:37,224 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.883, CH=3913402.2
2025-10-25 13:07:37,224 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 3 (score: 0.964)
2025-10-25 13:07:37,224 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 3
2025-10-25 13:07:37,240 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_opt completed in 10.62s with 3 clusters.
2025-10-25 13:07:37,240 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_opt
2025-10-25 13:07:37,240 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:07:37,425 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:07:37,425 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:07:37,425 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:07:39,421 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.987, CH=3096140.2
2025-10-25 13:07:39,421 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:07:41,373 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.979, CH=4274207.0
2025-10-25 13:07:41,373 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:07:43,322 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.970, CH=3828054.8
2025-10-25 13:07:43,322 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:07:45,315 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.961, CH=4415574.5
2025-10-25 13:07:45,315 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:07:47,341 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.905, CH=5072412.5
2025-10-25 13:07:47,341 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 3 (score: 0.749)
2025-10-25 13:07:47,341 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=3
2025-10-25 13:07:47,776 - src.models.segmentation.segmentation - INFO - process:496 - Method som_opt completed in 10.53s with 3 clusters.
2025-10-25 13:07:47,776 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:07:47,776 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:07:47,887 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:295 - Finding optimal DBSCAN parameters...
2025-10-25 13:08:29,764 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:309 - Optimal DBSCAN parameters: eps=20, min=20
2025-10-25 13:08:31,557 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 43.78s with 3 clusters.
2025-10-25 13:08:31,557 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='determined'.
2025-10-25 13:08:31,670 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_opt on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:08:31,781 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_opt on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:08:31,881 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:08:31,881 - root - INFO - timer:89 - Completed: Segmentation (block1) with k_type: determined in 65.26 seconds
2025-10-25 13:08:31,881 - root - INFO - timer:84 - Starting: Segmentation (block1) with k_type: predefined
2025-10-25 13:08:31,881 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 13:08:31,881 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: predefined
2025-10-25 13:08:31,881 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 13:08:31,881 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 13:08:31,881 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_predef
2025-10-25 13:08:31,881 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:08:32,012 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:08:32,012 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_predef completed in 0.13s with 2 clusters.
2025-10-25 13:08:32,012 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_predef
2025-10-25 13:08:32,012 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:08:32,182 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:08:32,636 - src.models.segmentation.segmentation - INFO - process:496 - Method som_predef completed in 0.61s with 2 clusters.
2025-10-25 13:08:32,636 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:08:32,636 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:08:32,745 - src.models.segmentation.segmentation - INFO - segment:321 - Using predefined DBSCAN.
2025-10-25 13:08:34,456 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 1.82s with 8 clusters.
2025-10-25 13:08:34,456 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='predefined'.
2025-10-25 13:08:34,567 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_predef on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:08:34,676 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_predef on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:08:34,780 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:08:34,787 - root - INFO - timer:89 - Completed: Segmentation (block1) with k_type: predefined in 2.90 seconds
2025-10-25 13:08:34,787 - root - INFO - timer:89 - Completed: Processing test image block1 in 70.47 seconds
2025-10-25 13:08:34,787 - root - INFO - timer:84 - Starting: Processing test image block2
2025-10-25 13:08:34,787 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-25 13:08:34,802 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-25 13:08:36,048 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 13:08:36,402 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 13:08:36,807 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 13:08:36,815 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 13:08:36,815 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 13:08:36,815 - src.utils.output_manager - INFO - save_preprocessed_image:75 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-25 13:08:36,825 - root - INFO - process_single_test_image:359 - Preprocessing completed for block2 - unique colors: 123
2025-10-25 13:08:36,825 - root - INFO - timer:84 - Starting: Segmentation (block2) with k_type: determined
2025-10-25 13:08:36,825 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: determined
2025-10-25 13:08:36,825 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: determined
2025-10-25 13:08:36,825 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 13:08:36,825 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 13:08:36,825 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_opt
2025-10-25 13:08:36,825 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:08:36,966 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:08:36,966 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:08:36,966 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:08:38,784 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.981, CH=2685975.0
2025-10-25 13:08:38,784 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:08:40,589 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.967, CH=3060050.5
2025-10-25 13:08:40,589 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:08:42,405 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.952, CH=2790079.5
2025-10-25 13:08:42,405 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:08:44,157 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.922, CH=2971583.5
2025-10-25 13:08:44,157 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:08:45,903 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.861, CH=4003891.8
2025-10-25 13:08:45,903 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 3 (score: 0.585)
2025-10-25 13:08:45,903 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 3
2025-10-25 13:08:45,934 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_opt completed in 9.10s with 3 clusters.
2025-10-25 13:08:45,934 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_opt
2025-10-25 13:08:45,934 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:08:46,072 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:08:46,072 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:08:46,072 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:08:47,874 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.981, CH=2912361.0
2025-10-25 13:08:47,874 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:08:49,721 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.967, CH=3001462.8
2025-10-25 13:08:49,721 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:08:51,541 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.952, CH=2739232.5
2025-10-25 13:08:51,541 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:08:53,393 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.892, CH=2799587.8
2025-10-25 13:08:53,393 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:08:55,155 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.857, CH=3811385.0
2025-10-25 13:08:55,155 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 2 (score: 0.581)
2025-10-25 13:08:55,155 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:08:55,540 - src.models.segmentation.segmentation - INFO - process:496 - Method som_opt completed in 9.62s with 2 clusters.
2025-10-25 13:08:55,540 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:08:55,540 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:08:55,656 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:295 - Finding optimal DBSCAN parameters...
2025-10-25 13:09:43,633 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:309 - Optimal DBSCAN parameters: eps=15, min=10
2025-10-25 13:09:45,475 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 49.93s with 3 clusters.
2025-10-25 13:09:45,475 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='determined'.
2025-10-25 13:09:45,587 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_opt on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:09:45,695 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_opt on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:09:45,806 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:09:45,806 - root - INFO - timer:89 - Completed: Segmentation (block2) with k_type: determined in 68.99 seconds
2025-10-25 13:09:45,806 - root - INFO - timer:84 - Starting: Segmentation (block2) with k_type: predefined
2025-10-25 13:09:45,806 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 13:09:45,806 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: predefined
2025-10-25 13:09:45,806 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 13:09:45,806 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 13:09:45,806 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_predef
2025-10-25 13:09:45,806 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:09:45,922 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:09:45,937 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_predef completed in 0.13s with 2 clusters.
2025-10-25 13:09:45,937 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_predef
2025-10-25 13:09:45,937 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:09:46,100 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:09:46,540 - src.models.segmentation.segmentation - INFO - process:496 - Method som_predef completed in 0.60s with 2 clusters.
2025-10-25 13:09:46,540 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:09:46,540 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:09:46,656 - src.models.segmentation.segmentation - INFO - segment:321 - Using predefined DBSCAN.
2025-10-25 13:09:48,517 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 1.97s with 4 clusters.
2025-10-25 13:09:48,517 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='predefined'.
2025-10-25 13:09:48,628 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_predef on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:09:48,738 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_predef on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:09:48,841 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:09:48,841 - root - INFO - timer:89 - Completed: Segmentation (block2) with k_type: predefined in 3.03 seconds
2025-10-25 13:09:48,841 - root - INFO - timer:89 - Completed: Processing test image block2 in 74.06 seconds
2025-10-25 13:09:48,841 - root - INFO - timer:84 - Starting: Processing test image block3
2025-10-25 13:09:48,841 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-25 13:09:48,863 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-25 13:09:50,136 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 13:09:50,441 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 13:09:50,834 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 13:09:50,834 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 13:09:50,834 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 13:09:50,842 - src.utils.output_manager - INFO - save_preprocessed_image:75 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-25 13:09:50,853 - root - INFO - process_single_test_image:359 - Preprocessing completed for block3 - unique colors: 178
2025-10-25 13:09:50,853 - root - INFO - timer:84 - Starting: Segmentation (block3) with k_type: determined
2025-10-25 13:09:50,853 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: determined
2025-10-25 13:09:50,853 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: determined
2025-10-25 13:09:50,853 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 13:09:50,853 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 13:09:50,853 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_opt
2025-10-25 13:09:50,853 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:09:50,996 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:09:50,996 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:09:50,996 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:09:52,779 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.966, CH=1734820.8
2025-10-25 13:09:52,779 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:09:54,627 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.933, CH=1020910.1
2025-10-25 13:09:54,627 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:09:56,435 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.926, CH=1014539.2
2025-10-25 13:09:56,435 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:09:58,226 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.727, CH=1201684.6
2025-10-25 13:09:58,226 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:09:59,970 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.823, CH=2128289.2
2025-10-25 13:09:59,970 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 2 (score: 0.823)
2025-10-25 13:09:59,970 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:09:59,980 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_opt completed in 9.12s with 2 clusters.
2025-10-25 13:09:59,980 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_opt
2025-10-25 13:09:59,980 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:10:00,140 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:10:00,140 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:10:00,140 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:10:01,931 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.967, CH=1921613.9
2025-10-25 13:10:01,931 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:10:03,722 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.939, CH=1251210.0
2025-10-25 13:10:03,722 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:10:05,516 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.788, CH=1514113.0
2025-10-25 13:10:05,516 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:10:07,264 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.795, CH=1671371.6
2025-10-25 13:10:07,264 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:10:09,023 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.795, CH=1849026.0
2025-10-25 13:10:09,023 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 2 (score: 1.000)
2025-10-25 13:10:09,023 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:10:09,467 - src.models.segmentation.segmentation - INFO - process:496 - Method som_opt completed in 9.49s with 2 clusters.
2025-10-25 13:10:09,467 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:10:09,467 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:10:09,574 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:295 - Finding optimal DBSCAN parameters...
2025-10-25 13:10:59,571 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:309 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-25 13:11:01,068 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 51.60s with 3 clusters.
2025-10-25 13:11:01,068 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='determined'.
2025-10-25 13:11:01,184 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_opt on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:11:01,284 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_opt on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:11:01,400 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:11:01,400 - root - INFO - timer:89 - Completed: Segmentation (block3) with k_type: determined in 70.54 seconds
2025-10-25 13:11:01,400 - root - INFO - timer:84 - Starting: Segmentation (block3) with k_type: predefined
2025-10-25 13:11:01,400 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 13:11:01,400 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: predefined
2025-10-25 13:11:01,400 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 13:11:01,400 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 13:11:01,400 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_predef
2025-10-25 13:11:01,400 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:11:01,516 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:11:01,516 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-25 13:11:01,516 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_predef
2025-10-25 13:11:01,516 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:11:01,647 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:11:02,070 - src.models.segmentation.segmentation - INFO - process:496 - Method som_predef completed in 0.55s with 2 clusters.
2025-10-25 13:11:02,070 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:11:02,070 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:11:02,186 - src.models.segmentation.segmentation - INFO - segment:321 - Using predefined DBSCAN.
2025-10-25 13:11:03,684 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 1.61s with 6 clusters.
2025-10-25 13:11:03,684 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='predefined'.
2025-10-25 13:11:03,793 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_predef on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:11:03,904 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_predef on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:11:04,004 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:11:04,004 - root - INFO - timer:89 - Completed: Segmentation (block3) with k_type: predefined in 2.61 seconds
2025-10-25 13:11:04,004 - root - INFO - timer:89 - Completed: Processing test image block3 in 75.16 seconds
2025-10-25 13:11:04,004 - root - INFO - timer:84 - Starting: Processing test image block4
2025-10-25 13:11:04,004 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-25 13:11:04,035 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-25 13:11:05,316 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 13:11:05,664 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 13:11:06,073 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 13:11:06,075 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 13:11:06,075 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 13:11:06,075 - src.utils.output_manager - INFO - save_preprocessed_image:75 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-25 13:11:06,093 - root - INFO - process_single_test_image:359 - Preprocessing completed for block4 - unique colors: 131
2025-10-25 13:11:06,093 - root - INFO - timer:84 - Starting: Segmentation (block4) with k_type: determined
2025-10-25 13:11:06,093 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: determined
2025-10-25 13:11:06,093 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: determined
2025-10-25 13:11:06,093 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 13:11:06,093 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 13:11:06,093 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_opt
2025-10-25 13:11:06,093 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:11:06,235 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:11:06,235 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:11:06,235 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:11:08,025 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.981, CH=2550503.2
2025-10-25 13:11:08,025 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:11:09,799 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.967, CH=2762126.0
2025-10-25 13:11:09,799 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:11:11,620 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.953, CH=2744149.5
2025-10-25 13:11:11,620 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:11:13,444 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.899, CH=3666181.8
2025-10-25 13:11:13,444 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:11:15,264 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.963, CH=3705868.8
2025-10-25 13:11:15,264 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 6 (score: 0.889)
2025-10-25 13:11:15,264 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 6
2025-10-25 13:11:15,327 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_opt completed in 9.23s with 6 clusters.
2025-10-25 13:11:15,327 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_opt
2025-10-25 13:11:15,327 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:11:15,624 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-25 13:11:15,624 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:11:15,627 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:11:17,597 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.981, CH=2721752.8
2025-10-25 13:11:17,597 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:11:19,571 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.967, CH=2829620.8
2025-10-25 13:11:19,571 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:11:21,557 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.898, CH=2742789.2
2025-10-25 13:11:21,557 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:11:23,584 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.898, CH=3708923.5
2025-10-25 13:11:23,584 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:11:25,984 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.963, CH=3774740.5
2025-10-25 13:11:25,984 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 6 (score: 0.889)
2025-10-25 13:11:25,984 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=6
2025-10-25 13:11:26,497 - src.models.segmentation.segmentation - WARNING - segment:395 - SOM empty mask cluster 1 (k=6).
2025-10-25 13:11:26,497 - src.models.segmentation.segmentation - WARNING - segment:395 - SOM empty mask cluster 2 (k=6).
2025-10-25 13:11:26,497 - src.models.segmentation.segmentation - INFO - process:496 - Method som_opt completed in 11.18s with 6 clusters.
2025-10-25 13:11:26,497 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:11:26,497 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:11:26,615 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:295 - Finding optimal DBSCAN parameters...
2025-10-25 13:12:20,832 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:309 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-25 13:12:22,572 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 56.07s with 2 clusters.
2025-10-25 13:12:22,572 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='determined'.
2025-10-25 13:12:22,703 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_opt on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:12:22,819 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_opt on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:12:22,932 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:12:22,932 - root - INFO - timer:89 - Completed: Segmentation (block4) with k_type: determined in 76.85 seconds
2025-10-25 13:12:22,932 - root - INFO - timer:84 - Starting: Segmentation (block4) with k_type: predefined
2025-10-25 13:12:22,932 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 13:12:22,932 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: predefined
2025-10-25 13:12:22,932 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 13:12:22,932 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 13:12:22,932 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_predef
2025-10-25 13:12:22,932 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:12:23,047 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:12:23,063 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-25 13:12:23,063 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_predef
2025-10-25 13:12:23,063 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:12:23,174 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:12:23,637 - src.models.segmentation.segmentation - INFO - process:496 - Method som_predef completed in 0.58s with 2 clusters.
2025-10-25 13:12:23,637 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:12:23,637 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:12:23,753 - src.models.segmentation.segmentation - INFO - segment:321 - Using predefined DBSCAN.
2025-10-25 13:12:25,421 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 1.78s with 6 clusters.
2025-10-25 13:12:25,421 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='predefined'.
2025-10-25 13:12:25,543 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_predef on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:12:25,653 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_predef on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:12:25,769 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:12:25,769 - root - INFO - timer:89 - Completed: Segmentation (block4) with k_type: predefined in 2.83 seconds
2025-10-25 13:12:25,769 - root - INFO - timer:89 - Completed: Processing test image block4 in 81.76 seconds
2025-10-25 13:12:25,769 - root - INFO - timer:84 - Starting: Processing test image block5
2025-10-25 13:12:25,769 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-25 13:12:25,791 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-25 13:12:27,113 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-25 13:12:27,422 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-25 13:12:27,839 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-25 13:12:27,839 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-25 13:12:27,839 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-25 13:12:27,839 - src.utils.output_manager - INFO - save_preprocessed_image:75 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-25 13:12:27,861 - root - INFO - process_single_test_image:359 - Preprocessing completed for block5 - unique colors: 133
2025-10-25 13:12:27,861 - root - INFO - timer:84 - Starting: Segmentation (block5) with k_type: determined
2025-10-25 13:12:27,861 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: determined
2025-10-25 13:12:27,861 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: determined
2025-10-25 13:12:27,861 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: determined
2025-10-25 13:12:27,861 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-25 13:12:27,861 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_opt
2025-10-25 13:12:27,861 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:12:28,000 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-25 13:12:28,000 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:12:28,000 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:12:29,915 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.977, CH=2414037.8
2025-10-25 13:12:29,915 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:12:31,794 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.958, CH=2246162.8
2025-10-25 13:12:31,794 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:12:33,629 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.862, CH=1941668.4
2025-10-25 13:12:33,629 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:12:35,461 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.853, CH=1960086.9
2025-10-25 13:12:35,461 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:12:37,275 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.810, CH=3263713.8
2025-10-25 13:12:37,275 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 2 (score: 0.679)
2025-10-25 13:12:37,275 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:12:37,290 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_opt completed in 9.42s with 2 clusters.
2025-10-25 13:12:37,290 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_opt
2025-10-25 13:12:37,290 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:12:37,422 - src.models.segmentation.segmentation - INFO - determine_k:105 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-25 13:12:37,422 - src.models.segmentation.segmentation - INFO - determine_k:111 - Subsampling pixels for cluster analysis efficiency
2025-10-25 13:12:37,422 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=2
2025-10-25 13:12:39,288 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=2: Sil=0.976, CH=2279323.0
2025-10-25 13:12:39,289 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=3
2025-10-25 13:12:41,151 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=3: Sil=0.957, CH=2202020.8
2025-10-25 13:12:41,151 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=4
2025-10-25 13:12:43,032 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=4: Sil=0.844, CH=1870257.5
2025-10-25 13:12:43,033 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=5
2025-10-25 13:12:44,898 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=5: Sil=0.842, CH=1845403.9
2025-10-25 13:12:44,898 - src.models.segmentation.segmentation - INFO - determine_k:130 - Testing k=6
2025-10-25 13:12:46,760 - src.models.segmentation.segmentation - INFO - determine_k:140 - Metrics for k=6: Sil=0.821, CH=1811316.8
2025-10-25 13:12:46,760 - src.models.segmentation.segmentation - INFO - determine_k:156 - Optimal k determined: 2 (score: 1.000)
2025-10-25 13:12:46,760 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:12:47,186 - src.models.segmentation.segmentation - INFO - process:496 - Method som_opt completed in 9.90s with 2 clusters.
2025-10-25 13:12:47,186 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:12:47,186 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:12:47,293 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:295 - Finding optimal DBSCAN parameters...
2025-10-25 13:13:30,777 - src.models.segmentation.segmentation - INFO - _find_optimal_dbscan_params:309 - Optimal DBSCAN parameters: eps=20, min=20
2025-10-25 13:13:32,613 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 45.43s with 2 clusters.
2025-10-25 13:13:32,613 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='determined'.
2025-10-25 13:13:32,726 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_opt on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:13:32,828 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_opt on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:13:32,931 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:13:32,931 - root - INFO - timer:89 - Completed: Segmentation (block5) with k_type: determined in 65.07 seconds
2025-10-25 13:13:32,931 - root - INFO - timer:84 - Starting: Segmentation (block5) with k_type: predefined
2025-10-25 13:13:32,931 - src.models.segmentation.segmentation - INFO - __init__:222 - KMeansSegmenter initialized with k_type: predefined
2025-10-25 13:13:32,931 - src.models.segmentation.segmentation - INFO - __init__:358 - SOMSegmenter initialized with k_type: predefined
2025-10-25 13:13:32,931 - src.models.segmentation.segmentation - INFO - __init__:278 - DBSCANSegmenter initialized with k_type: predefined
2025-10-25 13:13:32,931 - src.models.segmentation.segmentation - INFO - __init__:427 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-25 13:13:32,931 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: kmeans_predef
2025-10-25 13:13:32,931 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:13:33,032 - src.models.segmentation.segmentation - INFO - segment:241 - KMeans: Using k = 2
2025-10-25 13:13:33,040 - src.models.segmentation.segmentation - INFO - process:496 - Method kmeans_predef completed in 0.11s with 2 clusters.
2025-10-25 13:13:33,040 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: som_predef
2025-10-25 13:13:33,040 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:13:33,177 - src.models.segmentation.segmentation - INFO - segment:375 - Running SOM segmentation with k=2
2025-10-25 13:13:33,609 - src.models.segmentation.segmentation - INFO - process:496 - Method som_predef completed in 0.57s with 2 clusters.
2025-10-25 13:13:33,609 - src.models.segmentation.segmentation - INFO - process:492 - Running segmentation method: dbscan
2025-10-25 13:13:33,609 - src.models.segmentation.segmentation - INFO - quantize_image:184 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-25 13:13:33,723 - src.models.segmentation.segmentation - INFO - segment:321 - Using predefined DBSCAN.
2025-10-25 13:13:35,386 - src.models.segmentation.segmentation - INFO - process:496 - Method dbscan completed in 1.76s with 3 clusters.
2025-10-25 13:13:35,386 - src.models.segmentation.segmentation - INFO - process:531 - Segmentation processing completed for k_type='predefined'.
2025-10-25 13:13:35,515 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for kmeans_predef on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:13:35,633 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for som_predef on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:13:35,748 - root - ERROR - process_single_test_image:462 - Delta E calculation failed for dbscan on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "c:\Users\LENOVO\Desktop\prints\src\main.py", line 439, in process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "c:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-25 13:13:35,749 - root - INFO - timer:89 - Completed: Segmentation (block5) with k_type: predefined in 2.81 seconds
2025-10-25 13:13:35,749 - root - INFO - timer:89 - Completed: Processing test image block5 in 69.98 seconds
2025-10-25 13:13:35,749 - root - INFO - timer:84 - Starting: Results saving and summary
2025-10-25 13:13:35,750 - root - WARNING - save_and_summarize_results:480 - No Delta E results were generated to save.
2025-10-25 13:13:35,750 - root - INFO - timer:89 - Completed: Results saving and summary in 0.00 seconds
2025-10-25 13:13:35,750 - root - INFO - main:604 - ================================================================================
PROCESSING COMPLETED IN 571.86 SECONDS
================================================================================
2025-10-25 13:13:35,794 - root - INFO - main:611 - Profiling results saved to: C:\Users\LENOVO\Desktop\prints\output\profile_stats.txt
2025-10-26 15:54:29,436 - root - INFO - setup_logging:78 - Logging setup complete. Level: INFO. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-26 15:54:29,437 - src.pipeline - INFO - _load_and_validate_config:86 - loading the config from: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-26 15:54:29,441 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from C:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-26 15:54:29,447 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-26 15:54:29,448 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-26 15:54:29,448 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-26 15:54:29,449 - src.utils.setup - DEBUG - validate_processing_config:104 - Entering configuration validation...
2025-10-26 15:54:29,449 - src.utils.setup - DEBUG - validate_processing_config:145 - Reference image path validated: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 15:54:29,450 - src.utils.setup - DEBUG - validate_processing_config:165 - Validated 5 test image paths.
2025-10-26 15:54:29,450 - src.utils.setup - INFO - validate_processing_config:183 - Configuration validation passed successfully.
2025-10-26 15:54:29,452 - src.utils.output_manager - INFO - __init__:27 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-26 15:54:29,452 - src.pipeline - INFO - _load_and_validate_config:97 - OutputManager intialized for dataset: block
2025-10-26 15:54:29,452 - src.pipeline - INFO - run:102 - ==================================================
2025-10-26 15:54:29,452 - src.pipeline - INFO - run:103 - Processing Pipeline RUN starting for dataset: block
2025-10-26 15:54:29,452 - src.pipeline - INFO - run:104 - ==================================================
2025-10-26 15:54:29,453 - src.pipeline - INFO - timer:43 - Starting: Total Pipeline...
2025-10-26 15:54:29,454 - src.pipeline - INFO - timer:43 - Starting: DBN Training...
2025-10-26 15:54:29,454 - src.pipeline - INFO - _train_dbn_model:140 - loading images to generate training data...
2025-10-26 15:54:30,131 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-26 15:54:31,043 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-26 15:54:31,583 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-26 15:54:32,117 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-26 15:54:32,653 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-26 15:54:32,653 - src.pipeline - INFO - _train_dbn_model:152 - loading and processing 5 images into training data...
2025-10-26 15:54:32,654 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-26 15:54:34,645 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-26 15:54:34,646 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-26 15:54:34,649 - src.pipeline - INFO - _train_dbn_model:160 - initializing DBNTrainer (Samples  = 800...)
2025-10-26 15:54:34,650 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-26 15:54:34,650 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-26 15:54:34,650 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-26 15:54:34,654 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 1
2025-10-26 15:54:34,655 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 2
2025-10-26 15:54:34,655 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 3
2025-10-26 15:54:34,655 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 4
2025-10-26 15:54:34,656 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 5
2025-10-26 15:54:34,656 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-26 15:54:34,657 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [31.00, 214.00]
2025-10-26 15:54:34,657 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.71], a[-2.00, 3.00], b[-1.00, 8.00]
2025-10-26 15:54:34,661 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-26 15:54:34,662 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-26 15:54:34,665 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-26 15:54:34,665 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-26 15:54:34,665 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-26 15:54:34,666 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-26 15:54:34,926 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-26 15:54:35,000 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-26 15:54:35,001 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.237, 0.238]
2025-10-26 15:54:35,001 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-26 15:54:35,002 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-26 15:54:35,002 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-26 15:54:35,003 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-26 15:54:35,003 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-26 15:54:35,003 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-26 15:54:35,004 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-26 15:54:35,004 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-26 15:54:35,004 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-26 15:54:35,005 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-26 15:54:35,005 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-26 15:54:35,006 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.283, 0.282]
2025-10-26 15:54:35,006 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-26 15:54:35,007 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-26 15:54:35,007 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-26 15:54:35,007 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-26 15:54:35,008 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-26 15:54:35,008 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.455, 0.441]
2025-10-26 15:54:35,009 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-26 15:54:35,009 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-26 15:54:35,009 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-26 15:56:47,930 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 132.91s - Final fitness: 0.020501
2025-10-26 15:56:47,931 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-26 15:56:47,938 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-26 15:56:47,939 - src.pipeline - INFO - _train_dbn_model:164 - DBN training and scaling complete
2025-10-26 15:56:47,942 - src.pipeline - INFO - timer:48 - Completed: DBN Training in  138.49 seconds
2025-10-26 15:56:47,943 - src.pipeline - INFO - timer:43 - Starting: Reference Image Processing...
2025-10-26 15:56:47,943 - src.pipeline - INFO - _run_reference_processing:182 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 15:56:49,566 - root - INFO - save_reference_image:71 - Saved reference image copy to datasets\block\inputs\reference_image\reference.png
2025-10-26 15:56:49,567 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 15:56:49,567 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-26 15:56:49,599 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-26 15:56:50,994 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 15:56:51,339 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 15:56:51,353 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 15:56:52,217 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 15:56:52,219 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 15:56:52,219 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 15:56:52,220 - src.models.segmentation.reference - INFO - segment_reference_image:58 - Starting reference image segmentation (K-Means & SOM)...
2025-10-26 15:56:52,220 - src.models.segmentation.reference - INFO - segment_reference_image:77 - Determining optimal number of clusters for reference image...
2025-10-26 15:56:52,221 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:56:52,345 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:56:52,346 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:56:52,348 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:56:54,327 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:56:56,282 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:56:58,174 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:57:00,118 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 15:57:02,031 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 2 (score: 0.965)
2025-10-26 15:57:02,032 - src.models.segmentation.reference - INFO - segment_reference_image:105 - Optimal clusters determined for reference: 2
2025-10-26 15:57:02,032 - src.models.segmentation.reference - INFO - timer:182 - Starting: Reference K-Means (k=2)...
2025-10-26 15:57:02,033 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 15:57:02,033 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:57:02,141 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 15:57:02,154 - src.models.segmentation.reference - INFO - timer:187 - Completed: Reference K-Means (k=2) in 0.12 seconds
2025-10-26 15:57:02,154 - src.models.segmentation.reference - INFO - timer:182 - Starting: Reference SOM (k=2)...
2025-10-26 15:57:02,157 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 15:57:02,158 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:57:02,291 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 15:57:02,649 - src.models.segmentation.reference - INFO - timer:187 - Completed: Reference SOM (k=2) in 0.49 seconds
2025-10-26 15:57:02,649 - src.models.segmentation.reference - INFO - segment_reference_image:171 - Reference segmentation finished in 10.43 seconds.
2025-10-26 15:57:03,872 - root - INFO - save_reference_summary:130 - Reference summary (placeholder) saved to datasets\block\summaries\reference_summary.png
2025-10-26 15:57:03,874 - src.pipeline - INFO - _run_reference_processing:238 - Reference processed. Target LAB colors shape: (2, 3), Determined k: 2
2025-10-26 15:57:03,882 - src.pipeline - INFO - timer:48 - Completed: Reference Image Processing in  15.94 seconds
2025-10-26 15:57:03,882 - src.pipeline - INFO - timer:43 - Starting: Test Image Analysis Loop...
2025-10-26 15:57:03,883 - src.pipeline - INFO - _run_test_image_analysis:252 - Starting test image analysis loop...
2025-10-26 15:57:03,883 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block1 ---
2025-10-26 15:57:04,190 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block1
2025-10-26 15:57:04,191 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block1...
2025-10-26 15:57:04,191 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 15:57:04,191 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-26 15:57:04,218 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-26 15:57:05,535 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 15:57:05,873 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 15:57:05,882 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 15:57:06,286 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 15:57:06,288 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 15:57:06,288 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 15:57:06,288 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-26 15:57:06,289 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block1) k_type: determined...
2025-10-26 15:57:06,289 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 15:57:06,289 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 15:57:06,289 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 15:57:06,289 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 15:57:06,290 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 15:57:06,290 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 15:57:06,290 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 15:57:06,290 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 15:57:06,290 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 15:57:06,290 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 15:57:06,290 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 15:57:06,291 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 15:57:06,291 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 15:57:06,291 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 15:57:06,291 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 15:57:06,291 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 15:57:06,291 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 15:57:06,291 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 15:57:06,292 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 15:57:06,292 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:57:06,395 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 15:57:06,437 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:57:06,438 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:57:06,440 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:57:08,374 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:57:10,299 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:57:12,245 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:57:14,195 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 15:57:16,146 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 4 (score: 0.762)
2025-10-26 15:57:16,146 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 4
2025-10-26 15:57:16,175 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.88s with 4 clusters.
2025-10-26 15:57:16,176 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_kmeans_opt_determined.png
2025-10-26 15:57:16,177 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 15:57:16,178 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:57:16,305 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:57:16,306 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:57:16,308 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:57:18,230 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:57:20,198 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:57:22,159 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:57:24,101 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 15:57:26,049 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.691)
2025-10-26 15:57:26,049 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=3
2025-10-26 15:57:26,387 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 10.21s with 3 clusters.
2025-10-26 15:57:26,389 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_som_opt_determined.png
2025-10-26 15:57:26,389 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 15:57:26,389 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:57:26,493 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 15:58:19,277 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-26 15:58:21,003 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 54.61s with 2 clusters.
2025-10-26 15:58:21,005 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_dbscan_determined.png
2025-10-26 15:58:21,005 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 15:58:21,236 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_opt on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:58:21,337 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_opt on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:58:21,434 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:58:21,435 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block1) k_type: determined in  75.15 seconds
2025-10-26 15:58:21,436 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block1) k_type: predefined...
2025-10-26 15:58:21,436 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 15:58:21,436 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 15:58:21,437 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 15:58:21,437 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 15:58:21,438 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 15:58:21,438 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 15:58:21,438 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 15:58:21,438 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 15:58:21,438 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 15:58:21,439 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 15:58:21,439 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 15:58:21,439 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 15:58:21,440 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 15:58:21,440 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:58:21,546 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 15:58:21,556 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-26 15:58:21,558 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_kmeans_predef_predefined.png
2025-10-26 15:58:21,558 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 15:58:21,559 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:58:21,689 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 15:58:22,040 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.48s with 2 clusters.
2025-10-26 15:58:22,041 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_som_predef_predefined.png
2025-10-26 15:58:22,042 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 15:58:22,042 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:58:22,149 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 15:58:23,874 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.83s with 6 clusters.
2025-10-26 15:58:23,877 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_dbscan_predefined.png
2025-10-26 15:58:23,878 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 15:58:23,995 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_predef on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:58:24,095 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_predef on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:58:24,191 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block1: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:58:24,192 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block1) k_type: predefined in  2.76 seconds
2025-10-26 15:58:24,193 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block1 in  80.00 seconds
2025-10-26 15:58:24,193 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block2 ---
2025-10-26 15:58:24,582 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block2
2025-10-26 15:58:24,582 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block2...
2025-10-26 15:58:24,582 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 15:58:24,582 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-26 15:58:24,615 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-26 15:58:25,928 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 15:58:26,257 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 15:58:26,270 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 15:58:26,668 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 15:58:26,670 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 15:58:26,670 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 15:58:26,672 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-26 15:58:26,673 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block2) k_type: determined...
2025-10-26 15:58:26,673 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 15:58:26,673 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 15:58:26,673 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 15:58:26,673 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 15:58:26,674 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 15:58:26,674 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 15:58:26,674 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 15:58:26,674 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 15:58:26,674 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 15:58:26,674 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 15:58:26,675 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 15:58:26,675 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 15:58:26,675 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 15:58:26,675 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 15:58:26,675 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 15:58:26,675 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 15:58:26,676 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 15:58:26,676 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 15:58:26,676 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 15:58:26,677 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:58:26,784 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 15:58:26,805 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:58:26,805 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:58:26,808 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:58:28,675 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:58:30,535 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:58:32,333 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:58:34,156 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 15:58:35,979 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.875)
2025-10-26 15:58:35,979 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 3
2025-10-26 15:58:35,998 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.32s with 3 clusters.
2025-10-26 15:58:35,999 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_kmeans_opt_determined.png
2025-10-26 15:58:36,000 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 15:58:36,000 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:58:36,133 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:58:36,134 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:58:36,136 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:58:37,990 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:58:39,867 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:58:41,734 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:58:43,616 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 15:58:45,457 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.949)
2025-10-26 15:58:45,457 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=3
2025-10-26 15:58:45,809 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.81s with 3 clusters.
2025-10-26 15:58:45,810 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_som_opt_determined.png
2025-10-26 15:58:45,810 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 15:58:45,811 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:58:45,926 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 15:59:34,165 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15, min=10
2025-10-26 15:59:36,043 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 50.23s with 2 clusters.
2025-10-26 15:59:36,045 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_dbscan_determined.png
2025-10-26 15:59:36,045 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 15:59:36,158 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_opt on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:59:36,257 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_opt on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:59:36,356 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:59:36,357 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block2) k_type: determined in  69.68 seconds
2025-10-26 15:59:36,357 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block2) k_type: predefined...
2025-10-26 15:59:36,358 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 15:59:36,358 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 15:59:36,358 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 15:59:36,358 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 15:59:36,358 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 15:59:36,358 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 15:59:36,359 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 15:59:36,359 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 15:59:36,360 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 15:59:36,360 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 15:59:36,360 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 15:59:36,360 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 15:59:36,361 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 15:59:36,361 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:59:36,472 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 15:59:36,480 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-26 15:59:36,482 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_kmeans_predef_predefined.png
2025-10-26 15:59:36,483 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 15:59:36,483 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:59:36,619 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 15:59:36,984 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.50s with 2 clusters.
2025-10-26 15:59:36,986 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_som_predef_predefined.png
2025-10-26 15:59:36,986 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 15:59:36,987 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:59:37,095 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 15:59:38,931 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.94s with 5 clusters.
2025-10-26 15:59:38,934 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_dbscan_predefined.png
2025-10-26 15:59:38,935 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 15:59:39,052 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_predef on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:59:39,155 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_predef on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:59:39,260 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block2: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 15:59:39,261 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block2) k_type: predefined in  2.90 seconds
2025-10-26 15:59:39,261 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block2 in  74.68 seconds
2025-10-26 15:59:39,262 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block3 ---
2025-10-26 15:59:39,475 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block3
2025-10-26 15:59:39,475 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block3...
2025-10-26 15:59:39,476 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 15:59:39,476 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-26 15:59:39,498 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-26 15:59:40,827 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 15:59:41,159 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 15:59:41,172 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 15:59:41,589 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 15:59:41,591 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 15:59:41,591 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 15:59:41,595 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-26 15:59:41,596 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block3) k_type: determined...
2025-10-26 15:59:41,596 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 15:59:41,596 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 15:59:41,596 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 15:59:41,596 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 15:59:41,597 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 15:59:41,597 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 15:59:41,597 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 15:59:41,597 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 15:59:41,597 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 15:59:41,597 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 15:59:41,598 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 15:59:41,598 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 15:59:41,598 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 15:59:41,598 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 15:59:41,598 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 15:59:41,598 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 15:59:41,599 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 15:59:41,599 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 15:59:41,600 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 15:59:41,600 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:59:41,712 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 15:59:41,736 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:59:41,737 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:59:41,739 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:59:43,549 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:59:45,400 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:59:47,237 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:59:49,037 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 15:59:50,822 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 2 (score: 0.788)
2025-10-26 15:59:50,822 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 15:59:50,830 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.23s with 2 clusters.
2025-10-26 15:59:50,831 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_kmeans_opt_determined.png
2025-10-26 15:59:50,831 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 15:59:50,831 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 15:59:50,985 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 15:59:50,985 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 15:59:50,987 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 15:59:52,845 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 15:59:54,702 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 15:59:56,538 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 15:59:58,360 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:00:00,172 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 2 (score: 0.775)
2025-10-26 16:00:00,173 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:00:00,516 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.68s with 2 clusters.
2025-10-26 16:00:00,517 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_som_opt_determined.png
2025-10-26 16:00:00,518 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:00:00,518 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:00:00,621 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:00:49,399 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-26 16:00:50,915 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 50.40s with 2 clusters.
2025-10-26 16:00:50,916 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_dbscan_determined.png
2025-10-26 16:00:50,916 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:00:51,039 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_opt on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:00:51,148 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_opt on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:00:51,253 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:00:51,254 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block3) k_type: determined in  69.66 seconds
2025-10-26 16:00:51,254 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block3) k_type: predefined...
2025-10-26 16:00:51,255 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:00:51,255 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:00:51,255 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:00:51,255 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:00:51,255 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:00:51,255 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:00:51,256 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:00:51,256 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:00:51,256 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:00:51,256 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:00:51,256 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:00:51,256 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:00:51,257 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:00:51,257 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:00:51,257 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:00:51,257 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:00:51,257 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:00:51,258 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:00:51,258 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:00:51,259 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:00:51,370 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:00:51,379 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-26 16:00:51,381 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_kmeans_predef_predefined.png
2025-10-26 16:00:51,382 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:00:51,383 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:00:51,515 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:00:51,871 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.49s with 2 clusters.
2025-10-26 16:00:51,872 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_som_predef_predefined.png
2025-10-26 16:00:51,873 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:00:51,873 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:00:51,994 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:00:53,250 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.38s with 7 clusters.
2025-10-26 16:00:53,252 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_dbscan_predefined.png
2025-10-26 16:00:53,252 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:00:53,362 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_predef on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:00:53,464 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_predef on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:00:53,566 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block3: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:00:53,568 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block3) k_type: predefined in  2.31 seconds
2025-10-26 16:00:53,568 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block3 in  74.09 seconds
2025-10-26 16:00:53,569 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block4 ---
2025-10-26 16:00:53,801 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block4
2025-10-26 16:00:53,802 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block4...
2025-10-26 16:00:53,802 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:00:53,802 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-26 16:00:53,828 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-26 16:00:55,175 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:00:55,531 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:00:55,542 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:00:55,954 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:00:55,955 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:00:55,955 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:00:55,957 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-26 16:00:55,957 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block4) k_type: determined...
2025-10-26 16:00:55,957 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:00:55,958 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:00:55,958 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:00:55,959 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:00:55,959 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:00:55,959 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:00:55,959 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:00:55,959 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:00:55,959 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:00:55,959 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:00:55,960 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:00:55,960 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:00:55,960 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:00:55,961 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:00:56,064 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:00:56,084 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:00:56,085 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:00:56,087 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:00:57,951 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:00:59,817 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:01:01,674 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:01:03,503 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:01:05,307 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 6 (score: 0.598)
2025-10-26 16:01:05,307 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 6
2025-10-26 16:01:05,353 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.39s with 6 clusters.
2025-10-26 16:01:05,355 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_kmeans_opt_determined.png
2025-10-26 16:01:05,355 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:01:05,356 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:01:05,491 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:01:05,492 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:01:05,494 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:01:07,338 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:01:09,198 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:01:11,067 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:01:12,919 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:01:14,765 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 6 (score: 0.745)
2025-10-26 16:01:14,766 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=6
2025-10-26 16:01:15,101 - src.models.segmentation.som - WARNING - segment:110 - SOM empty mask cluster 1 (k=6).
2025-10-26 16:01:15,101 - src.models.segmentation.som - WARNING - segment:110 - SOM empty mask cluster 2 (k=6).
2025-10-26 16:01:15,102 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.75s with 6 clusters.
2025-10-26 16:01:15,105 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_som_opt_determined.png
2025-10-26 16:01:15,106 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:01:15,106 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:01:15,208 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:01:53,915 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=10, min=20
2025-10-26 16:01:55,630 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 40.52s with 3 clusters.
2025-10-26 16:01:55,631 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_dbscan_determined.png
2025-10-26 16:01:55,631 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:01:55,741 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_opt on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:01:55,844 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_opt on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:01:55,941 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:01:55,943 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block4) k_type: determined in  59.99 seconds
2025-10-26 16:01:55,943 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block4) k_type: predefined...
2025-10-26 16:01:55,944 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:01:55,944 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:01:55,944 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:01:55,944 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:01:55,944 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:01:55,944 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:01:55,945 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:01:55,945 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:01:55,945 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:01:55,945 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:01:55,945 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:01:55,945 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:01:55,945 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:01:55,946 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:01:55,946 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:01:55,946 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:01:55,946 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:01:55,946 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:01:55,947 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:01:55,947 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:01:56,060 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:01:56,068 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-26 16:01:56,071 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_kmeans_predef_predefined.png
2025-10-26 16:01:56,072 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:01:56,072 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:01:56,196 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:01:56,580 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.51s with 2 clusters.
2025-10-26 16:01:56,582 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_som_predef_predefined.png
2025-10-26 16:01:56,582 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:01:56,583 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:01:56,693 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:01:58,371 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.79s with 7 clusters.
2025-10-26 16:01:58,373 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_dbscan_predefined.png
2025-10-26 16:01:58,373 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:01:58,483 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_predef on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:01:58,595 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_predef on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:01:58,697 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block4: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:01:58,698 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block4) k_type: predefined in  2.75 seconds
2025-10-26 16:01:58,698 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block4 in  64.90 seconds
2025-10-26 16:01:58,699 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block5 ---
2025-10-26 16:01:58,941 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block5
2025-10-26 16:01:58,941 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block5...
2025-10-26 16:01:58,942 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:01:58,942 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-26 16:01:58,961 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-26 16:02:00,339 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:02:00,659 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:02:00,673 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:02:01,069 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:02:01,071 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:02:01,071 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:02:01,073 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-26 16:02:01,073 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block5) k_type: determined...
2025-10-26 16:02:01,073 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:02:01,073 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:02:01,074 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:02:01,074 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:02:01,074 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:02:01,074 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:02:01,074 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:02:01,074 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:02:01,075 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:02:01,075 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:02:01,075 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:02:01,075 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:02:01,075 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:02:01,076 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:02:01,076 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:02:01,076 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:02:01,076 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:02:01,076 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:02:01,077 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:02:01,077 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:02:01,181 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:02:01,206 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:02:01,206 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:02:01,209 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:02:03,089 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:02:04,973 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:02:06,862 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:02:08,733 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:02:10,609 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 6 (score: 0.548)
2025-10-26 16:02:10,610 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 6
2025-10-26 16:02:10,651 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.57s with 6 clusters.
2025-10-26 16:02:10,652 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_kmeans_opt_determined.png
2025-10-26 16:02:10,653 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:02:10,653 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:02:10,782 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-26 16:02:10,783 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:02:10,785 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:02:12,660 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:02:14,558 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:02:16,408 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:02:18,259 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:02:20,092 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 2 (score: 0.610)
2025-10-26 16:02:20,093 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:02:20,414 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.76s with 2 clusters.
2025-10-26 16:02:20,416 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_som_opt_determined.png
2025-10-26 16:02:20,416 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:02:20,416 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:02:20,517 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:03:13,244 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=20, min=10
2025-10-26 16:03:15,118 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 54.70s with 2 clusters.
2025-10-26 16:03:15,121 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_dbscan_determined.png
2025-10-26 16:03:15,122 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:03:15,241 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_opt on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:03:15,340 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_opt on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:03:15,442 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:03:15,443 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block5) k_type: determined in  74.37 seconds
2025-10-26 16:03:15,443 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block5) k_type: predefined...
2025-10-26 16:03:15,444 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:03:15,444 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:03:15,444 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:03:15,444 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:03:15,444 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:03:15,444 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:03:15,445 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:03:15,445 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:03:15,445 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:03:15,445 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:03:15,445 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:03:15,445 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:03:15,445 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:03:15,446 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:03:15,446 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:03:15,446 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:03:15,446 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:03:15,446 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:03:15,447 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:03:15,447 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:03:15,551 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:03:15,560 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.11s with 2 clusters.
2025-10-26 16:03:15,564 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_kmeans_predef_predefined.png
2025-10-26 16:03:15,564 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:03:15,565 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:03:15,690 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:03:16,044 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.48s with 2 clusters.
2025-10-26 16:03:16,045 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_som_predef_predefined.png
2025-10-26 16:03:16,045 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:03:16,045 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:03:16,146 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:03:17,959 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.91s with 7 clusters.
2025-10-26 16:03:17,961 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_dbscan_predefined.png
2025-10-26 16:03:17,961 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:03:18,086 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for kmeans_predef on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:03:18,183 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for som_predef on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:03:18,279 - src.pipeline - ERROR - _process_single_test_image:398 - Delta E calculation failed for dbscan on block5: name 'segmented_colors_lab' is not defined
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 372, in _process_single_test_image
    delta_e_traditional_list = color_metric_calculator.compute_all_delta_e(segmented_lab_traditional)
  File "C:\Users\LENOVO\Desktop\prints\src\utils\color\color_analysis.py", line 134, in compute_all_delta_e
    return self.compute_similarity(segmented_colors_lab)
NameError: name 'segmented_colors_lab' is not defined
2025-10-26 16:03:18,280 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block5) k_type: predefined in  2.84 seconds
2025-10-26 16:03:18,281 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block5 in  79.34 seconds
2025-10-26 16:03:18,281 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: None
2025-10-26 16:03:18,281 - src.pipeline - INFO - _run_test_image_analysis:278 - Test image analysis loop finished.
2025-10-26 16:03:18,285 - src.pipeline - INFO - timer:48 - Completed: Test Image Analysis Loop in  374.40 seconds
2025-10-26 16:03:18,285 - src.pipeline - INFO - timer:43 - Starting: Saving Final Results...
2025-10-26 16:03:18,286 - src.pipeline - WARNING - _save_and_summarize_results:413 - No Delta E results to save or summarize.
2025-10-26 16:03:18,286 - src.pipeline - INFO - timer:48 - Completed: Saving Final Results in  0.00 seconds
2025-10-26 16:03:18,287 - src.pipeline - INFO - timer:48 - Completed: Total Pipeline in  528.83 seconds
2025-10-26 16:03:18,287 - src.pipeline - INFO - run:127 - ==================================================
2025-10-26 16:03:18,287 - src.pipeline - INFO - run:128 - Processing Pipeline RUN completed for: block
2025-10-26 16:03:18,288 - src.pipeline - INFO - run:129 - ==================================================
2025-10-26 16:03:18,288 - root - INFO - main:69 - Main execution finished successfully.
2025-10-26 16:03:18,289 - root - INFO - main:75 - ================================================================================
PROCESSING COMPLETED IN 528.85 SECONDS
================================================================================
2025-10-26 16:09:44,659 - root - INFO - setup_logging:78 - Logging setup complete. Level: INFO. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-26 16:09:44,660 - src.pipeline - INFO - _load_and_validate_config:86 - loading the config from: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-26 16:09:44,665 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from C:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-26 16:09:44,668 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-26 16:09:44,669 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-26 16:09:44,669 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-26 16:09:44,670 - src.utils.setup - DEBUG - validate_processing_config:104 - Entering configuration validation...
2025-10-26 16:09:44,670 - src.utils.setup - DEBUG - validate_processing_config:145 - Reference image path validated: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 16:09:44,671 - src.utils.setup - DEBUG - validate_processing_config:165 - Validated 5 test image paths.
2025-10-26 16:09:44,671 - src.utils.setup - INFO - validate_processing_config:183 - Configuration validation passed successfully.
2025-10-26 16:09:44,673 - src.utils.output_manager - INFO - __init__:27 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-26 16:09:44,674 - src.pipeline - INFO - _load_and_validate_config:97 - OutputManager intialized for dataset: block
2025-10-26 16:09:44,676 - src.pipeline - INFO - run:102 - ==================================================
2025-10-26 16:09:44,677 - src.pipeline - INFO - run:103 - Processing Pipeline RUN starting for dataset: block
2025-10-26 16:09:44,678 - src.pipeline - INFO - run:104 - ==================================================
2025-10-26 16:09:44,679 - src.pipeline - INFO - timer:43 - Starting: Total Pipeline...
2025-10-26 16:09:44,679 - src.pipeline - INFO - timer:43 - Starting: DBN Training...
2025-10-26 16:09:44,680 - src.pipeline - INFO - _train_dbn_model:140 - loading images to generate training data...
2025-10-26 16:09:45,464 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-26 16:09:46,359 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-26 16:09:46,830 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-26 16:09:47,360 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-26 16:09:47,943 - root - INFO - save_test_image:81 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-26 16:09:47,943 - src.pipeline - INFO - _train_dbn_model:152 - loading and processing 5 images into training data...
2025-10-26 16:09:47,944 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-26 16:09:49,838 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-26 16:09:49,839 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-26 16:09:49,842 - src.pipeline - INFO - _train_dbn_model:160 - initializing DBNTrainer (Samples  = 800...)
2025-10-26 16:09:49,843 - src.models.dbn_trainer - INFO - __init__:48 - DBNTrainer initialized.
2025-10-26 16:09:49,843 - src.models.dbn_trainer - INFO - train:64 - Starting DBN training and PSO optimization process...
2025-10-26 16:09:49,844 - src.data.preprocess - INFO - efficient_data_sampling:207 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-26 16:09:49,845 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 1
2025-10-26 16:09:49,846 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 2
2025-10-26 16:09:49,847 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 3
2025-10-26 16:09:49,847 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 4
2025-10-26 16:09:49,848 - src.data.preprocess - DEBUG - efficient_data_sampling:227 - Planning to sample 160 pixels from image 5
2025-10-26 16:09:49,849 - src.data.preprocess - INFO - efficient_data_sampling:282 - Sampling completed: 800 samples extracted.
2025-10-26 16:09:49,849 - src.data.preprocess - INFO - efficient_data_sampling:283 - RGB range: [32.00, 214.00]
2025-10-26 16:09:49,849 - src.data.preprocess - INFO - efficient_data_sampling:284 - LAB ranges: L[12.16, 84.71], a[-2.00, 3.00], b[-2.00, 9.00]
2025-10-26 16:09:49,851 - src.models.dbn_trainer - INFO - train:77 - Training set: (640, 3), Test set: (160, 3)
2025-10-26 16:09:49,851 - src.models.dbn_trainer - INFO - _prepare_scalers:109 - Preparing and fitting scalers...
2025-10-26 16:09:49,854 - src.models.dbn_trainer - INFO - _prepare_scalers:128 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-26 16:09:49,854 - src.models.dbn_trainer - INFO - _prepare_scalers:129 - X range: [0.000, 1.000]
2025-10-26 16:09:49,855 - src.models.dbn_trainer - INFO - _prepare_scalers:130 - Y range: [0.000, 1.000]
2025-10-26 16:09:49,855 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-26 16:09:50,069 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-26 16:09:50,117 - src.models.dbn_trainer - INFO - train:88 - Initial model has 20 weight layers
2025-10-26 16:09:50,117 - src.models.dbn_trainer - INFO - train:90 - Layer 0: shape (3, 100), range [-0.240, 0.241]
2025-10-26 16:09:50,117 - src.models.dbn_trainer - INFO - train:90 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-26 16:09:50,118 - src.models.dbn_trainer - INFO - train:90 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-26 16:09:50,118 - src.models.dbn_trainer - INFO - train:90 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-26 16:09:50,119 - src.models.dbn_trainer - INFO - train:90 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-26 16:09:50,119 - src.models.dbn_trainer - INFO - train:90 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-26 16:09:50,119 - src.models.dbn_trainer - INFO - train:90 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-26 16:09:50,120 - src.models.dbn_trainer - INFO - train:90 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-26 16:09:50,120 - src.models.dbn_trainer - INFO - train:90 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-26 16:09:50,121 - src.models.dbn_trainer - INFO - train:90 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-26 16:09:50,121 - src.models.dbn_trainer - INFO - train:90 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-26 16:09:50,122 - src.models.dbn_trainer - INFO - train:90 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-26 16:09:50,122 - src.models.dbn_trainer - INFO - train:90 - Layer 12: shape (50, 25), range [-0.282, 0.283]
2025-10-26 16:09:50,123 - src.models.dbn_trainer - INFO - train:90 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-26 16:09:50,123 - src.models.dbn_trainer - INFO - train:90 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-26 16:09:50,124 - src.models.dbn_trainer - INFO - train:90 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-26 16:09:50,124 - src.models.dbn_trainer - INFO - train:90 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-26 16:09:50,124 - src.models.dbn_trainer - INFO - train:90 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-26 16:09:50,125 - src.models.dbn_trainer - INFO - train:90 - Layer 18: shape (25, 3), range [-0.460, 0.448]
2025-10-26 16:09:50,125 - src.models.dbn_trainer - INFO - train:90 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-26 16:09:50,125 - src.models.dbn_trainer - INFO - _run_pso_with_retries:139 - PSO optimization attempt 1/3
2025-10-26 16:09:50,126 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-26 16:12:02,188 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 132.06s - Final fitness: 0.012329
2025-10-26 16:12:02,189 - src.models.dbn_trainer - INFO - _run_pso_with_retries:154 - PSO optimization completed successfully
2025-10-26 16:12:02,196 - src.models.dbn_trainer - INFO - train:96 - DBN training and PSO optimization complete.
2025-10-26 16:12:02,196 - src.pipeline - INFO - _train_dbn_model:164 - DBN training and scaling complete
2025-10-26 16:12:02,200 - src.pipeline - INFO - timer:48 - Completed: DBN Training in  137.52 seconds
2025-10-26 16:12:02,201 - src.pipeline - INFO - timer:43 - Starting: Reference Image Processing...
2025-10-26 16:12:02,201 - src.pipeline - INFO - _run_reference_processing:182 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 16:12:03,850 - root - INFO - save_reference_image:71 - Saved reference image copy to datasets\block\inputs\reference_image\reference.png
2025-10-26 16:12:03,851 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:12:03,851 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-26 16:12:03,882 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-26 16:12:05,202 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:12:05,543 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:12:05,557 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:12:06,280 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:12:06,281 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:12:06,282 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:12:06,282 - src.models.segmentation.reference - INFO - segment_reference_image:58 - Starting reference image segmentation (K-Means & SOM)...
2025-10-26 16:12:06,282 - src.models.segmentation.reference - INFO - segment_reference_image:77 - Determining optimal number of clusters for reference image...
2025-10-26 16:12:06,283 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:12:06,411 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-26 16:12:06,412 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:12:06,414 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:12:08,299 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:12:10,248 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:12:12,156 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:12:14,042 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:12:15,849 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 6 (score: 0.785)
2025-10-26 16:12:15,849 - src.models.segmentation.reference - INFO - segment_reference_image:105 - Optimal clusters determined for reference: 6
2025-10-26 16:12:15,850 - src.models.segmentation.reference - INFO - timer:182 - Starting: Reference K-Means (k=6)...
2025-10-26 16:12:15,850 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:12:15,851 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:12:15,950 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 6
2025-10-26 16:12:16,001 - src.models.segmentation.reference - INFO - timer:187 - Completed: Reference K-Means (k=6) in 0.15 seconds
2025-10-26 16:12:16,002 - src.models.segmentation.reference - INFO - timer:182 - Starting: Reference SOM (k=6)...
2025-10-26 16:12:16,003 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:12:16,003 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:12:16,133 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=6
2025-10-26 16:12:16,504 - src.models.segmentation.reference - INFO - timer:187 - Completed: Reference SOM (k=6) in 0.50 seconds
2025-10-26 16:12:16,504 - src.models.segmentation.reference - INFO - segment_reference_image:171 - Reference segmentation finished in 10.22 seconds.
2025-10-26 16:12:17,770 - root - INFO - save_reference_summary:130 - Reference summary (placeholder) saved to datasets\block\summaries\reference_summary.png
2025-10-26 16:12:17,771 - src.pipeline - INFO - _run_reference_processing:238 - Reference processed. Target LAB colors shape: (6, 3), Determined k: 6
2025-10-26 16:12:17,777 - src.pipeline - INFO - timer:48 - Completed: Reference Image Processing in  15.58 seconds
2025-10-26 16:12:17,778 - src.pipeline - INFO - timer:43 - Starting: Test Image Analysis Loop...
2025-10-26 16:12:17,778 - src.pipeline - INFO - _run_test_image_analysis:252 - Starting test image analysis loop...
2025-10-26 16:12:17,779 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block1 ---
2025-10-26 16:12:18,073 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block1
2025-10-26 16:12:18,073 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block1...
2025-10-26 16:12:18,073 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:12:18,074 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3950, 3950, 3)
2025-10-26 16:12:18,113 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3950x3950 to 512x512
2025-10-26 16:12:19,497 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:12:19,866 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 332 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:12:19,886 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:12:20,292 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:12:20,294 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:12:20,294 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:12:20,295 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-26 16:12:20,296 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block1) k_type: determined...
2025-10-26 16:12:20,296 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:12:20,296 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:12:20,296 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:12:20,296 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:12:20,297 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:12:20,297 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:12:20,297 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:12:20,297 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:12:20,297 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:12:20,297 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:12:20,297 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:12:20,298 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:12:20,298 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:12:20,298 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:12:20,298 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:12:20,298 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:12:20,298 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:12:20,298 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:12:20,299 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:12:20,299 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:12:20,398 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:12:20,415 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:12:20,416 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:12:20,418 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:12:22,276 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:12:24,149 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:12:26,029 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:12:27,849 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:12:29,713 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.881)
2025-10-26 16:12:29,713 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 3
2025-10-26 16:12:29,736 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.44s with 3 clusters.
2025-10-26 16:12:29,738 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_kmeans_opt_determined.png
2025-10-26 16:12:29,738 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:12:29,739 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:12:29,872 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:12:29,872 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:12:29,874 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:12:31,854 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:12:33,974 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:12:35,908 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:12:38,007 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:12:39,983 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.857)
2025-10-26 16:12:39,983 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=3
2025-10-26 16:12:40,350 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 10.61s with 3 clusters.
2025-10-26 16:12:40,351 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_som_opt_determined.png
2025-10-26 16:12:40,352 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:12:40,352 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:12:40,465 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:13:45,824 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-26 16:13:47,520 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 67.17s with 2 clusters.
2025-10-26 16:13:47,522 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_dbscan_determined.png
2025-10-26 16:13:47,522 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:13:47,975 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block1) k_type: determined in  87.68 seconds
2025-10-26 16:13:47,975 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block1) k_type: predefined...
2025-10-26 16:13:47,975 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:13:47,976 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:13:47,976 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:13:47,976 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:13:47,976 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:13:47,976 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:13:47,976 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:13:47,977 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:13:47,977 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:13:47,977 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:13:47,977 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:13:47,977 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:13:47,977 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:13:47,978 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:13:47,978 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:13:47,978 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:13:47,979 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:13:47,979 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:13:47,979 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:13:47,980 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:13:48,082 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:13:48,093 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.11s with 2 clusters.
2025-10-26 16:13:48,094 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_kmeans_predef_predefined.png
2025-10-26 16:13:48,096 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:13:48,097 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:13:48,216 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:13:48,573 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.48s with 2 clusters.
2025-10-26 16:13:48,574 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_som_predef_predefined.png
2025-10-26 16:13:48,574 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:13:48,575 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:13:48,676 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:13:50,370 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.80s with 6 clusters.
2025-10-26 16:13:50,371 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block1_dbscan_predefined.png
2025-10-26 16:13:50,371 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:13:50,718 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block1) k_type: predefined in  2.74 seconds
2025-10-26 16:13:50,719 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block1 in  92.65 seconds
2025-10-26 16:13:50,719 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block2 ---
2025-10-26 16:13:51,093 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block2
2025-10-26 16:13:51,093 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block2...
2025-10-26 16:13:51,094 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:13:51,094 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-26 16:13:51,125 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 4480x4480 to 512x512
2025-10-26 16:13:52,423 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:13:52,766 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 316 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:13:52,774 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:13:53,178 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:13:53,180 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:13:53,180 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:13:53,182 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-26 16:13:53,182 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block2) k_type: determined...
2025-10-26 16:13:53,183 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:13:53,183 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:13:53,183 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:13:53,183 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:13:53,183 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:13:53,183 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:13:53,183 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:13:53,184 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:13:53,184 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:13:53,184 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:13:53,184 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:13:53,184 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:13:53,184 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:13:53,185 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:13:53,185 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:13:53,185 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:13:53,185 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:13:53,185 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:13:53,186 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:13:53,186 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:13:53,297 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:13:53,329 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-26 16:13:53,330 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:13:53,331 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:13:55,188 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:13:57,026 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:13:58,876 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:14:00,713 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:14:02,485 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.547)
2025-10-26 16:14:02,485 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 3
2025-10-26 16:14:02,508 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.32s with 3 clusters.
2025-10-26 16:14:02,510 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_kmeans_opt_determined.png
2025-10-26 16:14:02,510 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:14:02,511 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:14:02,649 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-26 16:14:02,650 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:14:02,651 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:14:04,483 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:14:06,333 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:14:08,189 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:14:10,019 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:14:11,799 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.507)
2025-10-26 16:14:11,799 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=3
2025-10-26 16:14:12,126 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.61s with 3 clusters.
2025-10-26 16:14:12,127 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_som_opt_determined.png
2025-10-26 16:14:12,127 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:14:12,128 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:14:12,229 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:15:06,798 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-26 16:15:08,620 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 56.49s with 2 clusters.
2025-10-26 16:15:08,621 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_dbscan_determined.png
2025-10-26 16:15:08,622 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:15:08,946 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block2) k_type: determined in  75.76 seconds
2025-10-26 16:15:08,946 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block2) k_type: predefined...
2025-10-26 16:15:08,947 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:15:08,947 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:15:08,947 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:15:08,947 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:15:08,947 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:15:08,947 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:15:08,948 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:15:08,948 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:15:08,948 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:15:08,948 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:15:08,948 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:15:08,948 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:15:08,948 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:15:08,949 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:15:08,949 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:15:08,949 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:15:08,949 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:15:08,949 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:15:08,950 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:15:08,950 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:15:09,044 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:15:09,054 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.10s with 2 clusters.
2025-10-26 16:15:09,055 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_kmeans_predef_predefined.png
2025-10-26 16:15:09,056 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:15:09,056 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:15:09,196 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:15:09,600 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.54s with 2 clusters.
2025-10-26 16:15:09,601 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_som_predef_predefined.png
2025-10-26 16:15:09,602 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:15:09,602 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:15:09,715 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:15:11,677 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 2.07s with 6 clusters.
2025-10-26 16:15:11,678 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block2_dbscan_predefined.png
2025-10-26 16:15:11,679 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:15:12,031 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block2) k_type: predefined in  3.08 seconds
2025-10-26 16:15:12,031 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block2 in  80.94 seconds
2025-10-26 16:15:12,032 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block3 ---
2025-10-26 16:15:12,247 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block3
2025-10-26 16:15:12,248 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block3...
2025-10-26 16:15:12,248 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:15:12,248 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3477, 3477, 3)
2025-10-26 16:15:12,271 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3477x3477 to 511x511
2025-10-26 16:15:13,526 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:15:13,847 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 358 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:15:13,856 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:15:14,260 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:15:14,262 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:15:14,262 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:15:14,264 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-26 16:15:14,264 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block3) k_type: determined...
2025-10-26 16:15:14,265 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:15:14,265 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:15:14,265 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:15:14,265 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:15:14,265 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:15:14,265 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:15:14,266 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:15:14,266 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:15:14,266 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:15:14,266 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:15:14,266 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:15:14,266 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:15:14,266 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:15:14,267 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:15:14,267 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:15:14,267 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:15:14,267 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:15:14,267 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:15:14,268 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:15:14,268 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:15:14,362 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:15:14,397 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:15:14,398 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:15:14,399 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:15:16,233 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:15:18,057 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:15:19,891 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:15:21,672 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:15:23,446 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 2 (score: 0.760)
2025-10-26 16:15:23,446 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:15:23,455 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.19s with 2 clusters.
2025-10-26 16:15:23,457 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_kmeans_opt_determined.png
2025-10-26 16:15:23,457 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:15:23,458 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:15:23,580 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:15:23,581 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:15:23,582 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:15:25,459 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:15:27,275 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:15:29,112 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:15:30,904 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:15:32,682 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 6 (score: 0.640)
2025-10-26 16:15:32,682 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=6
2025-10-26 16:15:33,024 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.57s with 6 clusters.
2025-10-26 16:15:33,026 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_som_opt_determined.png
2025-10-26 16:15:33,026 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:15:33,027 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:15:33,137 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:16:30,376 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=20, min=10
2025-10-26 16:16:32,005 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 58.98s with 2 clusters.
2025-10-26 16:16:32,007 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_dbscan_determined.png
2025-10-26 16:16:32,007 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:16:32,364 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block3) k_type: determined in  78.10 seconds
2025-10-26 16:16:32,364 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block3) k_type: predefined...
2025-10-26 16:16:32,365 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:16:32,365 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:16:32,365 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:16:32,365 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:16:32,365 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:16:32,365 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:16:32,366 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:16:32,366 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:16:32,366 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:16:32,366 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:16:32,366 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:16:32,366 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:16:32,367 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:16:32,367 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:16:32,367 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:16:32,367 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:16:32,368 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:16:32,368 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:16:32,368 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:16:32,369 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:16:32,491 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:16:32,501 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.13s with 2 clusters.
2025-10-26 16:16:32,503 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_kmeans_predef_predefined.png
2025-10-26 16:16:32,503 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:16:32,504 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:16:32,637 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:16:33,000 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.50s with 2 clusters.
2025-10-26 16:16:33,001 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_som_predef_predefined.png
2025-10-26 16:16:33,001 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:16:33,002 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:16:33,106 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:16:34,538 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.54s with 8 clusters.
2025-10-26 16:16:34,540 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block3_dbscan_predefined.png
2025-10-26 16:16:34,541 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:16:34,906 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block3) k_type: predefined in  2.54 seconds
2025-10-26 16:16:34,906 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block3 in  82.66 seconds
2025-10-26 16:16:34,907 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block4 ---
2025-10-26 16:16:35,137 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block4
2025-10-26 16:16:35,138 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block4...
2025-10-26 16:16:35,138 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:16:35,138 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3622, 3622, 3)
2025-10-26 16:16:35,162 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3622x3622 to 512x512
2025-10-26 16:16:36,442 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:16:36,774 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 258 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:16:36,784 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:16:37,166 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:16:37,167 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:16:37,168 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:16:37,169 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-26 16:16:37,169 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block4) k_type: determined...
2025-10-26 16:16:37,170 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:16:37,170 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:16:37,170 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:16:37,170 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:16:37,170 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:16:37,171 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:16:37,171 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:16:37,171 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:16:37,171 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:16:37,171 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:16:37,171 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:16:37,171 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:16:37,172 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:16:37,172 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:16:37,172 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:16:37,172 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:16:37,173 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:16:37,173 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:16:37,173 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:16:37,174 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:16:37,270 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:16:37,288 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:16:37,289 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:16:37,291 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:16:39,118 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:16:40,997 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:16:42,883 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:16:44,764 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:16:46,592 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.545)
2025-10-26 16:16:46,593 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 3
2025-10-26 16:16:46,610 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.44s with 3 clusters.
2025-10-26 16:16:46,612 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_kmeans_opt_determined.png
2025-10-26 16:16:46,612 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:16:46,613 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:16:46,727 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 50. Adjusted k-range: [2, 6]
2025-10-26 16:16:46,727 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:16:46,728 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:16:48,575 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:16:50,426 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:16:52,298 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:16:54,133 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:16:56,010 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 3 (score: 0.580)
2025-10-26 16:16:56,011 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=3
2025-10-26 16:16:56,350 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.74s with 3 clusters.
2025-10-26 16:16:56,351 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_som_opt_determined.png
2025-10-26 16:16:56,351 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:16:56,352 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:16:56,459 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:17:34,987 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=10, min=20
2025-10-26 16:17:36,697 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 40.34s with 3 clusters.
2025-10-26 16:17:36,698 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_dbscan_determined.png
2025-10-26 16:17:36,699 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:17:37,181 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block4) k_type: determined in  60.01 seconds
2025-10-26 16:17:37,181 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block4) k_type: predefined...
2025-10-26 16:17:37,182 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:17:37,182 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:17:37,182 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:17:37,182 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:17:37,182 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:17:37,183 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:17:37,183 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:17:37,184 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:17:37,184 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:17:37,184 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:17:37,184 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:17:37,184 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:17:37,185 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:17:37,185 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:17:37,185 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:17:37,185 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:17:37,185 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:17:37,186 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:17:37,186 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:17:37,186 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:17:37,300 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:17:37,312 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.13s with 2 clusters.
2025-10-26 16:17:37,314 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_kmeans_predef_predefined.png
2025-10-26 16:17:37,314 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:17:37,315 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:17:37,451 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:17:37,798 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.48s with 2 clusters.
2025-10-26 16:17:37,799 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_som_predef_predefined.png
2025-10-26 16:17:37,799 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:17:37,800 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:17:37,907 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:17:39,674 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.87s with 6 clusters.
2025-10-26 16:17:39,676 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block4_dbscan_predefined.png
2025-10-26 16:17:39,676 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:17:40,036 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block4) k_type: predefined in  2.85 seconds
2025-10-26 16:17:40,037 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block4 in  64.90 seconds
2025-10-26 16:17:40,037 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block5 ---
2025-10-26 16:17:40,290 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: block5
2025-10-26 16:17:40,290 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block5...
2025-10-26 16:17:40,290 - src.data.preprocess - DEBUG - __init__:48 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0)
2025-10-26 16:17:40,290 - src.data.preprocess - INFO - preprocess:140 - Starting preprocessing for image with shape: (3504, 3504, 3)
2025-10-26 16:17:40,313 - src.data.preprocess - INFO - preprocess:153 - Initial resize from 3504x3504 to 512x512
2025-10-26 16:17:41,706 - src.data.preprocess - INFO - preprocess:157 - Applied non-local means denoising with h=10
2025-10-26 16:17:42,056 - src.data.preprocess - INFO - estimate_n_colors:64 - Estimated 307 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 16:17:42,073 - src.data.preprocess - DEBUG - quantize_image:80 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 16:17:42,475 - src.data.preprocess - INFO - quantize_image:106 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 16:17:42,476 - src.data.preprocess - INFO - preprocess:176 - Resized to target size (128, 128)
2025-10-26 16:17:42,476 - src.data.preprocess - INFO - preprocess:178 - Preprocessing completed
2025-10-26 16:17:42,478 - root - INFO - save_preprocessed_image:90 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-26 16:17:42,478 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block5) k_type: determined...
2025-10-26 16:17:42,479 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 16:17:42,479 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:17:42,479 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 16:17:42,479 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 16:17:42,479 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 16:17:42,479 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 16:17:42,480 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:17:42,480 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:17:42,481 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 16:17:42,481 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:17:42,481 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 16:17:42,482 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 16:17:42,482 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:17:42,589 - src.models.segmentation.kmeans - DEBUG - segment:64 - KMeans: Determining optimal k...
2025-10-26 16:17:42,633 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-26 16:17:42,633 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:17:42,635 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:17:44,470 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:17:46,322 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:17:48,172 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:17:49,991 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:17:51,761 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 2 (score: 0.572)
2025-10-26 16:17:51,762 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:17:51,770 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 9.29s with 2 clusters.
2025-10-26 16:17:51,771 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_kmeans_opt_determined.png
2025-10-26 16:17:51,772 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 16:17:51,772 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:17:51,912 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 49. Adjusted k-range: [2, 6]
2025-10-26 16:17:51,912 - src.models.segmentation.strategy - INFO - determine_k:68 - Subsampling pixels for cluster analysis efficiency
2025-10-26 16:17:51,914 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=2 for cluster metrics...
2025-10-26 16:17:53,767 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=3 for cluster metrics...
2025-10-26 16:17:55,611 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=4 for cluster metrics...
2025-10-26 16:17:57,461 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=5 for cluster metrics...
2025-10-26 16:17:59,320 - src.models.segmentation.strategy - INFO - determine_k:88 - Testing k=6 for cluster metrics...
2025-10-26 16:18:01,106 - src.models.segmentation.strategy - INFO - determine_k:125 - Optimal k determined: 6 (score: 0.515)
2025-10-26 16:18:01,106 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=6
2025-10-26 16:18:01,437 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 9.67s with 6 clusters.
2025-10-26 16:18:01,439 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_som_opt_determined.png
2025-10-26 16:18:01,439 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:18:01,439 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:18:01,545 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 16:18:57,396 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15, min=5
2025-10-26 16:18:59,217 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 57.78s with 3 clusters.
2025-10-26 16:18:59,218 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_dbscan_determined.png
2025-10-26 16:18:59,219 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 16:18:59,577 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block5) k_type: determined in  77.10 seconds
2025-10-26 16:18:59,578 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block5) k_type: predefined...
2025-10-26 16:18:59,578 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 16:18:59,578 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 16:18:59,578 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 16:18:59,578 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 16:18:59,578 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 16:18:59,579 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 16:18:59,579 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 16:18:59,579 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 16:18:59,579 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 16:18:59,579 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 16:18:59,579 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 16:18:59,580 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 16:18:59,580 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 16:18:59,580 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 16:18:59,580 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 16:18:59,581 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 16:18:59,581 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 16:18:59,581 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 16:18:59,582 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 16:18:59,582 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:18:59,689 - src.models.segmentation.kmeans - INFO - segment:68 - KMeans: Using k = 2
2025-10-26 16:18:59,699 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.12s with 2 clusters.
2025-10-26 16:18:59,701 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_kmeans_predef_predefined.png
2025-10-26 16:18:59,702 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 16:18:59,703 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:18:59,845 - src.models.segmentation.som - INFO - segment:73 - Running SOM segmentation with k=2
2025-10-26 16:19:00,240 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.54s with 2 clusters.
2025-10-26 16:19:00,242 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_som_predef_predefined.png
2025-10-26 16:19:00,242 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 16:19:00,242 - src.models.segmentation.base - INFO - quantize_image:191 - Quantizing image (shape: (128, 128, 3)) to approx 50 colors
2025-10-26 16:19:00,350 - src.models.segmentation.dbscan - INFO - segment:119 - Using predefined DBSCAN.
2025-10-26 16:19:02,160 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.92s with 6 clusters.
2025-10-26 16:19:02,161 - root - INFO - save_segmentation_result:101 - Saved segmented image to datasets\block\processed\segmented\block5_dbscan_predefined.png
2025-10-26 16:19:02,162 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 16:19:02,500 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block5) k_type: predefined in  2.92 seconds
2025-10-26 16:19:02,500 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block5 in  82.21 seconds
2025-10-26 16:19:02,501 - root - DEBUG - set_current_image_stem:53 - Current image stem set to: None
2025-10-26 16:19:02,501 - src.pipeline - INFO - _run_test_image_analysis:278 - Test image analysis loop finished.
2025-10-26 16:19:02,505 - src.pipeline - INFO - timer:48 - Completed: Test Image Analysis Loop in  404.73 seconds
2025-10-26 16:19:02,506 - src.pipeline - INFO - timer:43 - Starting: Saving Final Results...
2025-10-26 16:19:02,506 - src.pipeline - INFO - _save_and_summarize_results:416 - Saving 30 total Delta E results to CSV...
2025-10-26 16:19:02,520 - root - INFO - save_delta_e_results:115 - Saved Delta E results (30 entries) to datasets\block\analysis\_block_delta_e_results.csv
2025-10-26 16:19:02,521 - src.pipeline - INFO - _save_and_summarize_results:424 - --- Overall Results Summary ---
2025-10-26 16:19:02,547 - src.pipeline - INFO - _save_and_summarize_results:433 - 
   method  avg_traditional_delta_e  avg_pso_dbn_delta_e  avg_processing_time
0  dbscan                    3.153                6.856               28.996
1  kmeans                    2.744                6.599                4.726
2     som                    3.179                6.466                5.173
2025-10-26 16:19:02,547 - src.pipeline - INFO - _save_and_summarize_results:436 - --- Detailed Results by k_type ---
2025-10-26 16:19:02,561 - src.pipeline - INFO - _save_and_summarize_results:444 - 
   method      k_type  avg_traditional_delta_e  avg_pso_dbn_delta_e  avg_processing_time  avg_n_clusters
0  dbscan  determined                    2.678                6.432               56.152           2.400
1  dbscan  predefined                    3.628                7.280                1.840           6.400
2  kmeans  determined                    3.146                6.731                9.334           2.600
3  kmeans  predefined                    2.342                6.468                0.118           2.000
4     som  determined                    2.673                6.366                9.839           4.200
5     som  predefined                    3.686                6.566                0.507           2.000
2025-10-26 16:19:02,562 - src.pipeline - INFO - _save_and_summarize_results:445 - --- End of Summary ---
2025-10-26 16:19:02,562 - src.pipeline - INFO - timer:48 - Completed: Saving Final Results in  0.06 seconds
2025-10-26 16:19:02,562 - src.pipeline - INFO - timer:48 - Completed: Total Pipeline in  557.88 seconds
2025-10-26 16:19:02,563 - src.pipeline - INFO - run:127 - ==================================================
2025-10-26 16:19:02,563 - src.pipeline - INFO - run:128 - Processing Pipeline RUN completed for: block
2025-10-26 16:19:02,563 - src.pipeline - INFO - run:129 - ==================================================
2025-10-26 16:19:02,564 - root - INFO - main:69 - Main execution finished successfully.
2025-10-26 16:19:02,564 - root - INFO - main:75 - ================================================================================
PROCESSING COMPLETED IN 557.91 SECONDS
================================================================================
2025-10-26 18:03:21,382 - root - INFO - setup_logging:82 - Logging setup complete. Level: INFO. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-26 18:03:21,382 - src.pipeline - INFO - _load_and_validate_config:86 - loading the config from: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-26 18:03:21,392 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from C:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-26 18:03:21,395 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-26 18:03:21,395 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-26 18:03:21,396 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-26 18:03:21,396 - src.utils.setup - DEBUG - validate_processing_config:110 - Entering configuration validation...
2025-10-26 18:03:21,396 - src.utils.setup - ERROR - validate_processing_config:196 - Configuration validation failed: Missing required keys within 'segmentation_params': ['distance_threshold']
2025-10-26 18:03:21,397 - root - CRITICAL - main:72 - An unexpected error occurred in main execution: Processing config validation failed
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\main.py", line 61, in main
    pipeline = ProcessingPipeline(
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 70, in __init__
    self.config : Dict[str, Any] = self._load_and_validate_config()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 92, in _load_and_validate_config
    raise ValueError("Processing config validation failed")
ValueError: Processing config validation failed
2025-10-26 18:03:21,400 - root - INFO - main:75 - ================================================================================
PROCESSING COMPLETED IN 0.02 SECONDS
================================================================================
2025-10-26 18:09:57,701 - root - INFO - setup_logging:82 - Logging setup complete. Level: INFO. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-26 18:09:57,702 - src.pipeline - INFO - _load_and_validate_config:86 - loading the config from: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-26 18:09:57,712 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from C:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-26 18:09:57,715 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-26 18:09:57,715 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-26 18:09:57,716 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-26 18:09:57,716 - src.utils.setup - DEBUG - validate_processing_config:110 - Entering configuration validation...
2025-10-26 18:09:57,717 - src.utils.setup - DEBUG - validate_processing_config:151 - Reference image path validated: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 18:09:57,719 - src.utils.setup - DEBUG - validate_processing_config:171 - Validated 5 test image paths.
2025-10-26 18:09:57,719 - src.utils.setup - INFO - validate_processing_config:189 - Configuration validation passed successfully.
2025-10-26 18:09:57,724 - src.utils.output_manager - INFO - __init__:24 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-26 18:09:57,725 - src.pipeline - INFO - _load_and_validate_config:97 - OutputManager intialized for dataset: block
2025-10-26 18:09:57,725 - src.pipeline - INFO - run:102 - ==================================================
2025-10-26 18:09:57,725 - src.pipeline - INFO - run:103 - Processing Pipeline RUN starting for dataset: block
2025-10-26 18:09:57,726 - src.pipeline - INFO - run:104 - ==================================================
2025-10-26 18:09:57,726 - src.pipeline - INFO - timer:43 - Starting: Total Pipeline...
2025-10-26 18:09:57,726 - src.pipeline - INFO - timer:43 - Starting: DBN Training...
2025-10-26 18:09:57,727 - src.pipeline - INFO - _train_dbn_model:140 - loading images to generate training data...
2025-10-26 18:09:58,418 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-26 18:09:59,345 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-26 18:09:59,823 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-26 18:10:00,364 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-26 18:10:00,900 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-26 18:10:00,901 - src.pipeline - INFO - _train_dbn_model:152 - loading and processing 5 images into training data...
2025-10-26 18:10:00,901 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-26 18:10:03,078 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-26 18:10:03,078 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-26 18:10:03,082 - src.pipeline - INFO - _train_dbn_model:160 - initializing DBNTrainer (Samples  = 800...)
2025-10-26 18:10:03,082 - src.models.dbn_trainer - INFO - __init__:36 - DBNTrainer initialized.
2025-10-26 18:10:03,082 - src.models.dbn_trainer - INFO - train:52 - Starting DBN training and PSO optimization process...
2025-10-26 18:10:03,083 - src.data.sampling - INFO - efficient_data_sampling:53 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-26 18:10:03,084 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 1
2025-10-26 18:10:03,084 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 2
2025-10-26 18:10:03,084 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 3
2025-10-26 18:10:03,085 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 4
2025-10-26 18:10:03,085 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 5
2025-10-26 18:10:03,086 - src.data.sampling - INFO - efficient_data_sampling:129 - Sampling completed: 800 samples extracted.
2025-10-26 18:10:03,086 - src.data.sampling - INFO - efficient_data_sampling:130 - RGB range: [32.00, 214.00]
2025-10-26 18:10:03,087 - src.data.sampling - INFO - efficient_data_sampling:131 - LAB ranges: L[12.16, 84.31], a[-2.00, 2.00], b[-2.00, 8.00]
2025-10-26 18:10:03,088 - src.models.dbn_trainer - INFO - train:65 - Training set: (640, 3), Test set: (160, 3)
2025-10-26 18:10:03,088 - src.models.dbn_trainer - INFO - _prepare_scalers:97 - Preparing and fitting scalers...
2025-10-26 18:10:03,091 - src.models.dbn_trainer - INFO - _prepare_scalers:116 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-26 18:10:03,092 - src.models.dbn_trainer - INFO - _prepare_scalers:117 - X range: [0.000, 1.000]
2025-10-26 18:10:03,092 - src.models.dbn_trainer - INFO - _prepare_scalers:118 - Y range: [0.000, 1.000]
2025-10-26 18:10:03,092 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-26 18:10:03,308 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-26 18:10:03,355 - src.models.dbn_trainer - INFO - train:76 - Initial model has 20 weight layers
2025-10-26 18:10:03,356 - src.models.dbn_trainer - INFO - train:78 - Layer 0: shape (3, 100), range [-0.239, 0.241]
2025-10-26 18:10:03,356 - src.models.dbn_trainer - INFO - train:78 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-26 18:10:03,357 - src.models.dbn_trainer - INFO - train:78 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-26 18:10:03,357 - src.models.dbn_trainer - INFO - train:78 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-26 18:10:03,357 - src.models.dbn_trainer - INFO - train:78 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-26 18:10:03,358 - src.models.dbn_trainer - INFO - train:78 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-26 18:10:03,358 - src.models.dbn_trainer - INFO - train:78 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-26 18:10:03,358 - src.models.dbn_trainer - INFO - train:78 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-26 18:10:03,359 - src.models.dbn_trainer - INFO - train:78 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-26 18:10:03,359 - src.models.dbn_trainer - INFO - train:78 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-26 18:10:03,360 - src.models.dbn_trainer - INFO - train:78 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-26 18:10:03,360 - src.models.dbn_trainer - INFO - train:78 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-26 18:10:03,361 - src.models.dbn_trainer - INFO - train:78 - Layer 12: shape (50, 25), range [-0.282, 0.282]
2025-10-26 18:10:03,361 - src.models.dbn_trainer - INFO - train:78 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-26 18:10:03,361 - src.models.dbn_trainer - INFO - train:78 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-26 18:10:03,362 - src.models.dbn_trainer - INFO - train:78 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-26 18:10:03,362 - src.models.dbn_trainer - INFO - train:78 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-26 18:10:03,363 - src.models.dbn_trainer - INFO - train:78 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-26 18:10:03,363 - src.models.dbn_trainer - INFO - train:78 - Layer 18: shape (25, 3), range [-0.448, 0.455]
2025-10-26 18:10:03,364 - src.models.dbn_trainer - INFO - train:78 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-26 18:10:03,364 - src.models.dbn_trainer - INFO - _run_pso_with_retries:127 - PSO optimization attempt 1/3
2025-10-26 18:10:03,365 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-26 18:12:15,715 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 132.34s - Final fitness: 0.016664
2025-10-26 18:12:15,716 - src.models.dbn_trainer - INFO - _run_pso_with_retries:142 - PSO optimization completed successfully
2025-10-26 18:12:15,723 - src.models.dbn_trainer - INFO - train:84 - DBN training and PSO optimization complete.
2025-10-26 18:12:15,723 - src.pipeline - INFO - _train_dbn_model:164 - DBN training and scaling complete
2025-10-26 18:12:15,727 - src.pipeline - INFO - timer:48 - Completed: DBN Training in  138.00 seconds
2025-10-26 18:12:15,728 - src.pipeline - INFO - timer:43 - Starting: Reference Image Processing...
2025-10-26 18:12:15,729 - src.pipeline - INFO - _run_reference_processing:182 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 18:12:17,336 - root - INFO - save_reference_image:79 - Saved reference image copy to datasets\block\inputs\reference_image\reference.png
2025-10-26 18:12:17,336 - src.data.preprocess - DEBUG - __init__:45 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000)
2025-10-26 18:12:17,336 - src.data.preprocess - INFO - preprocess:137 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-26 18:12:17,370 - src.data.preprocess - INFO - preprocess:150 - Initial resize from 4480x4480 to 512x512
2025-10-26 18:12:18,718 - src.data.preprocess - INFO - preprocess:154 - Applied non-local means denoising with h=10
2025-10-26 18:12:19,097 - src.data.preprocess - INFO - estimate_n_colors:61 - Estimated 299 unique colors, setting n_colors to 8 (max_colors=8)
2025-10-26 18:12:19,105 - src.data.preprocess - DEBUG - quantize_image:77 - Subsampled pixels for K-means fit: (10000, 3)
2025-10-26 18:12:19,858 - src.data.preprocess - INFO - quantize_image:103 - Quantized to 8 target colors. Final unique colors: 8
2025-10-26 18:12:19,860 - src.data.preprocess - INFO - preprocess:173 - Resized to target size (128, 128)
2025-10-26 18:12:19,860 - src.data.preprocess - INFO - preprocess:175 - Preprocessing completed
2025-10-26 18:12:19,861 - src.models.segmentation.reference - INFO - segment_reference_image:58 - Starting reference image segmentation (K-Means & SOM)...
2025-10-26 18:12:19,861 - src.models.segmentation.reference - INFO - segment_reference_image:77 - Determining optimal number of clusters for reference image...
2025-10-26 18:12:19,862 - src.models.segmentation.reference - WARNING - segment_reference_image:100 - Could not quantize image for k-determination: 'SegmentationConfig' object has no attribute 'quantization_colors'. Using original pixels.
2025-10-26 18:12:19,878 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 151. Adjusted k-range: [2, 3]
2025-10-26 18:12:19,879 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 18:12:19,880 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 18:12:21,841 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 18:12:23,722 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 18:12:23,722 - src.models.segmentation.reference - INFO - segment_reference_image:105 - Optimal clusters determined for reference: 2
2025-10-26 18:12:23,723 - src.models.segmentation.reference - INFO - timer:182 - Starting: Reference K-Means (k=2)...
2025-10-26 18:12:23,723 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 18:12:23,724 - src.models.segmentation.kmeans - ERROR - segment:112 - Error during KMeans segmentation (kmeans_predef): 'SegmentationConfig' object has no attribute 'quantization_colors'
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\models\segmentation\kmeans.py", line 58, in segment
    quantized_img = self.quantize_image()
  File "C:\Users\LENOVO\Desktop\prints\src\models\segmentation\base.py", line 193, in quantize_image
    n_colors = self.config.quantization_colors # <-- Config'den al
AttributeError: 'SegmentationConfig' object has no attribute 'quantization_colors'
2025-10-26 18:12:23,726 - src.models.segmentation.reference - ERROR - segment_reference_image:145 - Reference K-Means segmentation failed or produced invalid result.
2025-10-26 18:12:23,727 - src.models.segmentation.reference - INFO - timer:187 - Completed: Reference K-Means (k=2) in 0.00 seconds
2025-10-26 18:12:23,727 - src.models.segmentation.reference - INFO - timer:182 - Starting: Reference SOM (k=2)...
2025-10-26 18:12:23,728 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 18:12:23,728 - src.models.segmentation.som - ERROR - segment:126 - Error during SOM segmentation (som_predef): 'SegmentationConfig' object has no attribute 'quantization_colors'
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\models\segmentation\som.py", line 57, in segment
    quantized_img = self.quantize_image()
  File "C:\Users\LENOVO\Desktop\prints\src\models\segmentation\base.py", line 193, in quantize_image
    n_colors = self.config.quantization_colors # <-- Config'den al
AttributeError: 'SegmentationConfig' object has no attribute 'quantization_colors'
2025-10-26 18:12:23,731 - src.models.segmentation.reference - ERROR - segment_reference_image:159 - Reference SOM segmentation failed or produced invalid result.
2025-10-26 18:12:23,731 - src.models.segmentation.reference - INFO - timer:187 - Completed: Reference SOM (k=2) in 0.00 seconds
2025-10-26 18:12:23,731 - src.models.segmentation.reference - INFO - segment_reference_image:171 - Reference segmentation finished in 3.87 seconds.
2025-10-26 18:12:24,926 - root - INFO - save_reference_summary:181 - Reference summary (placeholder) saved to datasets\block\summaries\reference_summary.png
2025-10-26 18:12:24,927 - src.pipeline - INFO - timer:48 - Completed: Reference Image Processing in  9.20 seconds
2025-10-26 18:12:24,927 - src.pipeline - INFO - timer:48 - Completed: Total Pipeline in  147.20 seconds
2025-10-26 18:12:24,928 - src.pipeline - CRITICAL - run:132 - Pipeline failed critically: Reference K-Means segmentation failed, cannot extract target colors.
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 113, in run
    target_colors_lab, ref_kmeans_result, ref_som_result = self._run_reference_processing()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 227, in _run_reference_processing
    raise ValueError("Reference K-Means segmentation failed, cannot extract target colors.")
ValueError: Reference K-Means segmentation failed, cannot extract target colors.
2025-10-26 18:12:24,930 - root - CRITICAL - main:72 - An unexpected error occurred in main execution: Reference K-Means segmentation failed, cannot extract target colors.
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\main.py", line 68, in main
    pipeline.run()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 113, in run
    target_colors_lab, ref_kmeans_result, ref_som_result = self._run_reference_processing()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 227, in _run_reference_processing
    raise ValueError("Reference K-Means segmentation failed, cannot extract target colors.")
ValueError: Reference K-Means segmentation failed, cannot extract target colors.
2025-10-26 18:12:24,937 - root - INFO - main:75 - ================================================================================
PROCESSING COMPLETED IN 147.24 SECONDS
================================================================================
2025-10-26 18:43:16,442 - root - INFO - setup_logging:82 - Logging setup complete. Level: INFO. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-26 18:43:16,442 - src.pipeline - INFO - _load_and_validate_config:86 - loading the config from: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-26 18:43:16,448 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from C:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-26 18:43:16,451 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-26 18:43:16,451 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-26 18:43:16,452 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-26 18:43:16,452 - src.utils.setup - DEBUG - validate_processing_config:110 - Entering configuration validation...
2025-10-26 18:43:16,453 - src.utils.setup - DEBUG - validate_processing_config:151 - Reference image path validated: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 18:43:16,455 - src.utils.setup - DEBUG - validate_processing_config:171 - Validated 5 test image paths.
2025-10-26 18:43:16,455 - src.utils.setup - INFO - validate_processing_config:189 - Configuration validation passed successfully.
2025-10-26 18:43:16,458 - src.utils.output_manager - INFO - __init__:24 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-26 18:43:16,458 - src.pipeline - INFO - _load_and_validate_config:97 - OutputManager intialized for dataset: block
2025-10-26 18:43:16,458 - src.pipeline - INFO - run:102 - ==================================================
2025-10-26 18:43:16,459 - src.pipeline - INFO - run:103 - Processing Pipeline RUN starting for dataset: block
2025-10-26 18:43:16,460 - src.pipeline - INFO - run:104 - ==================================================
2025-10-26 18:43:16,460 - src.pipeline - INFO - timer:43 - Starting: Total Pipeline...
2025-10-26 18:43:16,460 - src.pipeline - INFO - timer:43 - Starting: DBN Training...
2025-10-26 18:43:16,461 - src.pipeline - INFO - _train_dbn_model:140 - loading images to generate training data...
2025-10-26 18:43:17,099 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-26 18:43:17,932 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-26 18:43:18,381 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-26 18:43:18,873 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-26 18:43:19,378 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-26 18:43:19,378 - src.pipeline - INFO - _train_dbn_model:152 - loading and processing 5 images into training data...
2025-10-26 18:43:19,379 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-26 18:43:21,246 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-26 18:43:21,247 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-26 18:43:21,250 - src.pipeline - INFO - _train_dbn_model:160 - initializing DBNTrainer (Samples  = 800...)
2025-10-26 18:43:21,251 - src.models.dbn_trainer - INFO - __init__:36 - DBNTrainer initialized.
2025-10-26 18:43:21,251 - src.models.dbn_trainer - INFO - train:52 - Starting DBN training and PSO optimization process...
2025-10-26 18:43:21,251 - src.data.sampling - INFO - efficient_data_sampling:53 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-26 18:43:21,252 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 1
2025-10-26 18:43:21,253 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 2
2025-10-26 18:43:21,253 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 3
2025-10-26 18:43:21,254 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 4
2025-10-26 18:43:21,254 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 5
2025-10-26 18:43:21,255 - src.data.sampling - INFO - efficient_data_sampling:129 - Sampling completed: 800 samples extracted.
2025-10-26 18:43:21,255 - src.data.sampling - INFO - efficient_data_sampling:130 - RGB range: [31.00, 213.00]
2025-10-26 18:43:21,256 - src.data.sampling - INFO - efficient_data_sampling:131 - LAB ranges: L[11.76, 84.31], a[-2.00, 3.00], b[-1.00, 9.00]
2025-10-26 18:43:21,257 - src.models.dbn_trainer - INFO - train:65 - Training set: (640, 3), Test set: (160, 3)
2025-10-26 18:43:21,258 - src.models.dbn_trainer - INFO - _prepare_scalers:97 - Preparing and fitting scalers...
2025-10-26 18:43:21,262 - src.models.dbn_trainer - INFO - _prepare_scalers:116 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-26 18:43:21,263 - src.models.dbn_trainer - INFO - _prepare_scalers:117 - X range: [0.000, 1.000]
2025-10-26 18:43:21,263 - src.models.dbn_trainer - INFO - _prepare_scalers:118 - Y range: [0.000, 1.000]
2025-10-26 18:43:21,263 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-26 18:43:21,476 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-26 18:43:21,558 - src.models.dbn_trainer - INFO - train:76 - Initial model has 20 weight layers
2025-10-26 18:43:21,558 - src.models.dbn_trainer - INFO - train:78 - Layer 0: shape (3, 100), range [-0.241, 0.240]
2025-10-26 18:43:21,559 - src.models.dbn_trainer - INFO - train:78 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-26 18:43:21,559 - src.models.dbn_trainer - INFO - train:78 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-26 18:43:21,559 - src.models.dbn_trainer - INFO - train:78 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-26 18:43:21,560 - src.models.dbn_trainer - INFO - train:78 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-26 18:43:21,560 - src.models.dbn_trainer - INFO - train:78 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-26 18:43:21,560 - src.models.dbn_trainer - INFO - train:78 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-26 18:43:21,561 - src.models.dbn_trainer - INFO - train:78 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-26 18:43:21,561 - src.models.dbn_trainer - INFO - train:78 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-26 18:43:21,561 - src.models.dbn_trainer - INFO - train:78 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-26 18:43:21,562 - src.models.dbn_trainer - INFO - train:78 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-26 18:43:21,562 - src.models.dbn_trainer - INFO - train:78 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-26 18:43:21,562 - src.models.dbn_trainer - INFO - train:78 - Layer 12: shape (50, 25), range [-0.283, 0.282]
2025-10-26 18:43:21,563 - src.models.dbn_trainer - INFO - train:78 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-26 18:43:21,563 - src.models.dbn_trainer - INFO - train:78 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-26 18:43:21,563 - src.models.dbn_trainer - INFO - train:78 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-26 18:43:21,564 - src.models.dbn_trainer - INFO - train:78 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-26 18:43:21,564 - src.models.dbn_trainer - INFO - train:78 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-26 18:43:21,565 - src.models.dbn_trainer - INFO - train:78 - Layer 18: shape (25, 3), range [-0.457, 0.435]
2025-10-26 18:43:21,565 - src.models.dbn_trainer - INFO - train:78 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-26 18:43:21,565 - src.models.dbn_trainer - INFO - _run_pso_with_retries:127 - PSO optimization attempt 1/3
2025-10-26 18:43:21,566 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-26 18:45:20,194 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 118.62s - Final fitness: 0.052036
2025-10-26 18:45:20,195 - src.models.dbn_trainer - INFO - _run_pso_with_retries:142 - PSO optimization completed successfully
2025-10-26 18:45:20,201 - src.models.dbn_trainer - INFO - train:84 - DBN training and PSO optimization complete.
2025-10-26 18:45:20,201 - src.pipeline - INFO - _train_dbn_model:164 - DBN training and scaling complete
2025-10-26 18:45:20,205 - src.pipeline - INFO - timer:48 - Completed: DBN Training in  123.74 seconds
2025-10-26 18:45:20,205 - src.pipeline - INFO - timer:43 - Starting: Reference Image Processing...
2025-10-26 18:45:20,206 - src.pipeline - INFO - _run_reference_processing:182 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 18:45:21,757 - root - INFO - save_reference_image:79 - Saved reference image copy to datasets\block\inputs\reference_image\reference.png
2025-10-26 18:45:21,758 - src.data.preprocess - DEBUG - __init__:45 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, max_colors=8, edge_enhance=False, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000)
2025-10-26 18:45:21,758 - src.data.preprocess - INFO - preprocess:165 - Starting preprocessing for image with shape: (4480, 4480, 3)
2025-10-26 18:45:21,789 - src.data.preprocess - INFO - preprocess:178 - Initial resize from 4480x4480 to 512x512
2025-10-26 18:45:23,107 - src.data.preprocess - INFO - preprocess:182 - Applied non-local means denoising with h=10
2025-10-26 18:45:23,108 - src.data.preprocess - ERROR - wrapper:16 - Error in quantize_image: 'Preprocessor' object has no attribute 'config'
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\data\preprocess.py", line 13, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\LENOVO\Desktop\prints\src\data\preprocess.py", line 81, in quantize_image
    n_colors = self.config.quantization_colors # <-- Config'den al
AttributeError: 'Preprocessor' object has no attribute 'config'
2025-10-26 18:45:23,110 - src.data.preprocess - ERROR - preprocess:190 - Color quantization failed.
2025-10-26 18:45:23,110 - src.pipeline - ERROR - _run_reference_processing:200 - Preprocessing failed for reference image: Preprocessing returned None for reference image.
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 196, in _run_reference_processing
    raise ValueError("Preprocessing returned None for reference image.")
ValueError: Preprocessing returned None for reference image.
2025-10-26 18:45:23,112 - src.pipeline - INFO - timer:48 - Completed: Reference Image Processing in  2.91 seconds
2025-10-26 18:45:23,112 - src.pipeline - INFO - timer:48 - Completed: Total Pipeline in  126.65 seconds
2025-10-26 18:45:23,113 - src.pipeline - CRITICAL - run:132 - Pipeline failed critically: Preprocessing failed for reference: Preprocessing returned None for reference image.
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 196, in _run_reference_processing
    raise ValueError("Preprocessing returned None for reference image.")
ValueError: Preprocessing returned None for reference image.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 113, in run
    target_colors_lab, ref_kmeans_result, ref_som_result = self._run_reference_processing()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 201, in _run_reference_processing
    raise ValueError(f"Preprocessing failed for reference: {e}")
ValueError: Preprocessing failed for reference: Preprocessing returned None for reference image.
2025-10-26 18:45:23,115 - root - CRITICAL - main:72 - An unexpected error occurred in main execution: Preprocessing failed for reference: Preprocessing returned None for reference image.
Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 196, in _run_reference_processing
    raise ValueError("Preprocessing returned None for reference image.")
ValueError: Preprocessing returned None for reference image.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO\Desktop\prints\src\main.py", line 68, in main
    pipeline.run()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 113, in run
    target_colors_lab, ref_kmeans_result, ref_som_result = self._run_reference_processing()
  File "C:\Users\LENOVO\Desktop\prints\src\pipeline.py", line 201, in _run_reference_processing
    raise ValueError(f"Preprocessing failed for reference: {e}")
ValueError: Preprocessing failed for reference: Preprocessing returned None for reference image.
2025-10-26 18:45:23,127 - root - INFO - main:75 - ================================================================================
PROCESSING COMPLETED IN 126.69 SECONDS
================================================================================
2025-10-26 19:05:45,246 - root - INFO - setup_logging:82 - Logging setup complete. Level: INFO. Log file: C:\Users\LENOVO\Desktop\prints\output\processing.log
2025-10-26 19:05:45,246 - src.pipeline - INFO - _load_and_validate_config:86 - loading the config from: C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml
2025-10-26 19:05:45,253 - src.data.load_data - INFO - load_config:51 - Loaded default configuration from C:\Users\LENOVO\Desktop\prints\configurations\defaults.yaml
2025-10-26 19:05:45,256 - src.data.load_data - INFO - load_config:61 - Loading specific configuration from C:\Users\LENOVO\Desktop\prints\configurations\pattern_configs\block_config.yaml...
2025-10-26 19:05:45,257 - src.data.load_data - INFO - load_config:66 - Merged specific configuration over defaults.
2025-10-26 19:05:45,257 - src.data.load_data - INFO - load_config:77 - Configuration loaded successfully.
2025-10-26 19:05:45,258 - src.utils.setup - DEBUG - validate_processing_config:110 - Entering configuration validation...
2025-10-26 19:05:45,258 - src.utils.setup - DEBUG - validate_processing_config:151 - Reference image path validated: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 19:05:45,260 - src.utils.setup - DEBUG - validate_processing_config:171 - Validated 5 test image paths.
2025-10-26 19:05:45,260 - src.utils.setup - INFO - validate_processing_config:189 - Configuration validation passed successfully.
2025-10-26 19:05:45,262 - src.utils.output_manager - INFO - __init__:24 - OutputManager initialized for dataset 'block' at C:\Users\LENOVO\Desktop\prints\output\datasets\block
2025-10-26 19:05:45,262 - src.pipeline - INFO - _load_and_validate_config:97 - OutputManager intialized for dataset: block
2025-10-26 19:05:45,263 - src.pipeline - INFO - run:102 - ==================================================
2025-10-26 19:05:45,264 - src.pipeline - INFO - run:103 - Processing Pipeline RUN starting for dataset: block
2025-10-26 19:05:45,264 - src.pipeline - INFO - run:104 - ==================================================
2025-10-26 19:05:45,265 - src.pipeline - INFO - timer:43 - Starting: Total Pipeline...
2025-10-26 19:05:45,265 - src.pipeline - INFO - timer:43 - Starting: DBN Training...
2025-10-26 19:05:45,266 - src.pipeline - INFO - _train_dbn_model:140 - loading images to generate training data...
2025-10-26 19:05:45,900 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block1.jpg
2025-10-26 19:05:46,714 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block2.jpg
2025-10-26 19:05:47,160 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block3.jpg
2025-10-26 19:05:47,659 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block4.jpg
2025-10-26 19:05:48,157 - root - INFO - save_test_image:89 - Saved test image copy to datasets\block\inputs\test_images\block5.jpg
2025-10-26 19:05:48,158 - src.pipeline - INFO - _train_dbn_model:152 - loading and processing 5 images into training data...
2025-10-26 19:05:48,158 - src.data.load_data - INFO - load_data:150 - Processing 5 images for training data...
2025-10-26 19:05:50,022 - src.data.load_data - INFO - load_data:184 - Successfully loaded and processed 5/5 images.
2025-10-26 19:05:50,023 - src.data.load_data - INFO - load_data:185 - rgb_data shape: (5, 30000), lab_data shape: (5, 30000)
2025-10-26 19:05:50,026 - src.pipeline - INFO - _train_dbn_model:160 - initializing DBNTrainer (Samples  = 800...)
2025-10-26 19:05:50,027 - src.models.dbn_trainer - INFO - __init__:36 - DBNTrainer initialized.
2025-10-26 19:05:50,027 - src.models.dbn_trainer - INFO - train:52 - Starting DBN training and PSO optimization process...
2025-10-26 19:05:50,028 - src.data.sampling - INFO - efficient_data_sampling:53 - Sampling 800 total samples from flattened data, max 160 per image
2025-10-26 19:05:50,029 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 1
2025-10-26 19:05:50,029 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 2
2025-10-26 19:05:50,029 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 3
2025-10-26 19:05:50,030 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 4
2025-10-26 19:05:50,030 - src.data.sampling - DEBUG - efficient_data_sampling:74 - Planning to sample 160 pixels from image 5
2025-10-26 19:05:50,031 - src.data.sampling - INFO - efficient_data_sampling:129 - Sampling completed: 800 samples extracted.
2025-10-26 19:05:50,031 - src.data.sampling - INFO - efficient_data_sampling:130 - RGB range: [31.00, 213.00]
2025-10-26 19:05:50,032 - src.data.sampling - INFO - efficient_data_sampling:131 - LAB ranges: L[11.76, 84.31], a[-2.00, 2.00], b[-1.00, 9.00]
2025-10-26 19:05:50,033 - src.models.dbn_trainer - INFO - train:65 - Training set: (640, 3), Test set: (160, 3)
2025-10-26 19:05:50,034 - src.models.dbn_trainer - INFO - _prepare_scalers:97 - Preparing and fitting scalers...
2025-10-26 19:05:50,036 - src.models.dbn_trainer - INFO - _prepare_scalers:116 - Scaled training data - X: (640, 3), Y: (640, 3)
2025-10-26 19:05:50,037 - src.models.dbn_trainer - INFO - _prepare_scalers:117 - X range: [0.000, 1.000]
2025-10-26 19:05:50,037 - src.models.dbn_trainer - INFO - _prepare_scalers:118 - Y range: [0.000, 1.000]
2025-10-26 19:05:50,038 - src.models.pso_dbn - INFO - __init__:89 - Initializing DBN with architecture: 3 -> [100, 50, 25] -> 3
2025-10-26 19:05:50,234 - src.models.pso_dbn - INFO - _build_model:141 - DBN model built with 7503 parameters
2025-10-26 19:05:50,278 - src.models.dbn_trainer - INFO - train:76 - Initial model has 20 weight layers
2025-10-26 19:05:50,279 - src.models.dbn_trainer - INFO - train:78 - Layer 0: shape (3, 100), range [-0.239, 0.241]
2025-10-26 19:05:50,279 - src.models.dbn_trainer - INFO - train:78 - Layer 1: shape (100,), range [0.000, 0.000]
2025-10-26 19:05:50,279 - src.models.dbn_trainer - INFO - train:78 - Layer 2: shape (100,), range [1.000, 1.000]
2025-10-26 19:05:50,280 - src.models.dbn_trainer - INFO - train:78 - Layer 3: shape (100,), range [0.000, 0.000]
2025-10-26 19:05:50,280 - src.models.dbn_trainer - INFO - train:78 - Layer 4: shape (100,), range [0.000, 0.000]
2025-10-26 19:05:50,281 - src.models.dbn_trainer - INFO - train:78 - Layer 5: shape (100,), range [1.000, 1.000]
2025-10-26 19:05:50,281 - src.models.dbn_trainer - INFO - train:78 - Layer 6: shape (100, 50), range [-0.200, 0.200]
2025-10-26 19:05:50,281 - src.models.dbn_trainer - INFO - train:78 - Layer 7: shape (50,), range [0.000, 0.000]
2025-10-26 19:05:50,281 - src.models.dbn_trainer - INFO - train:78 - Layer 8: shape (50,), range [1.000, 1.000]
2025-10-26 19:05:50,282 - src.models.dbn_trainer - INFO - train:78 - Layer 9: shape (50,), range [0.000, 0.000]
2025-10-26 19:05:50,282 - src.models.dbn_trainer - INFO - train:78 - Layer 10: shape (50,), range [0.000, 0.000]
2025-10-26 19:05:50,282 - src.models.dbn_trainer - INFO - train:78 - Layer 11: shape (50,), range [1.000, 1.000]
2025-10-26 19:05:50,282 - src.models.dbn_trainer - INFO - train:78 - Layer 12: shape (50, 25), range [-0.283, 0.283]
2025-10-26 19:05:50,283 - src.models.dbn_trainer - INFO - train:78 - Layer 13: shape (25,), range [0.000, 0.000]
2025-10-26 19:05:50,283 - src.models.dbn_trainer - INFO - train:78 - Layer 14: shape (25,), range [1.000, 1.000]
2025-10-26 19:05:50,284 - src.models.dbn_trainer - INFO - train:78 - Layer 15: shape (25,), range [0.000, 0.000]
2025-10-26 19:05:50,284 - src.models.dbn_trainer - INFO - train:78 - Layer 16: shape (25,), range [0.000, 0.000]
2025-10-26 19:05:50,284 - src.models.dbn_trainer - INFO - train:78 - Layer 17: shape (25,), range [1.000, 1.000]
2025-10-26 19:05:50,285 - src.models.dbn_trainer - INFO - train:78 - Layer 18: shape (25, 3), range [-0.447, 0.454]
2025-10-26 19:05:50,285 - src.models.dbn_trainer - INFO - train:78 - Layer 19: shape (3,), range [0.000, 0.000]
2025-10-26 19:05:50,285 - src.models.dbn_trainer - INFO - _run_pso_with_retries:127 - PSO optimization attempt 1/3
2025-10-26 19:05:50,286 - src.models.pso_dbn - INFO - optimize:253 - Starting PSO optimization with config: {'swarmsize': 20, 'maxiter': 50, 'w': 0.7, 'c1': 2.0, 'c2': 2.0}
2025-10-26 19:07:50,318 - src.models.pso_dbn - INFO - optimize:326 - PSO optimization completed in 120.03s - Final fitness: 0.035296
2025-10-26 19:07:50,319 - src.models.dbn_trainer - INFO - _run_pso_with_retries:142 - PSO optimization completed successfully
2025-10-26 19:07:50,324 - src.models.dbn_trainer - INFO - train:84 - DBN training and PSO optimization complete.
2025-10-26 19:07:50,325 - src.pipeline - INFO - _train_dbn_model:164 - DBN training and scaling complete
2025-10-26 19:07:50,328 - src.pipeline - INFO - timer:48 - Completed: DBN Training in  125.06 seconds
2025-10-26 19:07:50,329 - src.pipeline - INFO - timer:43 - Starting: Reference Image Processing...
2025-10-26 19:07:50,329 - src.pipeline - INFO - _run_reference_processing:182 - Processing reference image: C:\Users\LENOVO\Desktop\prints\dataset\block\reference.jpg
2025-10-26 19:07:51,883 - root - INFO - save_reference_image:79 - Saved reference image copy to datasets\block\inputs\reference_image\reference.png
2025-10-26 19:07:51,884 - src.data.preprocess - DEBUG - __init__:51 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000, unsharp_blur_kernel_size=[5, 5], unsharp_blur_sigma=1.0)
2025-10-26 19:07:51,884 - src.data.preprocess - INFO - preprocess:219 - Starting preprocessing pipeline for image with shape: (4480, 4480, 3)
2025-10-26 19:07:51,913 - src.data.preprocess - INFO - preprocess:231 - Initial resize from 4480x4480 to 512x512
2025-10-26 19:07:53,159 - src.data.preprocess - INFO - preprocess:239 - Applied non-local means denoising with h=10
2025-10-26 19:07:53,159 - src.data.preprocess - DEBUG - unsharp_mask:201 - Unsharp mask amount is zero or less, skipping.
2025-10-26 19:07:53,159 - src.data.preprocess - DEBUG - _estimate_n_colors:75 - Subsampling pixels (262144) for unique color estimation.
2025-10-26 19:07:53,234 - src.data.preprocess - INFO - _estimate_n_colors:84 - Estimated 243 unique colors. Target quantization colors: 50 (Config limit: 50)
2025-10-26 19:07:53,235 - src.data.preprocess - INFO - quantize_image:116 - Quantizing image (shape: (512, 512, 3)) to approx 50 colors
2025-10-26 19:07:53,236 - src.data.preprocess - DEBUG - quantize_image:137 - Subsampling 262144 pixels to 20000 for K-Means fitting.
2025-10-26 19:07:54,068 - src.data.preprocess - INFO - quantize_image:157 - Quantization complete. Final unique colors: 50 (target was 50)
2025-10-26 19:07:54,070 - src.data.preprocess - INFO - preprocess:262 - Final resize to target size (128, 128)
2025-10-26 19:07:54,071 - src.data.preprocess - INFO - preprocess:267 - Preprocessing pipeline completed successfully.
2025-10-26 19:07:54,071 - src.models.segmentation.reference - INFO - segment_reference_image:78 - Starting reference image segmentation (K-Means & SOM)...
2025-10-26 19:07:54,071 - src.models.segmentation.reference - INFO - segment_reference_image:95 - Determining optimal number of clusters for reference image...
2025-10-26 19:07:54,072 - src.models.segmentation.reference - INFO - segment_reference_image:113 - Subsampling 16384 pixels to 10000 for reference k-determination
2025-10-26 19:07:54,082 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 246. Adjusted k-range: [2, 3]
2025-10-26 19:07:54,083 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:07:55,908 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:07:57,676 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:07:57,676 - src.models.segmentation.reference - INFO - segment_reference_image:120 - Optimal clusters determined for reference: 2
2025-10-26 19:07:57,676 - src.models.segmentation.reference - INFO - timer:36 - Starting: Reference K-Means (k=2)...
2025-10-26 19:07:57,677 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 19:07:57,677 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:07:57,685 - src.models.segmentation.reference - INFO - timer:41 - Completed: Reference K-Means (k=2) in 0.01 seconds
2025-10-26 19:07:57,686 - src.models.segmentation.reference - INFO - timer:36 - Starting: Reference SOM (k=2)...
2025-10-26 19:07:57,686 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 19:07:57,686 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:07:57,993 - src.models.segmentation.reference - INFO - timer:41 - Completed: Reference SOM (k=2) in 0.31 seconds
2025-10-26 19:07:57,993 - src.models.segmentation.reference - INFO - segment_reference_image:179 - Reference segmentation (KMeans, SOM, k-determination) finished in 3.92 seconds.
2025-10-26 19:07:59,150 - root - INFO - save_reference_summary:181 - Reference summary (placeholder) saved to datasets\block\summaries\reference_summary.png
2025-10-26 19:07:59,150 - src.pipeline - INFO - _run_reference_processing:238 - Reference processed. Target LAB colors shape: (2, 3), Determined k: 2
2025-10-26 19:07:59,156 - src.pipeline - INFO - timer:48 - Completed: Reference Image Processing in  8.83 seconds
2025-10-26 19:07:59,156 - src.pipeline - INFO - timer:43 - Starting: Test Image Analysis Loop...
2025-10-26 19:07:59,156 - src.pipeline - INFO - _run_test_image_analysis:252 - Starting test image analysis loop...
2025-10-26 19:07:59,157 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block1 ---
2025-10-26 19:07:59,451 - root - DEBUG - set_current_image_stem:61 - Current image stem set to: block1
2025-10-26 19:07:59,451 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block1...
2025-10-26 19:07:59,452 - src.data.preprocess - DEBUG - __init__:51 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000, unsharp_blur_kernel_size=[5, 5], unsharp_blur_sigma=1.0)
2025-10-26 19:07:59,452 - src.data.preprocess - INFO - preprocess:219 - Starting preprocessing pipeline for image with shape: (3950, 3950, 3)
2025-10-26 19:07:59,474 - src.data.preprocess - INFO - preprocess:231 - Initial resize from 3950x3950 to 512x512
2025-10-26 19:08:00,748 - src.data.preprocess - INFO - preprocess:239 - Applied non-local means denoising with h=10
2025-10-26 19:08:00,749 - src.data.preprocess - DEBUG - unsharp_mask:201 - Unsharp mask amount is zero or less, skipping.
2025-10-26 19:08:00,749 - src.data.preprocess - DEBUG - _estimate_n_colors:75 - Subsampling pixels (262144) for unique color estimation.
2025-10-26 19:08:00,814 - src.data.preprocess - INFO - _estimate_n_colors:84 - Estimated 239 unique colors. Target quantization colors: 50 (Config limit: 50)
2025-10-26 19:08:00,814 - src.data.preprocess - INFO - quantize_image:116 - Quantizing image (shape: (512, 512, 3)) to approx 50 colors
2025-10-26 19:08:00,816 - src.data.preprocess - DEBUG - quantize_image:137 - Subsampling 262144 pixels to 20000 for K-Means fitting.
2025-10-26 19:08:01,341 - src.data.preprocess - INFO - quantize_image:157 - Quantization complete. Final unique colors: 50 (target was 50)
2025-10-26 19:08:01,343 - src.data.preprocess - INFO - preprocess:262 - Final resize to target size (128, 128)
2025-10-26 19:08:01,343 - src.data.preprocess - INFO - preprocess:267 - Preprocessing pipeline completed successfully.
2025-10-26 19:08:01,345 - root - INFO - save_preprocessed_image:98 - Saved preprocessed image to datasets\block\processed\preprocessed\block1_preprocessed.png
2025-10-26 19:08:01,346 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block1) k_type: determined...
2025-10-26 19:08:01,346 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 19:08:01,346 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:08:01,347 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 19:08:01,347 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 19:08:01,347 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 19:08:01,347 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:08:01,348 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 19:08:01,348 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:08:01,348 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 19:08:01,348 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 19:08:01,348 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 19:08:01,349 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:08:01,349 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 19:08:01,349 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:08:01,349 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:08:01,349 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 19:08:01,349 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:08:01,349 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 19:08:01,350 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 19:08:01,350 - src.models.segmentation.kmeans - DEBUG - segment:61 - KMeans: Determining optimal k...
2025-10-26 19:08:01,369 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 355. Adjusted k-range: [2, 3]
2025-10-26 19:08:01,369 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:08:01,370 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:08:03,183 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:08:05,017 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 0.500)
2025-10-26 19:08:05,017 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:08:05,025 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 3.68s with 2 clusters.
2025-10-26 19:08:05,027 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_opt) to: datasets\block\processed\segmented\kmeans_opt\block1_determined.png
2025-10-26 19:08:05,028 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 19:08:05,044 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 355. Adjusted k-range: [2, 3]
2025-10-26 19:08:05,045 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:08:05,047 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:08:06,923 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:08:08,744 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 0.500)
2025-10-26 19:08:08,745 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:08:09,055 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 4.03s with 2 clusters.
2025-10-26 19:08:09,057 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_opt) to: datasets\block\processed\segmented\som_opt\block1_determined.png
2025-10-26 19:08:09,057 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:08:09,058 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 19:08:52,177 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15.0, min=10
2025-10-26 19:08:53,836 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 44.78s with 2 clusters.
2025-10-26 19:08:53,837 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block1_determined.png
2025-10-26 19:08:53,837 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 19:08:54,039 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_opt (determined) on block1: Avg Delta E Traditional=1.72, Avg Delta E DBN=11.32, k=2
2025-10-26 19:08:54,134 - src.pipeline - INFO - _process_single_test_image:392 - -> som_opt (determined) on block1: Avg Delta E Traditional=10.84, Avg Delta E DBN=13.66, k=2
2025-10-26 19:08:54,228 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (determined) on block1: Avg Delta E Traditional=1.61, Avg Delta E DBN=11.32, k=2
2025-10-26 19:08:54,228 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block1) k_type: determined in  52.88 seconds
2025-10-26 19:08:54,228 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block1) k_type: predefined...
2025-10-26 19:08:54,228 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 19:08:54,228 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:08:54,228 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 19:08:54,228 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:08:54,228 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 19:08:54,228 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 19:08:54,230 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:08:54,230 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 19:08:54,230 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:08:54,231 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 19:08:54,231 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 19:08:54,232 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:08:54,241 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.01s with 2 clusters.
2025-10-26 19:08:54,243 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_predef) to: datasets\block\processed\segmented\kmeans_predef\block1_predefined.png
2025-10-26 19:08:54,243 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 19:08:54,244 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:08:54,563 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.32s with 2 clusters.
2025-10-26 19:08:54,564 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_predef) to: datasets\block\processed\segmented\som_predef\block1_predefined.png
2025-10-26 19:08:54,565 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:08:54,565 - src.models.segmentation.dbscan - INFO - segment:116 - Using predefined DBSCAN.
2025-10-26 19:08:56,346 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.78s with 1 clusters.
2025-10-26 19:08:56,348 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block1_predefined.png
2025-10-26 19:08:56,348 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 19:08:56,444 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_predef (predefined) on block1: Avg Delta E Traditional=1.72, Avg Delta E DBN=11.32, k=2
2025-10-26 19:08:56,551 - src.pipeline - INFO - _process_single_test_image:392 - -> som_predef (predefined) on block1: Avg Delta E Traditional=10.84, Avg Delta E DBN=13.66, k=2
2025-10-26 19:08:56,654 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (predefined) on block1: Avg Delta E Traditional=21.98, Avg Delta E DBN=16.67, k=1
2025-10-26 19:08:56,655 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block1) k_type: predefined in  2.43 seconds
2025-10-26 19:08:56,655 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block1 in  57.20 seconds
2025-10-26 19:08:56,655 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block2 ---
2025-10-26 19:08:57,044 - root - DEBUG - set_current_image_stem:61 - Current image stem set to: block2
2025-10-26 19:08:57,044 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block2...
2025-10-26 19:08:57,045 - src.data.preprocess - DEBUG - __init__:51 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000, unsharp_blur_kernel_size=[5, 5], unsharp_blur_sigma=1.0)
2025-10-26 19:08:57,045 - src.data.preprocess - INFO - preprocess:219 - Starting preprocessing pipeline for image with shape: (4480, 4480, 3)
2025-10-26 19:08:57,077 - src.data.preprocess - INFO - preprocess:231 - Initial resize from 4480x4480 to 512x512
2025-10-26 19:08:58,303 - src.data.preprocess - INFO - preprocess:239 - Applied non-local means denoising with h=10
2025-10-26 19:08:58,304 - src.data.preprocess - DEBUG - unsharp_mask:201 - Unsharp mask amount is zero or less, skipping.
2025-10-26 19:08:58,304 - src.data.preprocess - DEBUG - _estimate_n_colors:75 - Subsampling pixels (262144) for unique color estimation.
2025-10-26 19:08:58,373 - src.data.preprocess - INFO - _estimate_n_colors:84 - Estimated 212 unique colors. Target quantization colors: 50 (Config limit: 50)
2025-10-26 19:08:58,374 - src.data.preprocess - INFO - quantize_image:116 - Quantizing image (shape: (512, 512, 3)) to approx 50 colors
2025-10-26 19:08:58,375 - src.data.preprocess - DEBUG - quantize_image:137 - Subsampling 262144 pixels to 20000 for K-Means fitting.
2025-10-26 19:08:58,885 - src.data.preprocess - INFO - quantize_image:157 - Quantization complete. Final unique colors: 50 (target was 50)
2025-10-26 19:08:58,886 - src.data.preprocess - INFO - preprocess:262 - Final resize to target size (128, 128)
2025-10-26 19:08:58,887 - src.data.preprocess - INFO - preprocess:267 - Preprocessing pipeline completed successfully.
2025-10-26 19:08:58,888 - root - INFO - save_preprocessed_image:98 - Saved preprocessed image to datasets\block\processed\preprocessed\block2_preprocessed.png
2025-10-26 19:08:58,889 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block2) k_type: determined...
2025-10-26 19:08:58,889 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 19:08:58,889 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:08:58,889 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 19:08:58,889 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 19:08:58,890 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 19:08:58,890 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:08:58,890 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 19:08:58,890 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:08:58,890 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 19:08:58,891 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 19:08:58,891 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 19:08:58,891 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:08:58,891 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 19:08:58,891 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:08:58,891 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:08:58,891 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 19:08:58,892 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:08:58,892 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 19:08:58,893 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 19:08:58,893 - src.models.segmentation.kmeans - DEBUG - segment:61 - KMeans: Determining optimal k...
2025-10-26 19:08:58,909 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 323. Adjusted k-range: [2, 3]
2025-10-26 19:08:58,910 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:08:58,911 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:09:00,720 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:09:02,546 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:09:02,547 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:09:02,556 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 3.66s with 2 clusters.
2025-10-26 19:09:02,558 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_opt) to: datasets\block\processed\segmented\kmeans_opt\block2_determined.png
2025-10-26 19:09:02,558 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 19:09:02,576 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 323. Adjusted k-range: [2, 3]
2025-10-26 19:09:02,576 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:09:02,577 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:09:04,377 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:09:06,181 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 0.500)
2025-10-26 19:09:06,182 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:09:06,499 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 3.94s with 2 clusters.
2025-10-26 19:09:06,501 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_opt) to: datasets\block\processed\segmented\som_opt\block2_determined.png
2025-10-26 19:09:06,501 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:09:06,501 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 19:09:45,005 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15.0, min=20
2025-10-26 19:09:46,835 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 40.33s with 2 clusters.
2025-10-26 19:09:46,840 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block2_determined.png
2025-10-26 19:09:46,840 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 19:09:46,940 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_opt (determined) on block2: Avg Delta E Traditional=1.89, Avg Delta E DBN=11.73, k=2
2025-10-26 19:09:47,033 - src.pipeline - INFO - _process_single_test_image:392 - -> som_opt (determined) on block2: Avg Delta E Traditional=7.08, Avg Delta E DBN=12.82, k=2
2025-10-26 19:09:47,125 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (determined) on block2: Avg Delta E Traditional=1.92, Avg Delta E DBN=11.69, k=2
2025-10-26 19:09:47,126 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block2) k_type: determined in  48.24 seconds
2025-10-26 19:09:47,126 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block2) k_type: predefined...
2025-10-26 19:09:47,127 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 19:09:47,127 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:09:47,127 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 19:09:47,127 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:09:47,127 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 19:09:47,127 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 19:09:47,127 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 19:09:47,128 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:09:47,128 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 19:09:47,128 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:09:47,128 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 19:09:47,128 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 19:09:47,128 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 19:09:47,129 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:09:47,129 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:09:47,129 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 19:09:47,129 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:09:47,129 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 19:09:47,130 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 19:09:47,130 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:09:47,140 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.01s with 2 clusters.
2025-10-26 19:09:47,142 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_predef) to: datasets\block\processed\segmented\kmeans_predef\block2_predefined.png
2025-10-26 19:09:47,143 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 19:09:47,143 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:09:47,477 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.33s with 2 clusters.
2025-10-26 19:09:47,479 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_predef) to: datasets\block\processed\segmented\som_predef\block2_predefined.png
2025-10-26 19:09:47,479 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:09:47,480 - src.models.segmentation.dbscan - INFO - segment:116 - Using predefined DBSCAN.
2025-10-26 19:09:49,447 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.97s with 1 clusters.
2025-10-26 19:09:49,449 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block2_predefined.png
2025-10-26 19:09:49,449 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 19:09:49,553 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_predef (predefined) on block2: Avg Delta E Traditional=1.89, Avg Delta E DBN=11.73, k=2
2025-10-26 19:09:49,656 - src.pipeline - INFO - _process_single_test_image:392 - -> som_predef (predefined) on block2: Avg Delta E Traditional=7.08, Avg Delta E DBN=12.82, k=2
2025-10-26 19:09:49,757 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (predefined) on block2: Avg Delta E Traditional=19.47, Avg Delta E DBN=23.06, k=1
2025-10-26 19:09:49,758 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block2) k_type: predefined in  2.63 seconds
2025-10-26 19:09:49,758 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block2 in  52.71 seconds
2025-10-26 19:09:49,759 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block3 ---
2025-10-26 19:09:49,969 - root - DEBUG - set_current_image_stem:61 - Current image stem set to: block3
2025-10-26 19:09:49,969 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block3...
2025-10-26 19:09:49,970 - src.data.preprocess - DEBUG - __init__:51 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000, unsharp_blur_kernel_size=[5, 5], unsharp_blur_sigma=1.0)
2025-10-26 19:09:49,970 - src.data.preprocess - INFO - preprocess:219 - Starting preprocessing pipeline for image with shape: (3477, 3477, 3)
2025-10-26 19:09:49,991 - src.data.preprocess - INFO - preprocess:231 - Initial resize from 3477x3477 to 511x511
2025-10-26 19:09:51,236 - src.data.preprocess - INFO - preprocess:239 - Applied non-local means denoising with h=10
2025-10-26 19:09:51,237 - src.data.preprocess - DEBUG - unsharp_mask:201 - Unsharp mask amount is zero or less, skipping.
2025-10-26 19:09:51,237 - src.data.preprocess - DEBUG - _estimate_n_colors:75 - Subsampling pixels (261121) for unique color estimation.
2025-10-26 19:09:51,299 - src.data.preprocess - INFO - _estimate_n_colors:84 - Estimated 240 unique colors. Target quantization colors: 50 (Config limit: 50)
2025-10-26 19:09:51,299 - src.data.preprocess - INFO - quantize_image:116 - Quantizing image (shape: (511, 511, 3)) to approx 50 colors
2025-10-26 19:09:51,301 - src.data.preprocess - DEBUG - quantize_image:137 - Subsampling 261121 pixels to 20000 for K-Means fitting.
2025-10-26 19:09:51,793 - src.data.preprocess - INFO - quantize_image:157 - Quantization complete. Final unique colors: 50 (target was 50)
2025-10-26 19:09:51,795 - src.data.preprocess - INFO - preprocess:262 - Final resize to target size (128, 128)
2025-10-26 19:09:51,796 - src.data.preprocess - INFO - preprocess:267 - Preprocessing pipeline completed successfully.
2025-10-26 19:09:51,800 - root - INFO - save_preprocessed_image:98 - Saved preprocessed image to datasets\block\processed\preprocessed\block3_preprocessed.png
2025-10-26 19:09:51,800 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block3) k_type: determined...
2025-10-26 19:09:51,801 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 19:09:51,801 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:09:51,801 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 19:09:51,801 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 19:09:51,802 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 19:09:51,802 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:09:51,802 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 19:09:51,802 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:09:51,802 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 19:09:51,802 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 19:09:51,803 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 19:09:51,803 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:09:51,803 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 19:09:51,803 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:09:51,803 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:09:51,803 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 19:09:51,804 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:09:51,804 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 19:09:51,804 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 19:09:51,805 - src.models.segmentation.kmeans - DEBUG - segment:61 - KMeans: Determining optimal k...
2025-10-26 19:09:51,821 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 309. Adjusted k-range: [2, 3]
2025-10-26 19:09:51,821 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:09:51,822 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:09:53,582 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:09:55,385 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:09:55,386 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:09:55,394 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 3.59s with 2 clusters.
2025-10-26 19:09:55,397 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_opt) to: datasets\block\processed\segmented\kmeans_opt\block3_determined.png
2025-10-26 19:09:55,398 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 19:09:55,414 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 309. Adjusted k-range: [2, 3]
2025-10-26 19:09:55,415 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:09:55,416 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:09:57,211 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:09:58,993 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:09:58,993 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:09:59,297 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 3.90s with 2 clusters.
2025-10-26 19:09:59,301 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_opt) to: datasets\block\processed\segmented\som_opt\block3_determined.png
2025-10-26 19:09:59,302 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:09:59,302 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 19:10:34,500 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15.0, min=20
2025-10-26 19:10:36,078 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 36.78s with 2 clusters.
2025-10-26 19:10:36,080 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block3_determined.png
2025-10-26 19:10:36,080 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 19:10:36,175 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_opt (determined) on block3: Avg Delta E Traditional=1.77, Avg Delta E DBN=11.91, k=2
2025-10-26 19:10:36,270 - src.pipeline - INFO - _process_single_test_image:392 - -> som_opt (determined) on block3: Avg Delta E Traditional=1.78, Avg Delta E DBN=11.91, k=2
2025-10-26 19:10:36,363 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (determined) on block3: Avg Delta E Traditional=1.62, Avg Delta E DBN=11.85, k=2
2025-10-26 19:10:36,363 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block3) k_type: determined in  44.56 seconds
2025-10-26 19:10:36,364 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block3) k_type: predefined...
2025-10-26 19:10:36,364 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 19:10:36,364 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:10:36,364 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 19:10:36,364 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:10:36,364 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 19:10:36,364 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 19:10:36,365 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 19:10:36,365 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:10:36,365 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 19:10:36,365 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:10:36,365 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 19:10:36,365 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 19:10:36,366 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 19:10:36,366 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:10:36,366 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:10:36,366 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 19:10:36,366 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:10:36,366 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 19:10:36,367 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 19:10:36,367 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:10:36,374 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.01s with 2 clusters.
2025-10-26 19:10:36,376 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_predef) to: datasets\block\processed\segmented\kmeans_predef\block3_predefined.png
2025-10-26 19:10:36,377 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 19:10:36,377 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:10:36,688 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.31s with 2 clusters.
2025-10-26 19:10:36,690 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_predef) to: datasets\block\processed\segmented\som_predef\block3_predefined.png
2025-10-26 19:10:36,690 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:10:36,691 - src.models.segmentation.dbscan - INFO - segment:116 - Using predefined DBSCAN.
2025-10-26 19:10:38,277 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.59s with 1 clusters.
2025-10-26 19:10:38,279 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block3_predefined.png
2025-10-26 19:10:38,279 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 19:10:38,377 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_predef (predefined) on block3: Avg Delta E Traditional=1.77, Avg Delta E DBN=11.91, k=2
2025-10-26 19:10:38,488 - src.pipeline - INFO - _process_single_test_image:392 - -> som_predef (predefined) on block3: Avg Delta E Traditional=1.78, Avg Delta E DBN=11.91, k=2
2025-10-26 19:10:38,590 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (predefined) on block3: Avg Delta E Traditional=25.81, Avg Delta E DBN=18.86, k=1
2025-10-26 19:10:38,591 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block3) k_type: predefined in  2.23 seconds
2025-10-26 19:10:38,591 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block3 in  48.62 seconds
2025-10-26 19:10:38,592 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block4 ---
2025-10-26 19:10:38,837 - root - DEBUG - set_current_image_stem:61 - Current image stem set to: block4
2025-10-26 19:10:38,838 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block4...
2025-10-26 19:10:38,838 - src.data.preprocess - DEBUG - __init__:51 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000, unsharp_blur_kernel_size=[5, 5], unsharp_blur_sigma=1.0)
2025-10-26 19:10:38,838 - src.data.preprocess - INFO - preprocess:219 - Starting preprocessing pipeline for image with shape: (3622, 3622, 3)
2025-10-26 19:10:38,862 - src.data.preprocess - INFO - preprocess:231 - Initial resize from 3622x3622 to 512x512
2025-10-26 19:10:40,099 - src.data.preprocess - INFO - preprocess:239 - Applied non-local means denoising with h=10
2025-10-26 19:10:40,099 - src.data.preprocess - DEBUG - unsharp_mask:201 - Unsharp mask amount is zero or less, skipping.
2025-10-26 19:10:40,099 - src.data.preprocess - DEBUG - _estimate_n_colors:75 - Subsampling pixels (262144) for unique color estimation.
2025-10-26 19:10:40,161 - src.data.preprocess - INFO - _estimate_n_colors:84 - Estimated 188 unique colors. Target quantization colors: 50 (Config limit: 50)
2025-10-26 19:10:40,162 - src.data.preprocess - INFO - quantize_image:116 - Quantizing image (shape: (512, 512, 3)) to approx 50 colors
2025-10-26 19:10:40,163 - src.data.preprocess - DEBUG - quantize_image:137 - Subsampling 262144 pixels to 20000 for K-Means fitting.
2025-10-26 19:10:40,624 - src.data.preprocess - INFO - quantize_image:157 - Quantization complete. Final unique colors: 49 (target was 50)
2025-10-26 19:10:40,626 - src.data.preprocess - INFO - preprocess:262 - Final resize to target size (128, 128)
2025-10-26 19:10:40,627 - src.data.preprocess - INFO - preprocess:267 - Preprocessing pipeline completed successfully.
2025-10-26 19:10:40,628 - root - INFO - save_preprocessed_image:98 - Saved preprocessed image to datasets\block\processed\preprocessed\block4_preprocessed.png
2025-10-26 19:10:40,628 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block4) k_type: determined...
2025-10-26 19:10:40,629 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 19:10:40,629 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:10:40,629 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 19:10:40,629 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 19:10:40,629 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 19:10:40,630 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:10:40,630 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 19:10:40,631 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:10:40,631 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:10:40,631 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 19:10:40,631 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:10:40,631 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 19:10:40,632 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 19:10:40,632 - src.models.segmentation.kmeans - DEBUG - segment:61 - KMeans: Determining optimal k...
2025-10-26 19:10:40,649 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 295. Adjusted k-range: [2, 3]
2025-10-26 19:10:40,649 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:10:40,650 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:10:42,399 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:10:44,200 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:10:44,200 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:10:44,209 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 3.58s with 2 clusters.
2025-10-26 19:10:44,211 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_opt) to: datasets\block\processed\segmented\kmeans_opt\block4_determined.png
2025-10-26 19:10:44,211 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 19:10:44,228 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 295. Adjusted k-range: [2, 3]
2025-10-26 19:10:44,228 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:10:44,229 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:10:46,006 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:10:47,785 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 0.500)
2025-10-26 19:10:47,786 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:10:48,088 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 3.88s with 2 clusters.
2025-10-26 19:10:48,089 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_opt) to: datasets\block\processed\segmented\som_opt\block4_determined.png
2025-10-26 19:10:48,090 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:10:48,090 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 19:11:20,942 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=10.0, min=10
2025-10-26 19:11:22,830 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 34.74s with 4 clusters.
2025-10-26 19:11:22,833 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block4_determined.png
2025-10-26 19:11:22,833 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 19:11:22,930 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_opt (determined) on block4: Avg Delta E Traditional=2.53, Avg Delta E DBN=11.96, k=2
2025-10-26 19:11:23,026 - src.pipeline - INFO - _process_single_test_image:392 - -> som_opt (determined) on block4: Avg Delta E Traditional=10.64, Avg Delta E DBN=17.10, k=2
2025-10-26 19:11:23,123 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (determined) on block4: Avg Delta E Traditional=10.38, Avg Delta E DBN=13.38, k=4
2025-10-26 19:11:23,123 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block4) k_type: determined in  42.49 seconds
2025-10-26 19:11:23,123 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block4) k_type: predefined...
2025-10-26 19:11:23,123 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 19:11:23,123 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:11:23,123 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 19:11:23,123 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:11:23,123 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 19:11:23,123 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 19:11:23,125 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 19:11:23,125 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:11:23,125 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 19:11:23,125 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:11:23,125 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 19:11:23,125 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 19:11:23,126 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 19:11:23,126 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:11:23,126 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:11:23,126 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 19:11:23,126 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:11:23,126 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 19:11:23,126 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 19:11:23,126 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:11:23,135 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.01s with 2 clusters.
2025-10-26 19:11:23,136 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_predef) to: datasets\block\processed\segmented\kmeans_predef\block4_predefined.png
2025-10-26 19:11:23,137 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 19:11:23,137 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:11:23,446 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.31s with 2 clusters.
2025-10-26 19:11:23,447 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_predef) to: datasets\block\processed\segmented\som_predef\block4_predefined.png
2025-10-26 19:11:23,447 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:11:23,448 - src.models.segmentation.dbscan - INFO - segment:116 - Using predefined DBSCAN.
2025-10-26 19:11:25,365 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.92s with 1 clusters.
2025-10-26 19:11:25,367 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block4_predefined.png
2025-10-26 19:11:25,367 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 19:11:25,470 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_predef (predefined) on block4: Avg Delta E Traditional=2.53, Avg Delta E DBN=11.96, k=2
2025-10-26 19:11:25,571 - src.pipeline - INFO - _process_single_test_image:392 - -> som_predef (predefined) on block4: Avg Delta E Traditional=10.64, Avg Delta E DBN=17.10, k=2
2025-10-26 19:11:25,670 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (predefined) on block4: Avg Delta E Traditional=23.53, Avg Delta E DBN=19.91, k=1
2025-10-26 19:11:25,671 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block4) k_type: predefined in  2.55 seconds
2025-10-26 19:11:25,671 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block4 in  46.83 seconds
2025-10-26 19:11:25,671 - src.pipeline - INFO - _run_test_image_analysis:258 - --- Processing test image: block5 ---
2025-10-26 19:11:25,909 - root - DEBUG - set_current_image_stem:61 - Current image stem set to: block5
2025-10-26 19:11:25,910 - src.pipeline - INFO - timer:43 - Starting: Single image processing for block5...
2025-10-26 19:11:25,910 - src.data.preprocess - DEBUG - __init__:51 - Preprocessor initialized with config: PreprocessingConfig(initial_resize=512, target_size=(128, 128), denoise_h=10, unsharp_amount=0.0, unsharp_threshold=0, quantization_colors=50, quantization_subsample=20000, unsharp_blur_kernel_size=[5, 5], unsharp_blur_sigma=1.0)
2025-10-26 19:11:25,910 - src.data.preprocess - INFO - preprocess:219 - Starting preprocessing pipeline for image with shape: (3504, 3504, 3)
2025-10-26 19:11:25,934 - src.data.preprocess - INFO - preprocess:231 - Initial resize from 3504x3504 to 512x512
2025-10-26 19:11:27,168 - src.data.preprocess - INFO - preprocess:239 - Applied non-local means denoising with h=10
2025-10-26 19:11:27,168 - src.data.preprocess - DEBUG - unsharp_mask:201 - Unsharp mask amount is zero or less, skipping.
2025-10-26 19:11:27,168 - src.data.preprocess - DEBUG - _estimate_n_colors:75 - Subsampling pixels (262144) for unique color estimation.
2025-10-26 19:11:27,227 - src.data.preprocess - INFO - _estimate_n_colors:84 - Estimated 208 unique colors. Target quantization colors: 50 (Config limit: 50)
2025-10-26 19:11:27,227 - src.data.preprocess - INFO - quantize_image:116 - Quantizing image (shape: (512, 512, 3)) to approx 50 colors
2025-10-26 19:11:27,229 - src.data.preprocess - DEBUG - quantize_image:137 - Subsampling 262144 pixels to 20000 for K-Means fitting.
2025-10-26 19:11:27,754 - src.data.preprocess - INFO - quantize_image:157 - Quantization complete. Final unique colors: 49 (target was 50)
2025-10-26 19:11:27,756 - src.data.preprocess - INFO - preprocess:262 - Final resize to target size (128, 128)
2025-10-26 19:11:27,756 - src.data.preprocess - INFO - preprocess:267 - Preprocessing pipeline completed successfully.
2025-10-26 19:11:27,758 - root - INFO - save_preprocessed_image:98 - Saved preprocessed image to datasets\block\processed\preprocessed\block5_preprocessed.png
2025-10-26 19:11:27,758 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block5) k_type: determined...
2025-10-26 19:11:27,759 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='determined'...
2025-10-26 19:11:27,759 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:11:27,759 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_opt' matches. Trying to init KMeansSegmenter...
2025-10-26 19:11:27,759 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: determined
2025-10-26 19:11:27,759 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_opt'
2025-10-26 19:11:27,760 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:11:27,760 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_predef' (Not requested or k_type mismatch).
2025-10-26 19:11:27,760 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:11:27,760 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_opt' matches. Trying to init SOMSegmenter...
2025-10-26 19:11:27,760 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: determined
2025-10-26 19:11:27,760 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_opt'
2025-10-26 19:11:27,761 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:11:27,761 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_predef' (Not requested or k_type mismatch).
2025-10-26 19:11:27,761 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:11:27,761 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:11:27,761 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: determined
2025-10-26 19:11:27,761 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:11:27,762 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='determined' with methods: ['kmeans_opt', 'som_opt', 'dbscan']
2025-10-26 19:11:27,762 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_opt
2025-10-26 19:11:27,762 - src.models.segmentation.kmeans - DEBUG - segment:61 - KMeans: Determining optimal k...
2025-10-26 19:11:27,778 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 321. Adjusted k-range: [2, 3]
2025-10-26 19:11:27,779 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:11:27,780 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:11:29,564 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:11:31,420 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:11:31,420 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:11:31,429 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_opt completed in 3.67s with 2 clusters.
2025-10-26 19:11:31,431 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_opt) to: datasets\block\processed\segmented\kmeans_opt\block5_determined.png
2025-10-26 19:11:31,431 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_opt
2025-10-26 19:11:31,449 - src.models.segmentation.strategy - INFO - determine_k:59 - Unique colors: 321. Adjusted k-range: [2, 3]
2025-10-26 19:11:31,450 - src.models.segmentation.strategy - INFO - determine_k:69 - Subsampling pixels to 10000 for cluster analysis efficiency
2025-10-26 19:11:31,451 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=2 for cluster metrics...
2025-10-26 19:11:33,291 - src.models.segmentation.strategy - INFO - determine_k:89 - Testing k=3 for cluster metrics...
2025-10-26 19:11:35,089 - src.models.segmentation.strategy - INFO - determine_k:126 - Optimal k determined: 2 (score: 1.000)
2025-10-26 19:11:35,090 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:11:35,387 - src.models.segmentation.facade - INFO - process:140 - Method som_opt completed in 3.96s with 2 clusters.
2025-10-26 19:11:35,389 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_opt) to: datasets\block\processed\segmented\som_opt\block5_determined.png
2025-10-26 19:11:35,389 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:11:35,389 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:67 - Finding optimal DBSCAN parameters (heuristic)...
2025-10-26 19:12:08,530 - src.models.segmentation.dbscan - INFO - _find_optimal_dbscan_params:89 - Optimal DBSCAN parameters: eps=15.0, min=20
2025-10-26 19:12:10,370 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 34.98s with 3 clusters.
2025-10-26 19:12:10,372 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block5_determined.png
2025-10-26 19:12:10,372 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='determined'.
2025-10-26 19:12:10,469 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_opt (determined) on block5: Avg Delta E Traditional=4.29, Avg Delta E DBN=11.75, k=2
2025-10-26 19:12:10,562 - src.pipeline - INFO - _process_single_test_image:392 - -> som_opt (determined) on block5: Avg Delta E Traditional=14.70, Avg Delta E DBN=15.21, k=2
2025-10-26 19:12:10,662 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (determined) on block5: Avg Delta E Traditional=9.42, Avg Delta E DBN=15.71, k=3
2025-10-26 19:12:10,662 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block5) k_type: determined in  42.90 seconds
2025-10-26 19:12:10,662 - src.pipeline - INFO - timer:43 - Starting: Segmentation (block5) k_type: predefined...
2025-10-26 19:12:10,662 - root - DEBUG - _initialize_segmenters:91 - Segmenter._init_seg: Initializing for k_type='predefined'...
2025-10-26 19:12:10,662 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_opt'...
2025-10-26 19:12:10,662 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'kmeans_opt' (Not requested or k_type mismatch).
2025-10-26 19:12:10,662 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'kmeans_predef'...
2025-10-26 19:12:10,663 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'kmeans_predef' matches. Trying to init KMeansSegmenter...
2025-10-26 19:12:10,663 - src.models.segmentation.kmeans - INFO - __init__:36 - KMeansSegmenter initialized with k_type: predefined
2025-10-26 19:12:10,663 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized KMeansSegmenter for 'kmeans_predef'
2025-10-26 19:12:10,663 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_opt'...
2025-10-26 19:12:10,663 - root - DEBUG - _initialize_segmenters:105 - Segmenter._init_seg: Skipping method 'som_opt' (Not requested or k_type mismatch).
2025-10-26 19:12:10,663 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'som_predef'...
2025-10-26 19:12:10,663 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'som_predef' matches. Trying to init SOMSegmenter...
2025-10-26 19:12:10,664 - src.models.segmentation.som - INFO - __init__:38 - SOMSegmenter initialized with k_type: predefined
2025-10-26 19:12:10,664 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized SOMSegmenter for 'som_predef'
2025-10-26 19:12:10,664 - root - DEBUG - _initialize_segmenters:93 - Segmenter._init_seg: Checking method 'dbscan'...
2025-10-26 19:12:10,664 - root - DEBUG - _initialize_segmenters:96 - Segmenter._init_seg: Method 'dbscan' matches. Trying to init DBSCANSegmenter...
2025-10-26 19:12:10,664 - src.models.segmentation.dbscan - INFO - __init__:37 - DBSCANSegmenter initialized with k_type: predefined
2025-10-26 19:12:10,665 - root - DEBUG - _initialize_segmenters:100 - Segmenter._init_seg: Successfully initialized DBSCANSegmenter for 'dbscan'
2025-10-26 19:12:10,665 - src.models.segmentation.facade - INFO - __init__:68 - Segmenter Facade initialized for k_type='predefined' with methods: ['kmeans_predef', 'som_predef', 'dbscan']
2025-10-26 19:12:10,665 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: kmeans_predef
2025-10-26 19:12:10,666 - src.models.segmentation.kmeans - INFO - segment:65 - KMeans: Using k = 2
2025-10-26 19:12:10,674 - src.models.segmentation.facade - INFO - process:140 - Method kmeans_predef completed in 0.01s with 2 clusters.
2025-10-26 19:12:10,676 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (kmeans_predef) to: datasets\block\processed\segmented\kmeans_predef\block5_predefined.png
2025-10-26 19:12:10,676 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: som_predef
2025-10-26 19:12:10,677 - src.models.segmentation.som - INFO - segment:69 - Running SOM segmentation with k=2
2025-10-26 19:12:11,000 - src.models.segmentation.facade - INFO - process:140 - Method som_predef completed in 0.32s with 2 clusters.
2025-10-26 19:12:11,002 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (som_predef) to: datasets\block\processed\segmented\som_predef\block5_predefined.png
2025-10-26 19:12:11,002 - src.models.segmentation.facade - INFO - process:136 - Running segmentation method: dbscan
2025-10-26 19:12:11,002 - src.models.segmentation.dbscan - INFO - segment:116 - Using predefined DBSCAN.
2025-10-26 19:12:12,832 - src.models.segmentation.facade - INFO - process:140 - Method dbscan completed in 1.83s with 1 clusters.
2025-10-26 19:12:12,833 - src.utils.output_manager - INFO - save_segmentation_result:151 - Saved segmented image (dbscan) to: datasets\block\processed\segmented\dbscan\block5_predefined.png
2025-10-26 19:12:12,834 - src.models.segmentation.facade - INFO - process:156 - Segmentation processing completed for k_type='predefined'.
2025-10-26 19:12:12,934 - src.pipeline - INFO - _process_single_test_image:392 - -> kmeans_predef (predefined) on block5: Avg Delta E Traditional=4.29, Avg Delta E DBN=11.75, k=2
2025-10-26 19:12:13,033 - src.pipeline - INFO - _process_single_test_image:392 - -> som_predef (predefined) on block5: Avg Delta E Traditional=14.70, Avg Delta E DBN=15.21, k=2
2025-10-26 19:12:13,181 - src.pipeline - INFO - _process_single_test_image:392 - -> dbscan (predefined) on block5: Avg Delta E Traditional=17.74, Avg Delta E DBN=25.09, k=1
2025-10-26 19:12:13,181 - src.pipeline - INFO - timer:48 - Completed: Segmentation (block5) k_type: predefined in  2.52 seconds
2025-10-26 19:12:13,182 - src.pipeline - INFO - timer:48 - Completed: Single image processing for block5 in  47.27 seconds
2025-10-26 19:12:13,182 - root - DEBUG - set_current_image_stem:61 - Current image stem set to: None
2025-10-26 19:12:13,182 - src.pipeline - INFO - _run_test_image_analysis:278 - Test image analysis loop finished.
2025-10-26 19:12:13,186 - src.pipeline - INFO - timer:48 - Completed: Test Image Analysis Loop in  254.03 seconds
2025-10-26 19:12:13,186 - src.pipeline - INFO - timer:43 - Starting: Saving Final Results...
2025-10-26 19:12:13,186 - src.pipeline - INFO - _save_and_summarize_results:416 - Saving 30 total Delta E results to CSV...
2025-10-26 19:12:13,193 - root - INFO - save_delta_e_results:166 - Saved Delta E results (30 entries) to datasets\block\analysis\_block_delta_e_results.csv
2025-10-26 19:12:13,194 - src.pipeline - INFO - _save_and_summarize_results:424 - --- Overall Results Summary ---
2025-10-26 19:12:13,206 - src.pipeline - INFO - _save_and_summarize_results:433 - 
   method  avg_traditional_delta_e  avg_pso_dbn_delta_e  avg_processing_time
0  dbscan                   13.346               16.754               20.069
1  kmeans                    2.440               11.733                1.822
2     som                    9.008               14.140                2.129
2025-10-26 19:12:13,207 - src.pipeline - INFO - _save_and_summarize_results:436 - --- Detailed Results by k_type ---
2025-10-26 19:12:13,217 - src.pipeline - INFO - _save_and_summarize_results:444 - 
   method      k_type  avg_traditional_delta_e  avg_pso_dbn_delta_e  avg_processing_time  avg_n_clusters
0  dbscan  determined                    4.989               12.788               38.322           2.600
1  dbscan  predefined                   21.704               20.720                1.816           1.000
2  kmeans  determined                    2.440               11.733                3.634           2.000
3  kmeans  predefined                    2.440               11.733                0.009           2.000
4     som  determined                    9.008               14.140                3.940           2.000
5     som  predefined                    9.008               14.140                0.319           2.000
2025-10-26 19:12:13,219 - src.pipeline - INFO - _save_and_summarize_results:445 - --- End of Summary ---
2025-10-26 19:12:13,220 - src.pipeline - INFO - timer:48 - Completed: Saving Final Results in  0.03 seconds
2025-10-26 19:12:13,221 - src.pipeline - INFO - timer:48 - Completed: Total Pipeline in  387.96 seconds
2025-10-26 19:12:13,221 - src.pipeline - INFO - run:127 - ==================================================
2025-10-26 19:12:13,221 - src.pipeline - INFO - run:128 - Processing Pipeline RUN completed for: block
2025-10-26 19:12:13,222 - src.pipeline - INFO - run:129 - ==================================================
2025-10-26 19:12:13,222 - root - INFO - main:69 - Main execution finished successfully.
2025-10-26 19:12:13,223 - root - INFO - main:75 - ================================================================================
PROCESSING COMPLETED IN 387.98 SECONDS
================================================================================
